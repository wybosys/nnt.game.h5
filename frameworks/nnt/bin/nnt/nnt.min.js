function NewSet(){return nn.ISHTML5?new nn.CSet:new nn.SafeSet}var __extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},KvObject=function(){function t(){}return t}(),nn;!function(t){t.ECMA6_NATIVE=!0,"undefined"==typeof Map&&(t.ECMA6_NATIVE=!1);var e=function(){function e(){this.clear=t.ECMA6_NATIVE?this._n_clear:this._i_clear,this["delete"]=t.ECMA6_NATIVE?this._n_delete:this._i_delete,this.forEach=t.ECMA6_NATIVE?this._n_foreach:this._i_foreach,this.has=t.ECMA6_NATIVE?this._n_has:this._i_has,this.set=t.ECMA6_NATIVE?this._n_set:this._i_set,this.get=t.ECMA6_NATIVE?this._n_get:this._i_get,t.ECMA6_NATIVE?this._imp=new Map:this._imp={}}return e.prototype._n_clear=function(){this._imp.clear()},e.prototype._i_clear=function(){this._imp={}},e.prototype._n_delete=function(t){this._imp["delete"](t)},e.prototype._i_delete=function(t){delete this._imp[t]},e.prototype._n_foreach=function(t,e){this._imp.forEach(function(n,i){t.call(e,i,n)})},e.prototype._i_foreach=function(t,e){var n=Object.keys(this._imp);n.forEach(function(n){t.call(e,n,this._imp[n])},this)},e.prototype._n_has=function(t){return this._imp.has(t)},e.prototype._i_has=function(t){return this._imp.hasOwnProperty(t)},e.prototype._n_length=function(){return this._imp.size},e.prototype._i_length=function(){return Object.keys(this._imp).length},Object.defineProperty(e.prototype,"length",{get:function(){return t.ECMA6_NATIVE?this._n_length():this._i_length()},enumerable:!0,configurable:!0}),e.prototype._n_set=function(t,e){this._imp.set(t,e)},e.prototype._i_set=function(t,e){this._imp[t]=e},e.prototype._n_get=function(t){return this._imp.get(t)},e.prototype._i_get=function(t){return this._imp[t]},e}();t.CMap=e;var n=function(){function n(){this.add=t.ECMA6_NATIVE?this._n_add:this._i_add,this.has=t.ECMA6_NATIVE?this._n_has:this._i_has,this["delete"]=t.ECMA6_NATIVE?this._n_delete:this._i_delete,this.clear=t.ECMA6_NATIVE?this._n_clear:this._i_clear,this.forEach=t.ECMA6_NATIVE?this._n_foreach:this._i_foreach,t.ECMA6_NATIVE?this._imp=new Set:(this._map=new e,this._arr=new Array)}return n.prototype._n_add=function(t){return this._imp.add(t)},n.prototype._i_add=function(t){var e=Js.hashKey(t);return void 0!=this._map[e]?!1:(this._map[e]=!0,this._arr.push(t),!0)},n.prototype._n_has=function(t){return this._imp.has(t)},n.prototype._i_has=function(t){var e=Js.hashKey(t);return void 0!=this._map[e]},n.prototype._n_delete=function(t){return this._imp["delete"](t)},n.prototype._i_delete=function(t){var e=Js.hashKey(t);if(void 0==this._map[e])return!1;this._map["delete"](e);var n=this._arr.indexOf(t);return this._arr.splice(n,1),!0},n.prototype._n_size=function(){return this._imp.size},n.prototype._i_size=function(){return this._arr.length},Object.defineProperty(n.prototype,"size",{get:function(){return t.ECMA6_NATIVE?this._n_size():this._i_size()},enumerable:!0,configurable:!0}),n.prototype._n_clear=function(){this._imp.clear()},n.prototype._i_clear=function(){this._arr.length&&(this._map.clear(),this._arr.length=0)},n.prototype._n_foreach=function(t,e){this._imp.forEach(t,e)},n.prototype._i_foreach=function(t,e){this._arr.length&&this._arr.forEach(t,e)},n}();t.CSet=n}(nn||(nn={}));var tritrue=1,trifalse=0,trimay=2,nn;!function(nn){function Integral(t){return t+.5>>0}function any_cast(t){return t}function EventHook(t,e,n,i,r){null==i&&(i=t),0==t.hasEventListener(e,n,i,r)&&t.addEventListener(e,n,i,r)}function EventUnhook(t,e,n,i,r){null==i&&(i=t),t.removeEventListener(e,n,i,r)}function grab(t){return null!=t?(t.grab(),t):void 0}function drop(t){return null!=t?t.drop():void 0}function dispose(t){null!=t&&t.dispose()}function test(t,e){nn.ISDEBUG?t.call(e):fatal("must remove this test")}function debug(t,e){nn.VERBOSE&&t.call(e)}function vardump(t,e){void 0===e&&(e=2);var n="{";for(var i in t){n+='"'+i+'":';var r=t[i];if(null==r)n+="null";else{var o=typeof r;switch(o){case"string":n+='"'+r+'"';break;case"boolean":n+=r?"true":"false";break;case"number":n+=r;break;case"function":n+=r.name+"(#"+r.length+")";break;default:n+=e?vardump(r,e-1):"<truncated>"}}n+=","}return n+="}"}function callstack(){for(var t=[],e=arguments.callee.caller;e;)t.push(e),e=e.caller;return t}function log(t,e){nn.VERBOSE&&debug.log(t,debug.text)}function obj(t){nn.VERBOSE&&debug.obj(t)}function dump(t,e){if(nn.VERBOSE){var n=vardump(t,e);return debug.log(n,debug.obje),n}return""}function info(t){nn.VERBOSE&&debug.log(t,debug.info)}function noti(t){nn.VERBOSE&&debug.log(t,debug.noti)}function warn(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];nn.VERBOSE&&(debug.log(t,debug.warn),n.length&&debug.group(e,function(){n.forEach(function(t){debug.obj(t)})},this),console.log(console.trace()))}function exception(t,e){if(nn.VERBOSE){var n="";e&&e.length&&(n+=e+": "),n+=t.message,warn(n,t.name,t.stack)}Debugger()}function msgbox(t){noti(t),nn.VERBOSE&&alert(t)}function assert(t,e){t||(warn(e),Debugger())}function val(t,e){return null==t?e:t}function gt(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t>e?t:n}function lt(t,e,n){return void 0===e&&(e=0),void 0===n&&(n=0),e>t?t:n}function Debugger(){nn.ISCHROME}function fatal(t){warn(t),alert(t),Debugger()}function length(t,e){return void 0===e&&(e=0),null==t?e:t.length}function nonnull1st(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0;i<e.length;++i){var r=e[i];if(null!=r)return r}return t}function at(t,e,n){return void 0===n&&(n=null),null==t?n:length(t)<=e?n:t[e]}function isZero(t){return null==t||0==t?!0:t.length?0==t.length:!1}function SafeNumber(t,e){return void 0===e&&(e=0),isNaN(t)?e:t}function toFloat(t,e){if(void 0===e&&(e=0),null==t)return e;var n=typeof t;if("number"==n)return SafeNumber(t,e);if("string"==n){var i=parseFloat(t);return SafeNumber(i,e)}return t.toNumber?t.toNumber():e}function toInt(t,e){if(void 0===e&&(e=0),null==t)return e;var n=typeof t;if("number"==n||"string"==n){var i=parseInt(t);return SafeNumber(i,e)}return t.toNumber?t.toNumber()>>0:e}function toNumber(t,e){if(void 0===e&&(e=0),null==t)return e;var n=typeof t;if("number"==n)return SafeNumber(t,e);if("string"==n){if(-1==t.indexOf(".")){var i=parseInt(t);return SafeNumber(i,e)}var r=parseFloat(t);return SafeNumber(r,e)}return t.toNumber?t.toNumber():e}function asString(t,e){if(void 0===e&&(e=""),null==t)return e;var n=typeof t;return"string"==n?t:"number"==n?SafeNumber(t).toString():t.toString?t.toString():e}function toJsonObject(t,e){void 0===e&&(e=null);var n=typeof t;return"string"==n?JSON.parse(t):"object"==n?n:e}function formatString(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];try{return nn.Invoke1(Js.printf,this,e,t)}catch(i){exception(new Error("format: "+t+"\nargus: "+dump(e)+"\n"+i))}return""}function formatStringV(t,e){try{return nn.Invoke1(Js.printf,this,e,t)}catch(n){exception(new Error("format: "+t+"\nargus: "+dump(e)+"\n"+n))}return""}function json_encode(t){return JSON.stringify(t)}function json_decode(t){var e;try{e=JSON.parse(t)}catch(n){exception(n)}return e}function IsEmpty(t){if(null==t)return!0;var e=typeof t;return"string"==e?0==e.length?!0:null!=t.match(/^\s*$/):t instanceof Array?0==t.length:t instanceof nn.CMap?0!=t.length:t instanceof nn.CSet?0!=t.size:0==Object.keys(t).length}function TRIVALUE(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 3==t.length?t[0]?t[1]:t[2]:t[0]?t[0]:t[1]}function Cmp(t,e,n){switch(n){case CMP.EQUAL:return t==e;case CMP.EQUALQ:return t===e;case CMP.LESSEQUAL:return e>=t;case CMP.GREATEREQUAL:return t>=e;case CMP.LESS:return e>t;case CMP.GREATER:return t>e;case CMP.NOTEQUAL:return t!=e;case CMP.NOTEQUALQ:return t!==e}}function linq(t){return new LINQ(t)}function GetColorComponent(t){switch(typeof t){case"number":var e=16777215&t,n=(t>>24&255)*Color._1_255;return[e,n>0?n:1];case"string":var i=t.toLowerCase();switch(i){case"red":return[16711680,1];case"green":return[65280,1];case"blue":return[255,1];case"white":return[16777215,1];case"black":return[0,1];default:i=i.replace("#","0x");var r=toInt(i),e=16777215&r,n=(r>>24&255)*Color._1_255;return[e,n>0?n:1]}default:return[t.rgb,t.alphaf]}}function DirectionIsPortrait(t){return t==Direction.UP||t==Direction.DOWN}function DirectionIsLandscape(t){return t==Direction.LEFT||t==Direction.RIGHT}function DirectionAngle(t,e){return Angle.DIRECTION(e).sub(Angle.DIRECTION(t))}function DirectionFromSize(t,e){return t>e?Direction.LEFT:Direction.UP}function DirectionToString(t){var e=[];return nn.Mask.isset(Direction.UP,t)&&e.push("up"),nn.Mask.isset(Direction.DOWN,t)&&e.push("down"),nn.Mask.isset(Direction.LEFT,t)&&e.push("left"),nn.Mask.isset(Direction.RIGHT,t)&&e.push("right"),e.join(",")}function DirectionFromString(t){if(!t)return 0;var e=t.toLowerCase().split(","),n=0;return ArrayT.Contains(e,"up")&&(n|=Direction.UP),ArrayT.Contains(e,"down")&&(n|=Direction.DOWN),ArrayT.Contains(e,"left")&&(n|=Direction.LEFT),ArrayT.Contains(e,"right")&&(n|=Direction.RIGHT),n}function FillModeString(t){var e=[];switch(t&FillMode.MASK_MAJOR){case FillMode.STRETCH:e.push("STRETCH");break;case FillMode.CENTER:e.push("CENTER");break;case FillMode.ASPECTSTRETCH:e.push("ASPECTSTRETCH");break;case FillMode.NEARESTSTRETCH:e.push("NEARESTSTRETCH");break;case FillMode.ASPECTFILL:e.push("ASPECTFILL")}return Mask.isset(FillMode.NOBORDER,t)&&e.push("NOBORDER"),Mask.isset(FillMode.MAXIMUM,t)&&e.push("MAXIMUM"),Mask.isset(FillMode.NEAREST,t)&&e.push("NEAREST"),e.join("|")}function Delay(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];if(0>=t)return e.call(n,i),null;var o=new Timer(t,1);return o.signals.connect(nn.SignalDone,function(){e.call(n,i),o.stop()},null),o.start(),o}function Repeat(t,e,n){var i=new RtTimer(t);return i.signals.connect(nn.SignalAction,e,n),i.start(),i}function ScreenTypeIsLow(t){return 0>t}function ScreenTypeIsHigh(t){return t>0}function retry(t,e,n,i){var r=new Retry(t,e,n,i);return nn.Defer(r.next,r),r}var FrameworkFeature;!function(t){t[t.NOSYNC=4]="NOSYNC",t[t.MULTIRES=8]="MULTIRES",t[t.FULLSCREEN=16]="FULLSCREEN",t[t.DEFAULT=0]="DEFAULT"}(FrameworkFeature=nn.FrameworkFeature||(nn.FrameworkFeature={}));var LocatingType;!function(t){t[t.LAYOUT=0]="LAYOUT",t[t.ABSOLUTE=1]="ABSOLUTE",t[t.RELATIVE=2]="RELATIVE"}(LocatingType=nn.LocatingType||(nn.LocatingType={})),nn.ScaleFactorX=1,nn.ScaleFactorDeX=1,nn.ScaleFactorY=1,nn.ScaleFactorDeY=1,nn.ScaleFactorW=1,nn.ScaleFactorDeW=1,nn.ScaleFactorH=1,nn.ScaleFactorDeH=1,nn.ScaleFactorS=1,nn.ScaleFactorDeS=1,nn.StageScaleFactorX=1,nn.StageScaleFactorY=1,nn.DomScaleFactorX=1,nn.DomScaleFactorY=1,nn.DomOffsetX=0,nn.DomOffsetY=0,nn.MAX_INT=9007199254740991,nn.Integral=Integral;var RefVariable=function(){function t(){}return t.prototype.get=function(){return this._val},t.prototype.set=function(t,e){void 0===e&&(e=!0),this._val&&this._val.drop(),this._val=t,t&&e&&t.grab()},t.prototype.dispose=function(){this._val&&(this._val.drop(),this._val=void 0)},t}();nn.RefVariable=RefVariable,nn.any_cast=any_cast;var SObject=function(){function t(){this.hashCode=++t.HashCode,this.__disposed=!1,this._refcnt=1}return t.prototype.dispose=function(){nn.ISDEBUG&&this.__disposed&&warn("对象 "+nn.Classname(this)+" 已经析构"),this.__disposed=!0,this._attachs&&ArrayT.Clear(this._attachs,function(t){drop(t)}),this._signals&&(this._signals.dispose(),this._signals=void 0)},t.prototype._initSignals=function(){},Object.defineProperty(t.prototype,"signals",{get:function(){return this._signals?this._signals:(this._instanceSignals(),this._signals)},enumerable:!0,configurable:!0}),t.prototype._instanceSignals=function(){this._signals=new nn.Signals(this),this._initSignals()},t.prototype.attach=function(t){void 0!=t.grab&&(null==this._attachs&&(this._attachs=new Array),t.grab(),this._attachs.push(t))},t.prototype.detach=function(t){if(void 0!=t.drop&&null!=this._attachs){if(nn.ISDEBUG&&!ArrayT.Contains(this._attachs,t))return void warn("尝试从 attachs 中移除一个本来没有加入的对象");t.drop(),ArrayT.RemoveObject(this._attachs,t)}},t.prototype.drop=function(){nn.ISDEBUG&&this.__disposed&&warn("对象 "+nn.Classname(this)+" 已经析构"),0==--this._refcnt&&this.dispose()},t.prototype.grab=function(){++this._refcnt},t.prototype.callself=function(t,e){return t.call(e?e:this,this),this},Object.defineProperty(t.prototype,"obj",{get:function(){return this},enumerable:!0,configurable:!0}),t.prototype.isnull=function(){return this.__disposed?!0:!1},t.prototype.isEqual=function(t){return this==t},Object.defineProperty(t.prototype,"clazz",{get:function(){return nn.ObjectClass(this)},enumerable:!0,configurable:!0}),t.New=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=nn.InstanceNewObject(this,e);return t&&t.call(this,i),i},t}();SObject.HashCode=0,nn.SObject=SObject;var SObjectWrapper=function(t){function e(n){var i=t.call(this)||this;i._wrpobj=n;var r=i._wrpobj;return r.signals=i.signals,r.attach=e._imp_attach,r.dispose=e._imp_dispose,r.__sobj_wrapper=i,i}return __extends(e,t),e.prototype.dispose=function(){var e=this._wrpobj;e.signals=null,e.dispose=null,e.__sobj_wrapper=null,this._wrpobj=null,t.prototype.dispose.call(this)},e}(SObject);SObjectWrapper._imp_dispose=function(){var t=this;t.__sobj_wrapper.dispose()},SObjectWrapper._imp_attach=function(t){var e=this;e.__sobj_wrapper.attach(t)},nn.SObjectWrapper=SObjectWrapper,nn.OBJECT_DEFAULT_KEYS=["hashCode"],nn.EventHook=EventHook,nn.EventUnhook=EventUnhook,nn.grab=grab,nn.drop=drop,nn.dispose=dispose;var Failed=function(){function t(t,e,n){this.code=t,this.message=e,null==n&&(n=e),this.locationMessage=n}return t.prototype.toString=function(){return this.code+": "+this.locationMessage},t}();nn.Failed=Failed,nn.test=test,nn.debug=debug,function(t){function e(t,e){nn.ISHTML5?console.log(e.p+t,e.c):console.log(t)}function n(t){console.log("%o",t)}function i(t,e,n){r&&console.groupCollapsed(t),e.call(n),r&&console.groupEnd()}t.text={p:"%c",c:"color:#b0b0b0"},t.obje={p:"%c",c:"color:#f8881a"},t.info={p:"",c:""},t.noti={p:"%c",c:"color:blue"},t.warn={p:"%c",c:"color:red"},t.log=e,t.obj=n;var r=null!=console.groupCollapsed;t.group=i}(debug=nn.debug||(nn.debug={})),nn.vardump=vardump,nn.callstack=callstack,nn.log=log,nn.obj=obj,nn.dump=dump,nn.info=info,nn.noti=noti,nn.warn=warn,nn.exception=exception,nn.msgbox=msgbox,nn.assert=assert,nn.val=val,nn.gt=gt,nn.lt=lt,nn.ISCHROME=null!=window.chrome,nn.Debugger=Debugger,nn.fatal=fatal,nn.length=length,nn.nonnull1st=nonnull1st,nn.at=at,nn.isZero=isZero,nn.toFloat=toFloat,nn.toInt=toInt,nn.toNumber=toNumber,nn.asString=asString,nn.toJsonObject=toJsonObject,nn.formatString=formatString,nn.formatStringV=formatStringV;var FormatString=function(){function t(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.fmt=t,this.args=e}return t.prototype.toString=function(){return formatStringV(this.fmt,this.args)},t}();nn.FormatString=FormatString,nn.json_encode=json_encode,nn.json_decode=json_decode,nn.IsEmpty=IsEmpty,nn.TRIVALUE=TRIVALUE;var CMP;!function(t){t[t.EQUAL=0]="EQUAL",t[t.EQUALQ=1]="EQUALQ",t[t.LESSEQUAL=2]="LESSEQUAL",t[t.GREATEREQUAL=3]="GREATEREQUAL",t[t.LESS=4]="LESS",t[t.GREATER=5]="GREATER",t[t.NOTEQUAL=6]="NOTEQUAL",t[t.NOTEQUALQ=7]="NOTEQUALQ"}(CMP=nn.CMP||(nn.CMP={})),nn.Cmp=Cmp;var Codec=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.write=function(t){return null},e.prototype.read=function(){return null},e.prototype.toString=function(){return null},e.prototype.fromString=function(t){},e}(SObject);nn.Codec=Codec;var JsonCodec=function(_super){function JsonCodec(){var t=_super.call(this)||this;return t._d=[],t._sck=[],t._sck.push(t._d),t}return __extends(JsonCodec,_super),JsonCodec.prototype.write=function(t){var e=this;if(null==t)return null;var n=ArrayT.Top(this._sck),i=typeof t;if("number"==i||"string"==i)n.push(t);else{if("object"!=i)return null;if(t instanceof Array){var r={__:"Array","--":[]};n.push(r),this._sck.push(r["--"]),t.forEach(function(t){e.write(t)},this),this._sck.pop()}else if(t instanceof nn.CMap){var r={__:"Map","--":[[],[]]};n.push(r),this._sck.push(r["--"][0]),t.forEach(function(t,n){e.write(n)&&e.write(t)},this),this._sck.pop(),this._sck.push(r["--"][1]),MapT.Foreach(t,function(t,n){e.write(t)&&e.write(n)},this),this._sck.pop()}else if("function"==typeof t.serialize){var r={__:nn.Classname(t),"--":[]};n.push(r),this._sck.push(r["--"]),t.serialize(this),this._sck.pop()}else{var r={__:"Object","--":[]};n.push(r),this._sck.push(r["--"]),MapT.Foreach(t,function(t,n){e.write(t)&&e.write(n)},this),this._sck.pop()}}return n},JsonCodec.prototype.read=function(){var _this=this,top=ArrayT.Top(this._sck),o=top[0],tp=typeof o;if("number"==tp||"string"==tp)return o;var objcls=o.__,objdata=o["--"],obj=eval("new "+objcls+"()");if("Array"==objcls)objdata.forEach(function(t){_this._sck.push([t]);var e=_this.read();_this._sck.pop(),obj.push(e)},this);else if("Map"==objcls){for(var o0=objdata[0],o1=objdata[1],i=0;i<o0.length;++i){var k=o0[i],v=o0[++i];this._sck.push([k]),k=this.read(),this._sck.pop(),this._sck.push([v]),v=this.read(),this._sck.pop(),obj.set(k,v)}for(var i=0;i<o1.length;++i){var k=o1[i],v=o1[++i];this._sck.push([k]),k=this.read(),this._sck.pop(),this._sck.push([v]),v=this.read(),this._sck.pop(),obj[k]=v}}else if("Object"==objcls)for(var i=0;i<objdata.length;++i){var k=objdata[i],v=objdata[++i];this._sck.push([k]),k=this.read(),this._sck.pop(),this._sck.push([v]),v=this.read(),this._sck.pop(),obj[k]=v}else"function"==typeof obj.unserialize&&(this._sck.push(objdata),obj.unserialize(this),this._sck.pop());return obj},JsonCodec.prototype.toString=function(){return JSON.stringify(this._d)},JsonCodec.prototype.fromString=function(t){this.clear();var e=JSON.parse(t);ArrayT.Set(this._d,e),this.read()},JsonCodec.prototype.clear=function(){this._d.length=0,this._sck.length=0,this._sck.push(this._d)},JsonCodec}(Codec);nn.JsonCodec=JsonCodec;var StringBuilder=function(){function t(){this.linebreak="\n",this._buf=""}return t.prototype.line=function(t,e,n){return null==t&&(t=""),(null!=e||null!=n)&&this.font(e,n),this._buf+=t+this.linebreak,this},t.prototype.add=function(t,e,n){return null==t&&(t=""),(null!=e||null!=n)&&this.font(e,n),this._buf+=t,this},t.prototype.font=function(t,e){var n="";return null!=t&&(n+=" color="+GetColorComponent(t)[0]),null!=e&&(n+=" size="+e),n.length&&(this._buf+="<font"+n+">"),this},t.prototype.href=function(t,e){return null==e&&(e=t),this._buf+="<font u=true href=event:"+e+">"+t,this},t.prototype.touch=function(t){return this._buf+="<font href=event:"+t+">"+t,this},t.prototype.pop=function(){return this._buf+="</font>",this},t.prototype.concat=function(t){return this._buf+=t._buf,this},t.prototype.toString=function(){return this._buf},t}();nn.StringBuilder=StringBuilder;var UnsignedInt=function(){function t(t){void 0===t&&(t=0),this.obj=t}return Object.defineProperty(t.prototype,"obj",{get:function(){return this._obj},set:function(t){0>t?this._d=nn.MAX_INT+t:this._d=t,this._obj=t},enumerable:!0,configurable:!0}),t.prototype.valueOf=function(){return this._d},t}();nn.UnsignedInt=UnsignedInt;var SafeSet=function(){function t(){this._set=new nn.CSet}return t.prototype.has=function(t){return this._set.has(t)},t.prototype["delete"]=function(t){this._set.has(t)&&this._set["delete"](t)},t.prototype.add=function(t){0==this._set.has(t)&&this._set.add(t)},t.prototype.forEach=function(t,e){this._set.forEach(t,e)},Object.defineProperty(t.prototype,"size",{get:function(){return this._set.size},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._set.clear()},t}();nn.SafeSet=SafeSet;var ObjectT=function(){function t(){}return t.IsEqual=function(t,e,n,i){return null==t||null==e?!1:n?n.call(i,t,e):t&&t.isEqual?t.isEqual(e):e&&e.isEqual?e.isEqual(t):t==e},t.Copy=function(t,e,n){var i=this;if(void 0===n&&(n=!0),!this.IsEqual(t,e)){var r=n?e:t,o=Object.keys(r);ArrayT.RemoveObjectsInArray(o,nn.OBJECT_DEFAULT_KEYS),o.forEach(function(n){if(0!=n.indexOf("_")){var o=typeof r[n];if("string"==o||"number"==o||"boolean"==o)t[n]=e[n];else if("object"==o){var s=e[n];if(s instanceof Array){null==t[n]&&(t[n]=[]);var a=t[n];ArrayT.Resize(a,s.length),a.forEach(function(t,e){null==t&&(t=nn.InstanceNewObject(s[e]),a[e]=t),i.Copy(t,s[e])})}else{var c=nn.InstanceNewObject(s);i.Copy(c,s),t[n]=c}}}})}},t.GetValueByKeyPath=function(t,e,n){if(null==t)return n;for(var i=e.split("."),r=0;r<i.length;++r)if(t=t[i[r]],null==t)return n;return t},t.SetValueByKeyPath=function(t,e,n){if(null==t)return void warn("不能对null进行keypath的设置操作");for(var i=e.split("."),r=i.length-1,o=0;r>o;++o){var s=i[o],a=t[s];null==a&&(a={},t[s]=a),t=a}t[i[r]]=n},t}();nn.ObjectT=ObjectT;var NumberT=function(){function t(){}return t.SciNot=function(e){var n=t.log(e,10),i=e/Math.pow(10,n);return[i,n]},t.radical=function(t,e,n){return Math.exp(1/n*Math.log(e))},t.log=function(t,e){var n=Math.log(t)/Math.log(e)+1e-7;return n>>0},t.Unsigned=function(t){return 0>t?4294967295+t+1:t},t.MapToBase=function(t,e){return t%e==0?e:t%e},t.Add=function(t,e){return null==t&&(t=0),null==e&&(e=0),t+e},t.Sub=function(t,e){return null==t&&(t=0),null==e&&(e=0),t-e},t.Multiply=function(t,e){return null==t&&(t=0),null==e&&(e=0),t*e},t.Div=function(t,e){return null==t&&(t=0),null==e||0==e?nn.MAX_INT:t/e},t.Hanlize=function(t){var e;0>t&&(e=!0,t=-t);var n=e?"负":"";return 10>=t&&(n+=this.HANMAPS[t]),n},t}();NumberT.HANMAPS=["零","一","二","三","四","五","六","七","八","九","十"],nn.NumberT=NumberT;var StringT=function(){function t(){}return t.FormatFloat=function(t,e,n){void 0===n&&(n=!0);var i=formatString("%."+e+"f",t);return n&&(i=this.TermFloat(i)),i},t.TermFloat=function(t){var e=t.split(".");if(2!=e.length)return warn("传入的 stirng 格式错误"),t;for(var n=e[1],i=!1,r="",o=n.length;o>0;--o){var s=n[o-1];i||"0"==s||(i=!0),i&&(r=s+r)}return 0==r.length?e[0]:e[0]+"."+r},t.Hash=function(t){var e=0;if(0==t.length)return e;for(var n=0;n<t.length;++n)e=(e<<5)-e+t.charCodeAt(n)&4294967295;return e},t.Count=function(t,e){var n=t.indexOf(e);if(-1==n)return 0;var i=1;return i+=this.Count(t.substr(n+e.length),e)},t.AsciiLength=function(t){for(var e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);e+=i>128?2:1}return e},t.Split=function(t,e,n){void 0===n&&(n=!0);var i=t.split(e),r=[];return i.forEach(function(t){t.length&&r.push(t)}),r},t.Stretch=function(t,e,n,i,r){if(void 0===n&&(n=0),void 0===i&&(i=" "),void 0===r&&(r=!0),t.length>=e)return t;if(0==t.length){for(var o="";e--;)o+=i;return o}var s=e-t.length,a="";switch(n){case 0:var c=(e-t.length)/(t.length-1);if(r&&(c*=2),c>=1){for(var u=0;u<t.length-1;++u){a+=t[u];for(var l=0;c>l;++l)a+=i}a+=t[t.length-1]}else a=t;if(a.length<e)for(s=e-t.length,r&&(s*=2);s--;)a+=i;break;case 1:for(;s--;)a=i+a;a+=t;break;case 2:for(a=t;s--;)a+=i}return a},t.ForeachAsciiCode=function(t,e){var n=new egret.ByteArray;n.writeUTFBytes(t),n.position=0;for(var i=n.length,r=0;i>r;++r)e(n.readUnsignedByte(),r)},t.Code=function(t){for(var e=[],n=t.length,i=0;n>i;++i)e.push(t.charCodeAt(i));return e},t.FromCode=function(t){return String.fromCharCode.apply(null,t)},t}();nn.StringT=StringT;var ArrayT=function(){function t(){}return t.Allocate=function(t,e){for(var n="function"==typeof e,i=e,r=[],o=0;t>o;++o){var s=n?i(o):e;r.push(s)}return r},t.ToArray=function(t){return null==t?[]:t instanceof Array?t:[t]},t.Merge=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[];return t.forEach(function(t){n=n.concat(t)}),n},t.Contains=function(t,e,n,i){return t.some(function(t){return ObjectT.IsEqual(t,e,n,i)},this)},t.Concat=function(t,e){return null==t?e:null==e?t:t.concat(e)},t.PushObjects=function(t,e){e&&e.forEach(function(e){t.push(e)})},t.Top=function(t,e){return at(t,t.length-1,e)},t.SetTop=function(t,e){0==t.length?t.push(e):t[t.length-1]=e},t.PopTop=function(t,e){return 0==t.length?e:t.pop()},t.QueryObject=function(t,e,n,i){var r=i;return t.some(function(t,i){return e.call(n,t,i)?(r=t,!0):!1},this),r},t.QueryObjects=function(t,e,n){var i=[];return t.forEach(function(t,r){e.call(n,t,r)&&i.push(t)}),i},t.QueryIndex=function(t,e,n,i){var r=i;return t.some(function(t,i){return e.call(n,t,i)?(r=i,!0):!1},this),r},t.TrustLength=function(t,e){void 0===e&&(e=null);var n=0;return t.forEach(function(t){t!=e&&++n}),n},t.TrustAddObject=function(t,e,n){void 0===n&&(n=null);for(var i=0;i<t.length;++i)if(t[i]==n)return t[i]=e,!0;return!1},t.TrustRemoveObject=function(t,e,n){void 0===n&&(n=null);var i=t.indexOf(e);-1!=i&&(t[i]=n)},t.TrustSet=function(t,e,n){void 0===n&&(n=null);for(var i=0;i<t.length;++i){var r=e[i];t[i]=r?r:n}},t.TrustPop=function(t,e,n){void 0===n&&(n=null);for(var i=0;i<t.length;++i){var r=this.RemoveObjectAtIndex(e,0);t[i]=r?r:n}},t.TrustClear=function(t,e){void 0===e&&(e=null);for(var n=0;n<t.length;++n)t[n]=e},t.InsertObjectAtIndex=function(t,e,n){t.splice(n,0,e)},t.Clear=function(t,e,n){e&&t.forEach(e,n),t.length=0},t.SafeClear=function(e,n,i){t.Clear(t.Clone(e),n,i),e.length=0},t.SafePush=function(t,e,n){var i=e?e:n;i&&t.push(i)},t.Fill=function(t,e,n,i){for(null==t&&(t=[]);e--;)t.push(n.call(i));return t},t.FillType=function(t,e,n){for(null==t&&(t=[]);e--;)t.push(new n);return t},t.ForeachWithArray=function(t,e,n,i,r){for(var o=t.length,s=e.length,a=Math.max(o,s),c=0;a>c;++c){var u=o>c?t[c]:r,l=s>c?e[c]:r;n.call(i,u,l,c)}},t.Foreach=function(t,e,n){t.every(function(t,i){return e.call(n,t,i)},this)},t.ForeachRow=function(t,e,n,i){for(var r=Math.ceil(t.length/e),o=0;r>o;++o)for(var s=0;e>s;++s){var a=o*e+s;if(0==n.call(i,t[a],o,s,a,r))return}},t.Random=function(t){return 0==t.length?null:t[Random.Rangei(0,t.length)]},t.SafeForeach=function(e,n,i){t.Foreach(t.Clone(e),n,i)},t.Iterate=function(e,n,i){if(0!=e.length){var r=e.length-1;t.Foreach(e,function(t,e){return n.call(i,t,e,e==r)},i)}},t.FullEach=function(t,e,n,i){for(var r=Math.min(t.length,e),o=0;r>o;++o)n(t[o],o);if(r>=e){r=t.length;for(var o=e;r>o;++o)i(t[o],o)}},t.LengthQuery=function(t,e,n){var i=0;return t.forEach(function(t,r){e.call(n,t,r)&&(i+=1)},this),i},t.RemoveObject=function(t,e){if(null==e||null==t)return!1;var n=t.indexOf(e);return nn.ISDEBUG&&-1==n?(warn("obj 不属于 array 的元素"),!1):(t.splice(n,1),!0)},t.RemoveObjectAtIndex=function(t,e){var n=t.splice(e,1);return n[0]},t.RemoveObjectByFilter=function(t,e,n){for(var i=0;i<t.length;++i){var r=t[i];if(e.call(n,r,i))return t.splice(i,1),r}return null},t.RemoveObjectsByFilter=function(e,n,i){var r=[],o=e.filter(function(t,e){return n.call(i,t,e)?(r.push(t),!1):!0},this);return e.length==o.length?r:(t.Set(e,o),r)},t.RemoveObjectsInArray=function(e,n){var i=e.filter(function(e,i){return!t.Contains(n,e)},this);t.Set(e,i)},t.RemoveObjectsInIndexArray=function(e,n){var i=[],r=e.filter(function(e,r){return 1==t.Contains(n,r)?(i.push(e),!1):!0},this);return t.Set(e,r),i},t.Resize=function(t,e,n){if(t.length<e)for(var i=e-t.length,r=(t.length,0);i>r;++r)t.push(n);else t.length>e&&(t.length=e)},t.Rise=function(t,e){var n=[],i=[];t.forEach(function(t){e(t)?n.push(t):i.push(t)}),this.Set(t,n.concat(i))},t.Sink=function(t,e){var n=[],i=[];t.forEach(function(t){e(t)?n.push(t):i.push(t)}),this.Set(t,i.concat(n))},t.Set=function(t,e){t.length=0,e.forEach(function(e){t.push(e)},this)},t.Clone=function(t){return t.concat()},t.Convert=function(t,e,n){var i=[];return t.forEach(function(t,r){i.push(e.call(n,t,r))}),i},t.SafeConvert=function(t,e,n){var i=[];return t.forEach(function(t,r){var o=e.call(n,t,r);o&&i.push(o)}),i},t.Filter=function(t,e,n){var i=[];return t.forEach(function(t,i){var r=e.call(n,t,i);r&&r.push(r)}),i},t.ArrayInArray=function(e,n){return e.filter(function(e){return t.Contains(n,e)},this)},t.Combine=function(t,e){for(var n=t[0],i=1;i<t.length;i++)n+=e+t[i];return n},t.EqualTo=function(e,n,i,r){return e.length!=n.length?!1:n.every(function(n){return t.Contains(e,n,i,r)},this)},t.StrictEqualTo=function(t,e,n,i){return t.length!=e.length?!1:e.every(function(t,r){return ObjectT.IsEqual(t,e[r],n,i)},this)},t.Disorder=function(t){t.sort(function(){return Math.random()})},t.Trim=function(e,n){void 0===n&&(n=null);for(var i=[],r=e.length;0!=r;--r){var o=e[r-1];(0!=i.length||o!=n)&&i.push(o)}t.Set(e,i.reverse())},t.HashUnique=function(t,e){void 0===e&&(e=!0);var n=[];if(e){var i={};t.forEach(function(t){var e=t.hashCode;i[e]||(n.push(t),i[e]=!0)})}else t.forEach(function(t){-1==n.indexOf(t)&&n.push(t)});this.Set(t,n)},t.Unique=function(t,e,n){var i=this,r=[];t.forEach(function(t){0==i.Contains(r,t,e,n)&&r.push(t)}),this.Set(t,r)},t.RangeOf=function(t,e,n){var i=t.length;if(0>e&&(e=i+e,0>e))return t;if(e>=i)return[];var r=null==n?i:e+n;return t.slice(e,r)},t.PopRangeOf=function(t,e,n){var i=t.length;if(0>e&&(e=i+e,0>e)){var r=t.concat();return t.length=0,r}if(e>=i)return[];var o=null==n?i-e:n;return t.splice(e,o)},t.SplitByLength=function(t,e){for(var n=[],i=Math.ceil(t.length/e),r=0;i>r;++r)n.push(this.RangeOf(t,r*e,e));return n},t.Next=function(t,e,n){var i=t.indexOf(e);return-1==i?n:i+1==t.length?n:t[i+1]},t.Previous=function(t,e,n){var i=t.indexOf(e);return-1==i?n:0==i?n:t[i-1]},t}();nn.ArrayT=ArrayT,nn.linq=linq;var LINQ=function(){function t(t){this._ref=!0,t?this._arr=t:(this._arr=new Array,this._ref=!1)}return t.prototype._safe=function(){this._ref&&(this._arr=this._arr.concat(),this._ref=!1)},t.prototype.forEach=function(t){for(var e=0,n=this._arr.length;n>e;++e)if(0==t(this._arr[e],e))return},t.prototype.where=function(t){var e=[];return this._arr.forEach(function(n,i){t(n,i)&&e.push(n)}),nn.InstanceNewObject(this,e)},t.prototype.count=function(t){return t?this.where(t).count():this._arr.length},t.prototype.add=function(t){this._safe(),this._arr.push(t)},t.prototype.exists=function(t){return null!=ArrayT.QueryObject(this._arr,t)},t.prototype.first=function(t){if(0==this._arr.length)return null;if(!t)return this._arr[0];var e=this.where(t);return 0==e.count()?null:e.at(0)},t.prototype.last=function(t){if(0==this._arr.length)return null;if(!t)return this._arr[this._arr.length-1];var e=this.where(t);return 0==e.count()?null:e.last()},t.prototype.at=function(t){return 0>t||t>this._arr.length?null:this._arr[t]},t.prototype.union=function(t,e){var n=[],i={};return this._arr.forEach(function(t){var r=Js.hashKey(e(t));i[r]||(i[r]=t,n.push(t))}),t.forEach(function(t){var r=Js.hashKey(e(t));i[r]||(i[r]=t,n.push(t))}),nn.InstanceNewObject(this,n)},t}();nn.LINQ=LINQ;var SetT=function(){function t(){}return t.RemoveObject=function(t,e){t["delete"](e)},t.Clone=function(t){var e=new nn.CSet;return t.forEach(function(t){e.add(t)},this),e},t.ToArray=function(t){var e=new Array;return t.forEach(function(t){e.push(t)},this),e},t.Clear=function(t,e,n){0!=t.size&&(e&&t.forEach(e,n),t.clear())},t.SafeClear=function(e,n,i){if(0!=e.size){var r=t.Clone(e);e.clear(),r.forEach(n,i)}},t}();nn.SetT=SetT;var MapT=function(){function t(){}return t.Get=function(t,e){return t[e]},t.GetValues=function(t){var e=[];return this.Foreach(t,function(t,n){e.push(n)}),e},t.Add=function(t,e,n){t[e]=n},t.Foreach=function(t,e,n){var i=Object.keys(t);i.forEach(function(i){e.call(n,i,t[i])},this)},t.ToArray=function(t,e,n){var i=[],r=Object.keys(t);return r.forEach(function(r){var o=e.call(n,r,t[r]);i.push(o)},this),i},t.SafeToArray=function(t,e,n){var i=[],r=Object.keys(t);return r.forEach(function(r){var o=e.call(n,r,t[r]);o&&i.push(o)},this),i},t.QueryObject=function(t,e,n){for(var i=Object.keys(t),r=0;r<i.length;++r){var o=i[r];if(e.call(n,o,t[o]))return[o,t[o]]}return null},t.QueryObjects=function(t,e,n){var i=Object.keys(t),r={};return i.forEach(function(i){var o=t[i];e.call(n,i,o)&&(r[i]=o)}),r},t.QueryValue=function(t,e,n){var i=this.QueryObject(t,e,n);return i?i[1]:null},t.QueryValues=function(t,e,n){var i=Object.keys(t),r=[];return i.forEach(function(i){var o=t[i];e.call(n,i,o)&&r.push(o)}),r},t.QueryKey=function(t,e,n){var i=this.QueryObject(t,e,n);return i?i[0]:null},t.QueryKeys=function(t,e,n){var i=Object.keys(t),r=[];return i.forEach(function(i){var o=t[i];
e.call(n,i,o)&&r.push(i)}),r},t.IsEmpty=function(t){return null==t?!0:0==Object.keys(t).length},t.RemoveKey=function(t,e){delete t[e]},t.Clear=function(e,n,i){t.Foreach(e,function(t,r){n&&n.call(i,t,r),delete e[t]},this)},t.Concat=function(e,n){return null==e?n:null==n?e:void t.Foreach(n,function(t,n){e[t]=n},this)},t.Clone=function(e){var n=new KvObject;return t.Foreach(e,function(t,e){n[t]=e},this),n},t.Length=function(t){return Object.keys(t).length},t.ObjectAtIndex=function(t,e,n){var i=Object.keys(t),r=at(i,e,null);return null==r?n:t[r]},t.Simplify=function(t){var e={};return this.Foreach(t,function(t,n){e[t]=n}),e},t}();nn.MapT=MapT;var IndexedMap=function(){function t(){this._map={},this._keys=new Array,this._vals=new Array}return t.prototype.add=function(t,e){if(t in this._map){var n=this._keys.indexOf(t);this._keys[n]=t,this._vals[n]=e}else this._keys.push(t),this._vals.push(e);this._map[t]=e},t.prototype.replace=function(t,e){if(t in this._map){var n=this._keys.indexOf(t);this._vals[n]=e}else this._keys.push(t),this._vals.push(e);this._map[t]=e},t.prototype.remove=function(t){if(!(t in this._map))return null;var e=this._keys.indexOf(t),n=this._vals[e];return ArrayT.RemoveObjectAtIndex(this._keys,e),ArrayT.RemoveObjectAtIndex(this._vals,e),delete this._map[t],n},Object.defineProperty(t.prototype,"length",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){this._keys.length=0,this._vals.length=0,this._map={}},t.prototype.forEach=function(t,e){var n=this;this._keys.forEach(function(i,r){var o=n._vals[r];t.call(e,i,o)},this)},t.prototype.iterateEach=function(t,e){for(var n=0,i=this._keys.length;i>n;++n){var r=this._keys[n],o=this._vals[n];if(!t.call(e,r,o))break}},t.prototype.contains=function(t){return t in this._map},t.prototype.indexOfKey=function(t){return this._keys.indexOf(t)},t.prototype.objectForKey=function(t){return this._map[t]},t.prototype.objectForIndex=function(t){var e=this._keys[t];return this._map[e]},t.prototype.keyForIndex=function(t){return this._keys[t]},Object.defineProperty(t.prototype,"keys",{get:function(){return this._keys.concat()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this._vals},enumerable:!0,configurable:!0}),t}();nn.IndexedMap=IndexedMap;var IndexedMapT=function(){function t(){}return t.RemoveObjectByFilter=function(t,e,n){for(var i=t.keys,r=0,o=i.length;o>r;++r){var s=i[r],a=t.objectForKey(s);if(e.call(n,s,a))return t.remove(s),[s,a]}return null},t.RemoveObjectsByFilter=function(t,e,n){for(var i=new Array,r=t.keys,o=0,s=r.length;s>o;++o){var a=r[o],c=t.objectForKey(a);e.call(n,a,c)&&(t.remove(a),i.push([a,c]))}return i},t.QueryObject=function(t,e,n){for(var i=t.keys,r=0,o=i.length;o>r;++r){var s=i[r],a=t.objectForKey(s);if(e.call(n,s,a))return a}return null},t.Convert=function(t,e,n){var i=new IndexedMap;return t.forEach(function(t){var r=e.call(n,t);i.add(r[0],r[1])}),i},t}();nn.IndexedMapT=IndexedMapT;var MultiMap=function(){function t(){this._map=new IndexedMap}return t.prototype.add=function(t,e){var n=this._map.objectForKey(t);return null==n&&(n=new Array,this._map.add(t,n)),n.push(e),this},t.prototype.replace=function(t,e){this._map.replace(t,e)},t.prototype.objectForKey=function(t){return this._map.objectForKey(t)},t.prototype.remove=function(t){return this._map.remove(t)},t.prototype.forEach=function(t,e){this._map.forEach(t,e)},t.prototype.iterateEach=function(t,e){this._map.iterateEach(t,e)},Object.defineProperty(t.prototype,"keys",{get:function(){return this._map.keys},enumerable:!0,configurable:!0}),t}();nn.MultiMap=MultiMap;var Sort=function(){function t(){}return t.NumberAsc=function(t,e){return t-e},t.NumberDsc=function(t,e){return e-t},t}();nn.Sort=Sort;var List=function(){function t(){this.length=0}return t.prototype.push=function(t){if(this.length+=1,!this._top)return void(this._top={value:t});var e={value:t,previous:this._top};this._top.next=e,this._top=e},t}();nn.List=List;var Color=function(){function t(t,e){void 0===e&&(e=255),this.rgb=0,this.alpha=255,e>0&&1>e&&(e*=255),this.rgb=16777215&t,this.alpha=255&e}return t.prototype.clone=function(){return new t(this.rgb,this.alpha)},Object.defineProperty(t.prototype,"argb",{get:function(){return this.rgb|this.alpha<<24},set:function(t){this.rgb=16777215&t,this.alpha=t>>24&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rgba",{get:function(){return this.rgb<<8|this.alpha},set:function(t){this.rgb=t>>8&16777215,this.alpha=255&t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alphaf",{get:function(){return this.alpha*t._1_255},set:function(t){this.alpha=255*t>>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"red",{get:function(){return this.rgb>>16},set:function(t){this.rgb&=65535,this.rgb|=(255&t)<<16},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redf",{get:function(){return this.red*t._1_255},set:function(t){this.red=255*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"green",{get:function(){return this.rgb>>8&255},set:function(t){this.rgb&=16711935,this.rgb|=(255&t)<<8},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"greenf",{get:function(){return this.green*t._1_255},set:function(t){this.green=255*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"blue",{get:function(){return 255&this.rgb},set:function(t){this.rgb&=16776960,this.rgb|=255&t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bluef",{get:function(){return this.blue*t._1_255},set:function(t){this.blue=255*t},enumerable:!0,configurable:!0}),t.prototype.setAlpha=function(t){return this.alpha=t,this},t.prototype.setAlphaf=function(t){return this.alphaf=t,this},t.prototype.setRed=function(t){return this.red=t,this},t.prototype.setRedf=function(t){return this.redf=t,this},t.prototype.setGreen=function(t){return this.green=t,this},t.prototype.setGreenf=function(t){return this.greenf=t,this},t.prototype.setBlue=function(t){return this.blue=t,this},t.prototype.setBluef=function(t){return this.bluef=t,this},t.prototype.scale=function(t,e){return void 0===e&&(e=!1),this.red*=t,this.green*=t,this.blue*=t,e&&(this.alpha*=t),this},t.prototype.invert=function(){return this.rgb=16777215-this.rgb,this},t.RGBf=function(e,n,i,r){return void 0===r&&(r=1),new t(255*e<<16|255*n<<8|255*i<<0,255*r<<0)},t.RGB=function(e,n,i,r){return void 0===r&&(r=1),new t((255&e)<<16|(255&n)<<8|(255&i)<<0,255*r<<0)},t.ARGB=function(e){return new t(e,e>>24)},t.RGBA=function(e){return new t(e>>8,e)},t.Random=function(e){return void 0===e&&(e=255),new t(Random.Rangei(0,16777215),e)},t.prototype.isEqual=function(t){return this.rgb==t.rgb&&this.alpha==t.alpha},t}();Color._1_255=.00392156862745098,Color.White=new Color(16777215),Color.Black=new Color(0),Color.Gray=new Color(4144959),Color.Red=new Color(16711680),Color.Green=new Color(65280),Color.Blue=new Color(255),Color.Yellow=new Color(16776960),Color.Transparent=new Color(0,0),nn.Color=Color,nn.GetColorComponent=GetColorComponent;var Line=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.smooth=!0,this.color=t,this.width=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSq)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lengthSq",{get:function(){var t=this,e=t.endPoint.x-t.startPoint.x;e*=e;var n=t.endPoint.y-t.startPoint.y;return n*=n,e+n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaX",{get:function(){return this.endPoint.x-this.startPoint.x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaY",{get:function(){return this.endPoint.y-this.startPoint.y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deltaPoint",{get:function(){return new Point(this.endPoint.x-this.startPoint.x,this.endPoint.y-this.startPoint.y)},enumerable:!0,configurable:!0}),t.Segment=function(e,n){var i=new t;return i.startPoint=e,i.endPoint=n,i},t}();nn.Line=Line;var Percentage=function(){function t(t,e){void 0===t&&(t=1),void 0===e&&(e=0),this.max=t,this.value=e}return t.prototype.reset=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=0),this.max=t,this.value=e,this},t.prototype.copy=function(t){return this.max=t.max,this.value=t.value,this},Object.defineProperty(t.prototype,"percent",{get:function(){if(0==this.max)return 1;var t=this.value/this.max;return isNaN(t)?0:t},set:function(t){this.value=this.max*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"safepercent",{get:function(){var t=this.percent;return 0>t?0:t>1?1:t},set:function(t){0>t&&(t=0),t>1&&(t=1),this.percent=this.max*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return 1-this.safepercent},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return formatString("%f/%f = %f%%",this.value,this.max,100*this.percent)},t.prototype.valueOf=function(){return this.percent},t}();nn.Percentage=Percentage;var Mask=function(){function t(){}return t.isset=function(t,e){return(e&t)==t},t.unset=function(t,e){return this.isset(t,e)?e&~t:e},t.set=function(t,e){return this.isset(t,e)?e:e|t},t}();nn.Mask=Mask;var Direction;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CENTER=1]="CENTER",t[t.UP=16]="UP",t[t.DOWN=256]="DOWN",t[t.LEFT=32]="LEFT",t[t.RIGHT=512]="RIGHT",t[t.HOV=544]="HOV",t[t.VEC=272]="VEC"}(Direction=nn.Direction||(nn.Direction={})),nn.DirectionIsPortrait=DirectionIsPortrait,nn.DirectionIsLandscape=DirectionIsLandscape,nn.DirectionAngle=DirectionAngle,nn.DirectionFromSize=DirectionFromSize,nn.DirectionToString=DirectionToString,nn.DirectionFromString=DirectionFromString;var Range=function(){function t(t,e){this.location=t,this.length=e}return t.prototype.contains=function(t){return t>=this.location&&t<=this.max()},t.prototype.intersects=function(t){return Math.max(this.max(),t.max())-Math.min(this.location,t.location)<this.length+t.length},t.prototype.max=function(){return this.location+this.length},t.Intersects=function(t,e,n,i){return Math.max(t+e,n+i)-Math.min(t,n)<e+i},t}();nn.Range=Range;var EdgeInsets=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.top=t,this.bottom=e,this.left=n,this.right=i}return t.All=function(e){return new t(e,e,e,e)},t.prototype.add=function(t,e,n,i){return this.top+=t,this.bottom+=e,this.left+=n,this.right+=i,this},t.prototype.scale=function(t){return this.top*=t,this.bottom*=t,this.left*=t,this.right*=t,this},t.prototype.addEdgeInsets=function(t){return null==t?this:(this.top+=t.top,this.bottom+=t.bottom,this.left+=t.left,this.right+=t.right,this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.left+this.right},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.top+this.bottom},enumerable:!0,configurable:!0}),t.Width=function(t){return null==t?0:t.width},t.Height=function(t){return null==t?0:t.height},t.Top=function(t){return t?t.top:0},t.Left=function(t){return t?t.left:0},t}();nn.EdgeInsets=EdgeInsets;var Point=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.reset=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e,this},t.prototype.clone=function(){var t=nn.InstanceNewObject(this);return t.x=this.x,t.y=this.y,t},t.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.addPoint=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.subPoint=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.add=function(t,e){return t&&(this.x+=t),e&&(this.y+=e),this},t.prototype.multiPoint=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.scale=function(t,e){return null==e&&(e=t),this.x*=t,this.y*=e,this},t.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y},t.prototype.invert=function(){var t=this.x;return this.x=this.y,this.y=t,this},t.prototype.toString=function(){return this.x+","+this.y},t.prototype.fromString=function(t){if(null==t)return void(this.x=this.y=0);var e=t.split(",");this.x=toNumber(e[0]),this.y=toNumber(e[1])},t.prototype.applyScaleFactor=function(){return this.x*=nn.ScaleFactorX,this.y*=nn.ScaleFactorY,this},t.prototype.unapplyScaleFactor=function(){return this.x*=nn.ScaleFactorDeX,this.y*=nn.ScaleFactorDeY,this},t}();Point.AnchorCC=new Point(.5,.5),Point.AnchorLT=new Point(0,0),Point.AnchorLC=new Point(0,.5),Point.AnchorLB=new Point(0,1),Point.AnchorTC=new Point(.5,0),Point.AnchorBC=new Point(.5,1),Point.AnchorRT=new Point(1,0),Point.AnchorRC=new Point(1,.5),Point.AnchorRB=new Point(1,1),Point.Zero=new Point,nn.Point=Point;var PointCloud=function(){function t(){this._points=new Array,this._minpt=new Point,this._maxpt=new Point}return t.prototype.add=function(t){0==this._points.length&&(this._minpt.reset(nn.MAX_INT,nn.MAX_INT),this._maxpt.reset()),this._minpt.x>t.x&&(this._minpt.x=t.x),this._minpt.y>t.y&&(this._minpt.y=t.y),this._maxpt.x<t.x&&(this._maxpt.x=t.x),this._maxpt.y<t.y&&(this._maxpt.y=t.y),this._points.push(t)},Object.defineProperty(t.prototype,"boundingBox",{get:function(){return new Rect(this._minpt.x,this._minpt.y,this._maxpt.x-this._minpt.x,this._maxpt.y-this._minpt.y)},enumerable:!0,configurable:!0}),t}();nn.PointCloud=PointCloud;var Size=function(t){function e(e,n){return void 0===e&&(e=0),void 0===n&&(n=0),t.call(this,e,n)||this}return __extends(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!0,configurable:!0}),e.prototype.toRect=function(){return new Rect(0,0,this.width,this.height)},e.prototype.addSize=function(t){return this.x+=t.x,this.y+=t.y,this},e}(Point);Size.Zero=new Size,nn.Size=Size;var Polygon=function(){function t(){this._pts=new Array}return t.prototype.add=function(t){return this._pts.push(t),this},t.prototype.clear=function(){return this._pts.length=0,this},Object.defineProperty(t.prototype,"length",{get:function(){return this._pts.length},enumerable:!0,configurable:!0}),t}();nn.Polygon=Polygon;var FillMode;!function(t){t[t.STRETCH=4096]="STRETCH",t[t.CENTER=8192]="CENTER",t[t.ASPECTSTRETCH=12288]="ASPECTSTRETCH",t[t.ASPECTFILL=16384]="ASPECTFILL",t[t.NEARESTSTRETCH=20480]="NEARESTSTRETCH",t[t.MAPIN=24576]="MAPIN",t[t.NOBORDER=1]="NOBORDER",t[t.MAXIMUM=2]="MAXIMUM",t[t.NEAREST=4]="NEAREST",t[t.MASK_MAJOR=61440]="MASK_MAJOR"}(FillMode=nn.FillMode||(nn.FillMode={})),nn.FillModeString=FillModeString;var RRect=function(){function t(t,e,n){this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.width=e,this.height=n}return t.prototype.rvalue=function(t,e){return null==t?null:"number"==typeof t?t:t*e},t.prototype.toRect=function(t){nn.ISDEBUG&&(this.top&&this.bottom||this.left&&this.right)&&warn("不能同时设置同类属性");var e=new Rect(t.x,t.y,this.rvalue(this.width,t.width),this.rvalue(this.height,t.height));return null!=this.top?e.y+=this.rvalue(this.top,t.height):null!=this.bottom&&(e.y=t.maxY-this.rvalue(this.bottom,t.height)),null!=this.left?e.x+=this.rvalue(this.left,t.width):null!=this.right&&(e.x=t.maxX-this.rvalue(this.right,t.width)),e},t}();nn.RRect=RRect;var POSITION;!function(t){t[t.LEFT_TOP=0]="LEFT_TOP",t[t.LEFT_CENTER=1]="LEFT_CENTER",t[t.LEFT_BOTTOM=2]="LEFT_BOTTOM",t[t.TOP_CENTER=3]="TOP_CENTER",t[t.CENTER=4]="CENTER",t[t.BOTTOM_CENTER=5]="BOTTOM_CENTER",t[t.RIGHT_TOP=6]="RIGHT_TOP",t[t.RIGHT_CENTER=7]="RIGHT_CENTER",t[t.RIGHT_BOTTOM=8]="RIGHT_BOTTOM"}(POSITION=nn.POSITION||(nn.POSITION={}));var EDGE;!function(t){t[t.START=1]="START",t[t.MIDDLE=0]="MIDDLE",t[t.END=2]="END"}(EDGE=nn.EDGE||(nn.EDGE={}));var Rect=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i}return Object.defineProperty(t.prototype,"isnan",{get:function(){return isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return new Point(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y},enumerable:!0,configurable:!0}),t.prototype.origin=function(t){return t?new Point(this.x+this.width*t.x,this.y+this.height*t.y):new Point(this.x,this.y)},t.prototype.setOrigin=function(t,e){return e?(this.x=t.x-this.width*e.x,this.y=t.y-this.height*e.y):(this.x=t.x,this.y=t.y),this},t.prototype.alignTo=function(t,e,n){return null==n&&(n=e),this.setPosition(t.getPosition(e),n),this},t.prototype.edgeTo=function(t,e){switch(e){case EDGE.START:this.setLeftTop(t.leftTop);break;case EDGE.MIDDLE:this.setCenter(t.center);break;case EDGE.END:this.setRightBottom(t.rightBottom)}return this},t.prototype.getPosition=function(t){switch(t){case POSITION.LEFT_TOP:return this.leftTop;case POSITION.LEFT_CENTER:return this.leftCenter;case POSITION.LEFT_BOTTOM:return this.leftBottom;case POSITION.CENTER:return this.center;case POSITION.TOP_CENTER:return this.topCenter;case POSITION.BOTTOM_CENTER:return this.bottomCenter;case POSITION.RIGHT_TOP:return this.rightTop;case POSITION.RIGHT_CENTER:return this.rightCenter;case POSITION.RIGHT_BOTTOM:return this.rightBottom}},t.prototype.setPosition=function(t,e){switch(e){case POSITION.LEFT_TOP:this.leftTop=t;break;case POSITION.LEFT_CENTER:this.leftCenter=t;break;case POSITION.LEFT_BOTTOM:this.leftBottom=t;break;case POSITION.CENTER:this.center=t;break;case POSITION.TOP_CENTER:this.topCenter=t;break;case POSITION.BOTTOM_CENTER:this.bottomCenter=t;break;case POSITION.RIGHT_TOP:this.rightTop=t;break;case POSITION.RIGHT_CENTER:this.rightCenter=t;break;case POSITION.RIGHT_BOTTOM:this.rightBottom=t}},Object.defineProperty(t.prototype,"size",{get:function(){return new Size(this.width,this.height)},set:function(t){this.width=t.width,this.height=t.height},enumerable:!0,configurable:!0}),t.prototype.setSize=function(t,e){return this.width=t,this.height=e,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setWidth=function(t){return this.width=t,this},t.prototype.setHeight=function(t){return this.height=t,this},t.prototype.integral=function(){return this.x=Integral(this.x),this.y=Integral(this.y),this.width=Integral(this.width),this.height=Integral(this.height),this},t.prototype.invert=function(){var t=this,e=t.x;return t.x=t.y,t.y=e,e=t.width,t.width=t.height,t.height=e,t},t.prototype.clone=function(){var t=this,e=nn.InstanceNewObject(t);return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e},t.prototype.copy=function(t){var e=this;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e},t.prototype.applyEdgeInsets=function(t){return null==t?this:(this.x+=t.left,this.y+=t.top,this.width-=t.left+t.right,this.height-=t.top+t.bottom,this)},t.prototype.unapplyEdgeInsets=function(t){return null==t?this:(this.x-=t.left,this.y-=t.top,this.width+=t.left+t.right,this.height+=t.top+t.bottom,this)},t.prototype.applyAnchor=function(t,e){return this.x-=this.width*t,this.y-=this.height*e,this},t.prototype.unapplyAnchor=function(t,e){return this.x+=this.width*t,this.y+=this.height*e,this},t.prototype.containsPoint=function(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height},t.ContainsPoint=function(t,e,n,i,r,o){return t>=n&&n+r>=t&&e>=i&&i+o>=e},t.Area=function(t){return t.width*t.height},t.Swap=function(t,e){var n=t.x,i=t.y,r=t.width,o=t.height;t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,e.x=n,e.y=i,e.width=r,e.height=o},t.prototype.maxSize=function(t,e){return void 0!=t&&this.width>t&&(this.width=t),void 0!=e&&this.height>e&&(this.height=e),this},t.prototype.minSize=function(t,e){return void 0!=t&&this.width<t&&(this.width=t),void 0!=e&&this.height<e&&(this.height=e),this},t.prototype.isEqual=function(t){return this.x==t.x&&this.y==t.y&&this.width==t.width&&this.height==t.height},t.prototype.add=function(t,e,n,i){return this.x+=t,this.y+=e,n&&(this.width+=n),i&&(this.height+=i),this},t.prototype.union=function(t){var e=this.maxX,n=this.maxY;return this.x>t.x&&(this.x=t.x),this.y>t.y&&(this.y=t.y),e<t.maxX&&(this.width+=t.maxX-e),n<t.maxY&&(this.height+=t.maxY-n),this},t.prototype.deflate=function(t,e){return this.add(.5*t,.5*e,-t,-e)},t.prototype.deflateR=function(t,e){return this.deflate(this.width*t,this.height*e)},t.prototype.scale=function(t,e){return void 0==e?(this.x*=t,this.y*=t):(this.x-=(this.width*t-this.width)*e.x,this.y-=(this.height*t-this.height)*e.y),this.width*=t,this.height*=t,this},Object.defineProperty(t.prototype,"outterRadius",{get:function(){var t=Math.max(this.width,this.height);return Math.sqrt(t*t*2)/2},enumerable:!0,configurable:!0}),t.prototype.multiRect=function(t,e,n,i){return null!=t&&(this.x*=t),null!=e&&(this.y*=e),null!=n&&(this.width*=n),null!=i&&(this.height*=i),this},t.prototype.scaleWidth=function(t){return this.width*=t,this},t.prototype.scaleHeight=function(t){return this.height*=t,this},t.prototype.clipCenter=function(t,e){if(t){var n=this.width-t;this.x+=.5*n,this.width-=n}if(e){var n=this.height-e;this.y+=.5*n,this.height-=n}return this},t.prototype.reset=function(t,e,n,i){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this},Object.defineProperty(t.prototype,"minX",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxX",{get:function(){return this.x+this.width},set:function(t){this.x=t-this.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minY",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxY",{get:function(){return this.y+this.height},set:function(t){this.y=t-this.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minL",{get:function(){return Math.min(this.width,this.height)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxL",{get:function(){return Math.max(this.width,this.height)},enumerable:!0,configurable:!0}),t.prototype.toPolygon=function(){return(new Polygon).add(new Point(this.x,this.y)).add(new Point(this.x,this.y+this.height)).add(new Point(this.x+this.width,this.y+this.height)).add(new Point(this.x+this.width,this.y))},t.prototype.offset=function(t){return this.x+=t.x,this.y+=t.y,this},Object.defineProperty(t.prototype,"center",{get:function(){return new Point(this.x+.5*this.width,this.y+.5*this.height)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y-.5*this.height},enumerable:!0,configurable:!0}),t.prototype.setCenter=function(t){return this.center=t,this},Object.defineProperty(t.prototype,"leftTop",{get:function(){return new Point(this.x,this.y)},set:function(t){this.x=t.x,this.y=t.y},enumerable:!0,configurable:!0}),t.prototype.setLeftTop=function(t){return this.leftTop=t,this},Object.defineProperty(t.prototype,"leftBottom",{get:function(){return new Point(this.x,this.y+this.height)},set:function(t){this.x=t.x,this.y=t.y-this.height},enumerable:!0,configurable:!0}),t.prototype.setLeftBottom=function(t){return this.leftBottom=t,this},Object.defineProperty(t.prototype,"rightTop",{get:function(){return new Point(this.x+this.width,this.y)},set:function(t){this.x=t.x-this.width,this.y=t.y},enumerable:!0,configurable:!0}),t.prototype.setRightTop=function(t){return this.rightTop=t,this},Object.defineProperty(t.prototype,"rightBottom",{get:function(){return new Point(this.x+this.width,this.y+this.height)},set:function(t){this.x=t.x-this.width,this.y=t.y-this.height},enumerable:!0,configurable:!0}),t.prototype.setRightBottom=function(t){return this.rightBottom=t,this},Object.defineProperty(t.prototype,"topCenter",{get:function(){return new Point(this.x+.5*this.width,this.y)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y},enumerable:!0,configurable:!0}),t.prototype.setTopCenter=function(t){return this.topCenter=t,this},Object.defineProperty(t.prototype,"bottomCenter",{get:function(){return new Point(this.x+.5*this.width,this.y+this.height)},set:function(t){this.x=t.x-.5*this.width,this.y=t.y-this.height},enumerable:!0,configurable:!0}),t.prototype.setBottomCenter=function(t){return this.bottomCenter=t,this},Object.defineProperty(t.prototype,"leftCenter",{get:function(){return new Point(this.x,this.y+.5*this.height)},set:function(t){this.x=t.x,this.y=t.y-.5*this.height},enumerable:!0,configurable:!0}),t.prototype.setLeftCenter=function(t){return this.leftCenter=t,this},Object.defineProperty(t.prototype,"rightCenter",{get:function(){return new Point(this.x+this.width,this.y+.5*this.height)},set:function(t){this.x=t.x-this.width,this.y=t.y-.5*this.height},enumerable:!0,configurable:!0}),t.prototype.setRightCenter=function(t){return this.rightCenter=t,this},t.prototype.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},Object.defineProperty(t.prototype,"nearest",{get:function(){return null==this._nearest?.1:this._nearest},enumerable:!0,configurable:!0}),t.prototype.fill=function(t,e){var n=this;if(0==n.width||0==n.height)return n;var i=!0;switch(e&FillMode.MASK_MAJOR){case FillMode.STRETCH:n.copy(t);break;case FillMode.MAPIN:this.maxX>t.maxX&&(this.maxX=t.maxX),this.maxY>t.maxY&&(this.maxY=t.maxY),this.minX<t.minX&&(this.minX=t.minX),this.minY<t.minY&&(this.minY=t.minY),i=!1;break;case FillMode.NEARESTSTRETCH:var r=n.width/t.width,o=n.height/t.height;o>r?(n.width/=o,n.height=t.height):(n.height/=r,n.width=t.width),r=n.width/t.width,o=n.height/t.height,Math.abs(r-o)<n.nearest&&n.copy(t);break;case FillMode.ASPECTSTRETCH:var r=n.width/t.width,o=n.height/t.height;o>r?(n.width/=o,n.height=t.height):(n.height/=r,n.width=t.width);break;case FillMode.ASPECTFILL:var r=n.width/t.width,o=n.height/t.height;o>r?(n.height/=r,n.width=t.width):(n.width/=o,n.height=t.height)}if(Mask.isset(FillMode.NOBORDER,e)){var s=t.width/t.height;n.width/t.width<n.height/t.height?n.width=n.height*s:n.height=n.width/s}if(Mask.isset(FillMode.NEAREST,e)){var r=n.width/t.width,o=n.height/t.height;Math.abs(r-o)<n.nearest&&(o>r?n.width/=r:n.height/=o)}return i&&(n.center=t.center),n},t.prototype.applyScaleFactor=function(){return this.x*=nn.ScaleFactorX,this.y*=nn.ScaleFactorY,this.width*=nn.ScaleFactorW,this.height*=nn.ScaleFactorH,this},t.prototype.unapplyScaleFactor=function(){return this.x*=nn.ScaleFactorDeX,this.y*=nn.ScaleFactorDeY,this.width*=nn.ScaleFactorDeW,this.height*=nn.ScaleFactorDeH,this},t.prototype.applyCartesian=function(t){var e=this;return e.y=t.height-e.y-e.height-t.y,e.x+=t.x,e},t.prototype.unapplyCartesian=function(t){var e=this;return e.y=t.height-e.y-t.y,e.x-=t.x,e},t}();Rect.Zero=new Rect,Rect.Max=new Rect(-999999,-999999,999999,999999),nn.Rect=Rect;var UnionRect=function(t){function e(e,n,i,r){var o=t.call(this)||this;return o.x=e,o.y=n,o.width=i,o.height=r,o}return __extends(e,t),e.prototype.union=function(e){var n=this;return null==n.x||null==n.y||null==n.width||null==n.height?(n.x=e.x,n.y=e.y,n.width=e.width,n.height=e.height,n):t.prototype.union.call(this,e)},e}(Rect);nn.UnionRect=UnionRect;var WorkState;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WAITING=1]="WAITING",t[t.DOING=2]="DOING",t[t.PAUSED=3]="PAUSED",t[t.DONE=4]="DONE"}(WorkState=nn.WorkState||(nn.WorkState={}));var Angle=function(){function t(t){void 0===t&&(t=0),this._rad=t}return t.ToRad=function(e){return e*t._DEGREE},t.ToAngle=function(e){return e*t._RAD},t.prototype.clone=function(){return new t(this._rad)},t.RAD=function(e){var n=new t(e);return n},t.ANGLE=function(e){var n=new t(t.ToRad(e));return n},t.DIRECTION=function(e){var n=new t;switch(e){case Direction.UP:n._rad=0;break;case Direction.LEFT:n._rad=t._PI_2;break;case Direction.DOWN:n._rad=t._PI;break;case Direction.RIGHT:n._rad=t._PI+t._PI_2}return n},Object.defineProperty(t.prototype,"angle",{get:function(){return this._rad*t._RAD},set:function(e){this._rad=e*t._DEGREE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rad",{get:function(){return this._rad},set:function(t){this._rad=t},enumerable:!0,configurable:!0}),t.prototype.add=function(t){return this._rad+=t._rad,this},t.prototype.sub=function(t){return this._rad-=t._rad,this},t.prototype.multiScala=function(t){return this._rad*=t,this},t.prototype.normalize=function(){return this._rad<0&&(this._rad+=t._2PI),this._rad%=t._2PI,this},Object.defineProperty(t.prototype,"direction",{get:function(){var t=this.clone().normalize().angle;return 45>=t||t>=315?Direction.UP:t>=45&&135>=t?Direction.LEFT:t>=135&&225>=t?Direction.DOWN:Direction.RIGHT},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"角度:"+this.angle+", 弧度:"+this.rad},t}();Angle._PI=Math.PI,Angle._PI_2=Math.PI/2,Angle._2PI=2*Math.PI,Angle._1_2PI=1/Math.PI/2,Angle._DEGREE=Math.PI/180,Angle._RAD=180/Math.PI,nn.Angle=Angle;var Rayline=function(){function t(t,e){this.pt=t,this.angle=e}return t.prototype.atLength=function(t,e){return void 0==e&&(e=this.angle),new Point(t*Math.cos(e),t*Math.sin(e)).addPoint(this.pt)},t}();nn.Rayline=Rayline;var Path=function(){function t(t){this._ph=document.createElementNS("http://www.w3.org/2000/svg","path"),null==this._ph&&fatal("当前环境不支持 H5-PATH-SVG"),t&&this.unserialize(t)}return t.prototype.serialize=function(){return this._ph.getAttribute("d")},t.prototype.unserialize=function(t){var e;try{this._ph.setAttribute("d",t),this._changed=e=!0}catch(n){e=!1}return e},t.prototype.clear=function(){this._ph.setAttribute("d","")},Object.defineProperty(t.prototype,"length",{get:function(){return this._changed&&(this._len=this._ph.getTotalLength(),this._changed=!1),this._len},enumerable:!0,configurable:!0}),t.prototype.pointAtPos=function(t){var e=this.length;return this._ph.getPointAtLength(e*t)},t}();nn.Path=Path;var URL=function(){function t(t){this.fields=new KvObject,this.domain="",t&&this.parseString(t)}return t.prototype.parseString=function(t){var e=this;if(isZero(t))return void warn("不能解析传入的 URI 信息");var n=t.split("?");1==n.length&&(n=["",n[0]]),this.domain=n[0];var i=n[1];length(i)&&i.split("&").forEach(function(t){if(0!=length(t)){var n=t.split("=");e.fields[n[0]]=n[1]?n[1]:null}})},t.prototype.toString=function(){var e="";return this.domain.length&&(0==/\:\/\//i.test(this.domain)&&(e+="http://"),e+=this.domain,-1!=this.domain.indexOf("?")||MapT.IsEmpty(this.fields)||(e+="?")),e+=t.MapToField(this.fields)},t.MapToField=function(t){var e=this,n=[];return MapT.Foreach(t,function(t,i){n.push(t+"="+e.encode(i))},this),n.join("&")},t.encode=function(t){return encodeURIComponent(t)},t.decode=function(t){return decodeURIComponent(t)},t.pack=function(t,e){void 0===e&&(e=!0);var n=btoa(t);return e?encodeURIComponent(n):n},t.unpack=function(t,e){void 0===e&&(e=!0);var n=atob(t);return e?decodeURIComponent(n):n},t.htmlEncode=function(t){return 0==t.length?"":(t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=t.replace(/ /g,"&nbsp;"),t=t.replace(/\'/g,"&#39;"),t=t.replace(/\"/g,"&quot;"))},t.htmlDecode=function(t){return 0==t.length?"":(t=t.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t=t.replace(/&nbsp;/g," "),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'))},t}();nn.URL=URL;var DateTime=function(){function t(e){this._changed=!1,this._date=new Date,void 0===e&&(e=t.Timestamp()),this.timestamp=e}return t.Now=function(){return(new Date).getTime()/1e3},t.Timestamp=function(){return(new Date).getTime()/1e3>>0},t.Pass=function(){return nn.IMP_TIMEPASS()},t.Interval=function(e){return new t(e-288e4)},t.parse=function(e){var n=Date.parse(e);return isNaN(n)&&-1!=e.indexOf("-")&&(e=e.replace(/-/g,"/"),n=Date.parse(e)),new t(n/1e3)},t.prototype.future=function(t){return this.timestamp+=t,this},t.prototype.past=function(t){return this.timestamp-=t,this},t.prototype.diff=function(e){return new t(e._timestamp-this._timestamp)
},Object.defineProperty(t.prototype,"timestamp",{get:function(){return this._changed&&(this._timestamp=this._date.getTime()/1e3,this._changed=!1),this._timestamp},set:function(t){this._timestamp!==t&&(this._timestamp=t,this._date.setTime(1e3*this._timestamp))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"year",{get:function(){return this._date.getFullYear()},set:function(t){this._changed=!0,this._date.setFullYear(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"month",{get:function(){return this._date.getMonth()},set:function(t){this._changed=!0,this._date.setMonth(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"day",{get:function(){return this._date.getDate()},set:function(t){this._changed=!0,this._date.setDate(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hyear",{get:function(){return this.year},set:function(t){this.year=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hmonth",{get:function(){return this.month+1},set:function(t){this.month=t-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hday",{get:function(){return this.day},set:function(t){this.day=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hour",{get:function(){return this._date.getHours()},set:function(t){this._changed=!0,this._date.setHours(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minute",{get:function(){return this._date.getMinutes()},set:function(t){this._changed=!0,this._date.setMinutes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"second",{get:function(){return this._date.getSeconds()},set:function(t){this._changed=!0,this._date.setSeconds(t)},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){return t?this._date.pattern(t):this._date.toString()},t.Dyears=function(t,e){return void 0===e&&(e=!0),Math.floor(t/this.YEAR)},t.Dmonths=function(t,e){void 0===e&&(e=!0);var n;return e?(n=t%this.YEAR,n=Math.floor(n/this.MONTH)):n=Math.floor(t/this.MONTH),n},t.Ddays=function(t,e){void 0===e&&(e=!0);var n;return e?(n=t%this.MONTH,n=Math.floor(n/this.DAY)):n=Math.floor(t/this.DAY),n},t.Dhours=function(t,e){void 0===e&&(e=!0);var n;return e?(n=t%this.DAY,n=Math.floor(n/this.HOUR)):n=Math.floor(t/this.HOUR),n},t.Dminutes=function(t,e){void 0===e&&(e=!0);var n;return e?(n=t%this.HOUR,n=Math.floor(n/this.MINUTE)):n=Math.floor(t/this.MINUTE),n},t.Dseconds=function(t,e){void 0===e&&(e=!0);var n;return n=e?t%this.MINUTE:t},t.prototype.dyears=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Dyears(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.dmonths=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Dmonths(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.ddays=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Ddays(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.dhours=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Dhours(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.dminutes=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Dminutes(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.dseconds=function(e,n){void 0===e&&(e=!0),void 0===n&&(n=0);var i=t.Dseconds(this._timestamp,e);return"string"==typeof n?i?i+n:"":i+n},t.prototype.isSameDay=function(t){return this.year==t.year&&this.month==t.month&&this.day==t.day},t}();DateTime.MINUTE=60,DateTime.MINUTE_5=300,DateTime.MINUTE_15=900,DateTime.MINUTE_30=1800,DateTime.HOUR=3600,DateTime.HOUR_2=7200,DateTime.HOUR_6=21600,DateTime.HOUR_12=43200,DateTime.DAY=86400,DateTime.MONTH=2592e3,DateTime.YEAR=31104e3,nn.DateTime=DateTime;var CTimer=function(t){function e(e,n){var i=t.call(this)||this;return i.count=-1,i.interval=1,i.xdata={},i._firedCount=0,i._deltaFired=1,i.interval=e,i.count=n,i}return __extends(e,t),e.prototype.dispose=function(){this.stop(),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"firedCount",{get:function(){return this._firedCount},set:function(t){fatal("不允许设置 firedCount")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deltaFired",{get:function(){return this._deltaFired},set:function(t){this._deltaFired=t},enumerable:!0,configurable:!0}),e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.register(nn.SignalAction),this._signals.register(nn.SignalDone)},Object.defineProperty(e.prototype,"pastTime",{get:function(){return this._firedCount/this.interval},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.oneTick=function(t){void 0===t&&(t=0),this._deltaFired=0,this.signals.emit(nn.SignalAction)},e}(SObject);CTimer.SAFE_TIMER_ENABLED=!0,CTimer.SAFE_TIMERS=new nn.CSet,nn.CTimer=CTimer;var RtTimer=function(t){function e(e,n){return void 0===e&&(e=1),void 0===n&&(n=-1),t.call(this,e,n)||this}return __extends(e,t),e.prototype.start=function(){this.stop(),this._firedCount=0,this._tmr=nn.IMP_CREATE_TIMER(this.interval,0),CTimer.SAFE_TIMER_ENABLED?CTimer.SAFE_TIMERS.add(this):(nn.IMP_START_TIMER(this._tmr,this.__tmr_tick,this),this.currentTime=DateTime.Pass())},e.prototype.stop=function(){0!=this.isRunning&&(nn.IMP_STOP_TIMER(this._tmr,this.__tmr_tick,this),this._tmr=null)},Object.defineProperty(e.prototype,"isRunning",{get:function(){return null!=this._tmr},enumerable:!0,configurable:!0}),e.prototype.__tmr_tick=function(){var t=DateTime.Pass(),e=t-this.currentTime;this.currentTime=t,e>=this.interval&&(this.deltaFired=Math.floor(e/this.interval),this._firedCount+=this.deltaFired,this.xdata.overflow=e-this.deltaFired*this.interval,-1!=this.count&&this._firedCount>=this.count?(this._firedCount=this.count,this.signals.emit(nn.SignalAction),this.signals.emit(nn.SignalDone),this.stop()):this.signals.emit(nn.SignalAction),this.currentTime-=this.xdata.overflow,this.deltaFired=1)},e}(CTimer);nn.RtTimer=RtTimer;var SysTimer=function(t){function e(e,n){return void 0===e&&(e=1),void 0===n&&(n=-1),t.call(this,e,n)||this}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._tmr=void 0},e.prototype.start=function(){this.stop(),this._firedCount=0,this._tmr=nn.IMP_CREATE_TIMER(this.interval,-1==this.count?0:this.count),CTimer.SAFE_TIMER_ENABLED?CTimer.SAFE_TIMERS.add(this):nn.IMP_START_TIMER(this._tmr,this.__tmr_tick,this)},e.prototype.stop=function(){0!=this.isRunning&&(nn.IMP_STOP_TIMER(this._tmr,this.__tmr_tick,this),this._tmr=null)},Object.defineProperty(e.prototype,"isRunning",{get:function(){return null!=this._tmr},enumerable:!0,configurable:!0}),e.prototype.__tmr_tick=function(){this.currentTime=DateTime.Pass(),this._firedCount+=this.deltaFired,-1!=this.count&&this._firedCount>=this.count?(this._firedCount=this.count,this.signals.emit(nn.SignalAction),this.signals.emit(nn.SignalDone),this.stop()):this.signals.emit(nn.SignalAction)},e}(CTimer);nn.SysTimer=SysTimer;var Timer=function(t){function e(e,n){return void 0===e&&(e=1),void 0===n&&(n=-1),t.call(this,e,n)||this}return __extends(e,t),e.prototype.start=function(){this.stop(),this.backgroundMode?(this._rtmr=new RtTimer(this.interval,this.count),this._rtmr.signals.connect(nn.SignalAction,this.__act_action,this),this._rtmr.signals.connect(nn.SignalDone,this.__act_done,this)):(this._systmr=new SysTimer(this.interval,this.count),this._systmr.signals.connect(nn.SignalAction,this.__act_action,this),this._systmr.signals.connect(nn.SignalDone,this.__act_done,this)),this._rtmr?this._rtmr.start():this._systmr.start()},e.prototype.__act_action=function(t){this.xdata=t.sender.xdata,this.signals.emit(nn.SignalAction)},e.prototype.__act_done=function(t){this.xdata=t.sender.xdata,this.signals.emit(nn.SignalDone)},e.prototype.stop=function(){0!=this.isRunning&&(this._rtmr&&(this._rtmr.drop(),this._rtmr=void 0),this._systmr&&(this._systmr.drop(),this._systmr=void 0))},e.prototype.timer=function(){return this._rtmr?this._rtmr:this._systmr?this._systmr:null},Object.defineProperty(e.prototype,"isRunning",{get:function(){var t=this.timer();return t&&t.isRunning},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firedCount",{get:function(){var t=this.timer();return t&&t.firedCount},set:function(t){warn("不允许直接设置 firedCount")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deltaFired",{get:function(){var t=this.timer();return t&&t.deltaFired},set:function(t){warn("不允许直接设置 deltaFired")},enumerable:!0,configurable:!0}),e}(CTimer);nn.Timer=Timer,nn.Delay=Delay;var CoTimerItem=function(t){function e(){var e=t.call(this,1,-1)||this;return e.times=0,e.now=0,e}return __extends(e,t),e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.delegate=this},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._cotimer=null},e.prototype._signalConnected=function(t){this.radicalMode&&this.isRunning&&t==nn.SignalAction&&this._signals.emit(nn.SignalAction)},Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._cotimer&&this._cotimer.isRunning},set:function(t){fatal("不允许设置运行状态")},enumerable:!0,configurable:!0}),e.prototype.reset=function(t,e,n){if(void 0===e&&(e=-1),this.interval=t,this.times=t/this._timeinterval,this.count=e,null==n)this.now=0,this._firedCount=0;else if(n.overflow){var i=n.overflow/this._timeinterval;this.now=i%this.times,this._firedCount=Math.floor(i/this.times)}else this.now=0,this._firedCount=0;return nn.Defer(this.start,this),this},e.prototype.set=function(t,e){void 0===e&&(e=-1),this.interval=t,this.times=t/this._timeinterval,this.count=e},e.prototype.start=function(){return null==this._cotimer?void warn("没有加入过 timer，不能启动"):(this._cotimer._addTimer(this),void(this.radicalMode&&this.isRunning&&this.signals.emit(nn.SignalAction)))},e.prototype.stop=function(){return null==this._cotimer?void warn("CoTimerItem 已经停止"):void this._cotimer._stopTimer(this)},e}(CTimer);nn.CoTimerItem=CoTimerItem;var CoTimer=function(t){function e(e){void 0===e&&(e=.1);var n=t.call(this)||this;return n.radicalMode=!1,n._splices=new Array,n._tmr=new Timer,n._tmr.interval=e,n._tmr.signals.connect(nn.SignalAction,n.__tmr_tick,n),n}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.stop(),this._tmr&&(this._tmr.drop(),this._tmr=void 0),this.clear()},Object.defineProperty(e.prototype,"interval",{get:function(){return this._tmr.interval},set:function(t){this._tmr.interval=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backgroundMode",{get:function(){return this._tmr.backgroundMode},set:function(t){this._tmr.backgroundMode=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRunning",{get:function(){return this._tmr.isRunning},set:function(t){fatal("不能设置 timer 的状态")},enumerable:!0,configurable:!0}),e.prototype.start=function(){return this.isRunning?(warn("CoTimer 定时器已经在运行"),this):(this._tmr.start(),this)},e.prototype.stop=function(){return this.isRunning?(this._tmr.stop(),this):void warn("CoTimer 定时器已经停止")},e.prototype.add=function(t,e,n){void 0===e&&(e=-1);var i=this.acquire(n);return i.reset(t,e),i},e.prototype.acquire=function(t){var e=this.findItemByIdr(t);return e?e:(e=new CoTimerItem,e._cotimer=this,e._timeinterval=this._tmr.interval,e.radicalMode=this.radicalMode,e.tag=t,e)},e.prototype._addTimer=function(t){ArrayT.Contains(this._splices,t)||this._splices.push(t)},e.prototype._stopTimer=function(t){ArrayT.RemoveObject(this._splices,t)},e.prototype.findItemByIdr=function(t){return null==t?null:ArrayT.QueryObject(this._splices,function(e){return e.tag&&e.tag==t},this)},e.prototype.clear=function(){ArrayT.Clear(this._splices,function(t){dispose(t)},this)},e.prototype.__tmr_tick=function(t){var e=this;this._splices.forEach(function(n){var i=e._tmr.deltaFired;n.now+=i,n.now<n.times||(n.now=n.now%n.times,n.deltaFired=i>n.times?Math.floor(i/n.times):1,n._firedCount+=n.deltaFired,-1!=n.count&&n._firedCount>=n.count?(n._firedCount=n.count,e._stopTimer(n),n.signals.emit(nn.SignalAction,t.sender.xdata),n.signals.emit(nn.SignalDone,t.sender.xdata),n._firedCount=0):n.signals.emit(nn.SignalAction,t.sender.xdata))},this)},e}(SObject);nn.CoTimer=CoTimer;var Delayer=function(){function t(t,e,n){this._tm=t,this._cb=e,this._ctx=n}return t.prototype.start=function(){return this._tmr?void warn("Delayer已经开始"):(this._tmr=new SysTimer(this._tm,1),this._tmr.signals.connect(nn.SignalDone,this._cb,this._ctx),void this._tmr.start())},t.prototype.stop=function(){null!=this._tmr&&(this._tmr.drop(),this._tmr=null)},t.prototype.restart=function(){this.stop(),this.start()},t}();nn.Delayer=Delayer,nn.Repeat=Repeat;var Random=function(){function t(){}return t.Rangei=function(e,n,i){return void 0===i&&(i=!1),i?Math.round(t.Rangef(e,n)):Math.floor(t.Rangef(e,n))},t.Rangef=function(t,e){return Math.random()*(e-t)+t},t}();nn.Random=Random;var ScreenType;!function(t){t[t.NORMAL=0]="NORMAL",t[t.HIGH=1]="HIGH",t[t.EXTRAHIGH=2]="EXTRAHIGH",t[t.LOW=-1]="LOW",t[t.EXTRALOW=-2]="EXTRALOW"}(ScreenType=nn.ScreenType||(nn.ScreenType={})),nn.ScreenTypeIsLow=ScreenTypeIsLow,nn.ScreenTypeIsHigh=ScreenTypeIsHigh;var Device=function(t){function e(){var e=t.call(this)||this;return e.isCanvas=!0,e.supportAutoSound=!0,e.screenFrame=new Rect,e.screenBounds=new Rect,e.screenOrientation=new Angle,e.screenType=ScreenType.NORMAL,e.detectEnv(),e}return __extends(e,t),e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.register(nn.SignalOrientationChanged)},e.prototype.detectEnv=function(){var t=this;t.platform=navigator.platform,t.agent=navigator.userAgent,t.isMac="Mac68K"==t.platform||"MacPPC"==t.platform||"Macintosh"==t.platform||"MacIntel"==t.platform,t.isWin="Win32"==t.platform||"Windows"==t.platform,t.isUnix="X11"==t.platform&&!t.isMac&&!t.isWin,t.isLinux=-1!=t.platform.indexOf("Linux"),t.isIOS=/(iPhone|iPad|iPod|iOS)/i.test(t.agent),t.isAndroid=/android/i.test(t.agent),t.isMobile=t.isIOS||t.isAndroid,t.isPC=!t.isMobile||t.isMac||t.isWin||t.isUnix||t.isLinux,t.isPurePC=!t.isMobile&&(t.isMac||t.isWin||t.isUnix||t.isLinux),t.isHighPerfomance=!t.isAndroid},e.prototype._updateScreen=function(){var t=Js.getBrowserSize(),e=Js.getScreenSize();this.screenBounds.reset(0,0,t.width,t.height),this.screenFrame.reset(0,0,e.width,e.height);var n=Js.getBrowserOrientation();this.screenOrientation.angle!=n&&(this.screenOrientation.angle=n,this.signals.emit(nn.SignalOrientationChanged,this.screenOrientation))},e}(SObject);Device.shared=new Device,nn.Device=Device;var HttpMethod;!function(t){t[t.GET=0]="GET",t[t.POST=1]="POST"}(HttpMethod=nn.HttpMethod||(nn.HttpMethod={}));var CHttpConnector=function(t){function e(){var e=t.apply(this,arguments)||this;return e.method=HttpMethod.GET,e}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.data=void 0,this.fields=void 0},e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.register(nn.SignalEnd),this._signals.register(nn.SignalDone),this._signals.register(nn.SignalFailed),this._signals.register(nn.SignalChanged)},e.prototype.start=function(){},e.prototype.useCredentials=function(){},e.prototype.fullUrl=function(){var t=this.url;return this.fields&&(t+=-1==t.indexOf("?")?"?":"&",t+=URL.MapToField(this.fields)),t},e}(SObject);nn.CHttpConnector=CHttpConnector;var CSocketConnector=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.register(nn.SignalOpen),this._signals.register(nn.SignalClose),this._signals.register(nn.SignalDataChanged),this._signals.register(nn.SignalTimeout),this._signals.register(nn.SignalFailed)},e}(SObject);nn.CSocketConnector=CSocketConnector;var Operation=function(){function t(t){this.idr=t}return t.prototype.done=function(){this._queue&&this._queue.next()},t}();nn.Operation=Operation;var OperationQueue=function(t){function e(){var e=t.call(this)||this;return e.autoMode=!0,e._opers=new Array,e}return __extends(e,t),e.prototype._initSignals=function(){t.prototype._initSignals.call(this),this._signals.register(nn.SignalDone)},e.Manual=function(){var t=new e;return t.autoMode=!1,t},Object.defineProperty(e.prototype,"count",{get:function(){return this._opers.length},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return null!=t._queue?void warn("该操作已经位于队列中"):(t._queue=this,this._opers.push(t),void(this.autoMode&&this.tryrun()))},e.prototype.remove=function(t){return t._queue!=this?void warn("不能移除该操作"):(t==this._current&&(this._current=null),t._queue=null,void ArrayT.RemoveObject(this._opers,t))},e.prototype.follow=function(t,e){if(t._queue!=this)return void fatal("期望接上一个错误的队列操作");var n=this._opers.indexOf(t);e._queue=this,ArrayT.InsertObjectAtIndex(this._opers,e,n+1)},e.prototype.present=function(t){this._current?this.follow(this._current,t):(t._queue=this,ArrayT.InsertObjectAtIndex(this._opers,t,1))},e.prototype.swap=function(t,e){var n=this._opers.indexOf(t),i=this._opers.indexOf(e);return-1==n||-1==i?void fatal("尝试交换不属于该队列的操作"):(this._opers[n]=e,this._opers[i]=t,void(this._current==t?(this._current=e,e.start()):this._current==e&&(this._current=t,t.start())))},e.prototype.replace=function(t,e){if(t._queue!=this)return void fatal("期望替换一个错误的队列操作");var n=this._opers.indexOf(t);t._queue=null,t.done(),e._queue=this,this._opers[n]=e,this._current==t&&(this._current=e,this._current.start())},e.prototype.tryrun=function(){if(!this._current&&0!=this._opers.length){if(this._paused)return void(this._tryduringpaused=!0);this._current=this._opers[0],this._current&&this._current.start()}},e.prototype.next=function(){null!=this._current&&(this._current._queue=null,this._current=null,this._opers.shift(),0==this._opers.length?this._signals&&this._signals.emit(nn.SignalDone):this.tryrun())},e.prototype.findOperation=function(t){return ArrayT.QueryObject(this._opers,function(e){return e.idr==t},this)},e.prototype.pause=function(){this._paused||(this._paused=!0,this._tryduringpaused=!1)},e.prototype.resume=function(){this._paused&&(this._paused=!1,this._tryduringpaused&&(this._tryduringpaused=!1,this.tryrun()))},Object.defineProperty(e.prototype,"operations",{get:function(){return this._opers},enumerable:!0,configurable:!0}),e}(SObject);nn.OperationQueue=OperationQueue;var OperationClosure=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r.cb=e,r.ctx=n,r}return __extends(e,t),e.prototype.start=function(){this.cb.call(this.ctx,this)},e}(Operation);nn.OperationClosure=OperationClosure;var OperationCall=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o.cb=e,o.ctx=n,o.argus=i,o}return __extends(e,t),e.prototype.start=function(){this.cb.apply(this.ctx,this.argus)},e}(Operation);nn.OperationCall=OperationCall;var OperationDelay=function(t){function e(e,n){var i=t.call(this,n)||this;return i.delay=e,i}return __extends(e,t),e.prototype.start=function(){egret.setTimeout(this.done,this,this.delay)},e}(Operation);nn.OperationDelay=OperationDelay;var _OperationGroupQueue=function(t){function e(){var e=t.call(this)||this;return e._sum=0,e._now=0,e.autoMode=!1,e}return __extends(e,t),e.prototype.start=function(){this._sum=this._opers.length,this._now=0},e.prototype.next=function(){++this._now==this._sum&&this.signals.emit(nn.SignalDone)},e}(OperationQueue),OperationGroup=function(t){function e(e){var n=t.call(this,e)||this;return n._subqueue=new _OperationGroupQueue,n._subqueue.signals.connect(nn.SignalDone,n.__subqueue_end,n),n}return __extends(e,t),e.prototype.dispose=function(){this._subqueue.dispose()},e.prototype.start=function(){this._subqueue.start(),this._subqueue.operations.forEach(function(t){t.start()})},e.prototype.add=function(t){this._subqueue.add(t)},e.prototype.__subqueue_end=function(){this.done(),this.dispose()},e}(Operation);nn.OperationGroup=OperationGroup;var Retry=function(){function t(t,e,n,i){this._times=t,this._currentTime=0,this._interval=e,this._cb=n,this._ctx=i}return t.prototype.process=function(){this._cb.call(this._ctx,this)},t.prototype.done=function(){this._cb=void 0,this._ctx=void 0},t.prototype.next=function(){var t,e=this;return t="number"==typeof this._interval?this._interval:this._interval[this._currentTime],this._times>0&&this._currentTime++==this._times?(this.done(),void warn("重试达到指定次数，结束重试")):void(0==t?this._cb.call(this._ctx,this):Delay(t,function(){e._cb.call(e._ctx,e)},this))},t}();nn.Retry=Retry,nn.retry=retry;var ObjectsPool=function(){function t(t,e){this._arr=new Array,this.instance=t}return t.prototype.dispose=function(){this.clear()},t.prototype.use=function(){return 0==this._arr.length?this.instance.call(this.ctx):this._arr.pop()},t.prototype.unuse=function(t){t&&this._arr.push(t)},Object.defineProperty(t.prototype,"length",{get:function(){return this._arr.length},enumerable:!0,configurable:!0}),t.prototype.clear=function(){ArrayT.Clear(this._arr,function(t){drop(t)})},t}();nn.ObjectsPool=ObjectsPool;var SimpleReusesPool=function(){function t(t,e){this._pl=new KvObject,this._ins=t,this._ctx=e}return t.prototype.dispose=function(){this.clear()},t.prototype.use=function(t,e,n){var i=this._pl[t];return i&&i.length?i.pop():this._ins?this._ins.apply(this._ctx,n):e},t.prototype.unuse=function(t,e){var n=this._pl[t];null==n&&(n=new Array,this._pl[t]=n),n.push(e)},t.prototype.clear=function(){MapT.Clear(this._pl,function(t,e){ArrayT.Clear(e,function(t){drop(t)})})},t}();nn.SimpleReusesPool=SimpleReusesPool;var ReusesPool=function(){function t(t,e,n,i){this._pl=new KvObject,this._useds=new Array,this._unuseds=new Array,this._ins=t,this._use=e,this._unuse=n,this._ctx=i}return t.prototype.use=function(t,e,n){var i=this._pl[t];if(i&&i.length){var r=i.pop();return ArrayT.RemoveObject(this._unuseds,r),this._useds.push(r),this._use&&this._use.call(this._ctx,t,r),r}if(this._ins){var r=this._ins.apply(this._ctx,n);return this._useds.push(r),this._use&&this._use.call(this._ctx,t,r),r}return e},t.prototype.unuse=function(t,e){var n=this._pl[t];null==n?(n=new Array,this._pl[t]=n):ArrayT.RemoveObject(this._useds,e),n.push(e),this._unuseds.push(e),this._unuse&&this._unuse.call(this._ctx,t,e)},Object.defineProperty(t.prototype,"useds",{get:function(){return this._useds},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unuseds",{get:function(){return this._unuseds},enumerable:!0,configurable:!0}),t}();nn.ReusesPool=ReusesPool;var Storage=function(){function t(){this._prefix="::n2"}return Object.defineProperty(t.prototype,"prefix",{get:function(){return this._prefix},set:function(t){this._prefix=t?t:""},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var t=nn.InstanceNewObject(this);return t.codec=this.codec,t.prefix=this.prefix,t.domain=this.domain,t},t.prototype.getKey=function(t){var e=this.prefix;return this.domain&&(e+="::"+this.domain),e+=t},t.prototype.set=function(t,e){if(null!=t){var n=this.getKey(t);if(this.codec&&(n=this.codec.encode(n)),null==e)nn.IMP_STORAGE_DEL(n);else{var i=e.toString();this.codec&&(i=this.codec.encode(i)),nn.IMP_STORAGE_SET(n,i)}}},t.prototype.value=function(t,e){var n=this.getKey(t);this.codec&&(n=this.codec.encode(n));var i=nn.IMP_STORAGE_GET(n);return this.codec&&i&&(i=this.codec.decode(i)),null==i&&(i=e instanceof nn.Closure?e.invoke():asString(e,null)),i},t.prototype.setBool=function(t,e){this.set(t,e?"1":"0")},t.prototype.getBool=function(t,e){var n=this.value(t,e?"1":"0");return"0"!=n},t.prototype.setNumber=function(t,e){this.set(t,e)},t.prototype.getNumber=function(t,e){var n=this.value(t,e?e.toString():"0");return parseFloat(n)},t.prototype.setObject=function(t,e){this.set(t,JSON.stringify(e))},t.prototype.getObject=function(t){var e=this.value(t);return JSON.parse(e)},t.prototype.clear=function(){nn.IMP_STORAGE_CLEAR()},t}();Storage.shared=new Storage,nn.Storage=Storage;var CryptoStorages=function(){function t(){this._storages=new KvObject}return t.prototype.get=function(t){var e=this._storages[t];if(null==e){if(e=Storage.shared.clone(),!nn.ISDEBUG){var n=new nn.CrytoString;n.key=nn.CApplication.shared.idfa+"::"+t,e.codec=n}this._storages[t]=e}return e},t.prototype.set=function(t,e,n){this.get(t).set(t+"::"+e,n)},t.prototype.value=function(t,e,n){return this.get(t).value(t+"::"+e,n)},t.prototype.setBool=function(t,e,n){this.get(t).setBool(t+"::"+e,n)},t.prototype.getBool=function(t,e,n){return this.get(t).getBool(t+"::"+e,n)},t.prototype.setNumber=function(t,e,n){this.get(t).setNumber(t+"::"+e,n)},t.prototype.getNumber=function(t,e,n){return this.get(t).getNumber(t+"::"+e,n)},t}();CryptoStorages.shared=new CryptoStorages,nn.CryptoStorages=CryptoStorages,nn.number_t={type:"number",def:0},nn.boolean_t={type:"boolean",def:!1},nn.string_t={type:"string",def:""};var StorageVariable=function(){function t(t,e){void 0===e&&(e=nn.string_t),this.key=t,this.type=e}return Object.defineProperty(t.prototype,"value",{get:function(){return"number"==this.type.type?Storage.shared.getNumber(this.key):"boolean"==this.type.type?Storage.shared.getBool(this.key):Storage.shared.value(this.key)},set:function(t){"number"==this.type.type?Storage.shared.setNumber(this.key,t):"boolean"==this.type.type?Storage.shared.setBool(this.key,t):Storage.shared.set(this.key,t)},enumerable:!0,configurable:!0}),t}();nn.StorageVariable=StorageVariable;var CacheRecord=function(){function t(){this.count=0}return t.prototype.use=function(){return this.count+=1,this.val},t.prototype.prop=function(t,e){this.val&&(this.val[t]=e)},t.prototype.grab=function(){this.count+=1},t.prototype.drop=function(){this.count-=1},t}();nn.CacheRecord=CacheRecord;var Memcache=function(){function t(){this._maps=new KvObject,this._records=new Array,this.enable=!0}return t.prototype.cache=function(t){if(!this.enable){var e=new CacheRecord;return e.val=t.valueForCache(),e}var n=t.keyForCache();if(null==n)return warn("放到缓存中的对象没有提供 mcKey"),null;var i=this._maps[n];return i?(i.val=t.valueForCache(),i.ts=t.cacheTime>0?t.cacheTime+DateTime.Now():0,i):(i=new CacheRecord,i.key=n,i.val=t.valueForCache(),i.ts=t.cacheTime>0?t.cacheTime+DateTime.Now():0,this._records.push(i),this._maps[n]=i,nn.FramesManager.needsGC(this),i)},t.prototype.gc=function(){var t=this,e=ArrayT.RemoveObjectsByFilter(this._records,function(t){return t.count<=0});e.forEach(function(e){t.doRemoveObject(e)})},t.prototype.query=function(t){var e=this._maps[t];return null==e?null:e.ts>0&&e.ts<=DateTime.Now()?(e.count=0,null):e},t.prototype.doRemoveObject=function(t){MapT.RemoveKey(this._maps,t.key)},t}();Memcache.shared=new Memcache,nn.Memcache=Memcache;var _Scripts=function(){function t(){}return t.prototype.require=function(t,e,n){if(nn.ISHTML5)if(t instanceof Array){var i=t;Js.loadScripts(i,e,n)}else{var r=t;Js.loadScript(r,e,n)}else if(t instanceof Array){var i=t;for(var o in i)require(o);e.call(n)}else{var r=t;require(r),e.call(n)}},t}();nn._Scripts=_Scripts,nn.Scripts=new _Scripts}(nn||(nn={}));var nn;!function(t){t.SignalAddedToStage="::ui::addedtostage",t.SignalRequestClose="::nn::request::close";var e;!function(t){t[t.DEFAULT=100]="DEFAULT",t[t.FRONT=-999]="FRONT",t[t.NORMAL=0]="NORMAL",t[t.BACK=999]="BACK"}(e=t.ZPOSITION||(t.ZPOSITION={}));var n=function(){function t(){}return t.prototype.getReqResources=function(){return this.reqResources},t.GetReqResources=function(){var t=this;return t.__reqResources?t.__reqResources:(t.__reqResources=[],t.ResourcesRequire(t.__reqResources),t.__reqResources)},t.ResourcesRequire=function(t){},t}();n.ShowResourceProgress=!0,t.ReqResources=n;var i=function(){function t(){}return t}();i.shared=new i,t.COriginType=i;var r=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.source=void 0},e}(t.RefVariable);t.SourceVariable=r,t.StageBounds=new t.Rect}(nn||(nn={}));var nn;!function(t){t.SignalPreTouch="::nn::pretouch",t.SignalPreClick="::nn::preclick";var e=function(){function e(){this.startPosition=new t.Point,this.lastPosition=new t.Point,this.currentPosition=new t.Point}return Object.defineProperty(e.prototype,"delta",{get:function(){var t=this.currentPosition.clone();return t.add(-this.lastPosition.x,-this.lastPosition.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return new t.Point(this.currentPosition.x-this.startPosition.x,this.currentPosition.y-this.startPosition.y)},enumerable:!0,configurable:!0}),e}();t.CTouch=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.createImp(),t._imp&&(t._imp._fmui=t),t}return __extends(n,e),n.prototype.handle=function(){return this._imp},n.FromImp=function(t){return t._fmui},Object.defineProperty(n.prototype,"descriptionName",{get:function(){return t.Classname(this)},enumerable:!0,configurable:!0}),n.prototype._instanceSignals=function(){e.prototype._instanceSignals.call(this),this._signals.delegate=this},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalTouchBegin),this._signals.register(t.SignalTouchEnd),this._signals.register(t.SignalTouchMove),this._signals.register(t.SignalConstriantChanged),this._signals.register(t.SignalLoaded),this._signals.register(t.SignalAddedToStage),this._signals.register(t.SignalClicked),this._signals.register(t.SignalPreTouch),this._signals.register(t.SignalPreClick)},n.prototype.dispose=function(){this._imp._fmui=void 0,this._imp=void 0,this.tag=void 0,this._viewStack=void 0,this._states&&(this._states.drop(),this._states=void 0),this.transitionObject&&(this.transitionObject.drop(),this.transitionObject=void 0),this.clearGestures(),this.stopAllAnimates(),e.prototype.dispose.call(this)},n.prototype._signalConnected=function(t,e){},n.prototype.hitTest=function(t,e){if(0==this.touchChildren)return this.hitTestClient(t,e);var n=this.hitTestChild(t,e);return null==n&&(n=this.hitTestClient(t,e)),n},n.prototype.validate=function(){return!0},n.prototype.getChildByTag=function(t){for(var e=this.children,n=0;n<e.length;++n)if(e[n].tag==t)return e[n];return null},n.prototype.onChildAdded=function(t,e){e&&!this._islayouting&&this.validate()&&this.setNeedsLayout(),t.onStage&&t.setNeedsAppear(),t.onLoaded(),t.updateResource()},n.prototype.onChildRemoved=function(t){t.drop()},Object.defineProperty(n.prototype,"belong",{get:function(){return this._belong?this._belong:this.parent},set:function(t){this._belong=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"interactiveEnabled",{get:function(){return this.touchEnabled||this.touchChildren},set:function(t){this.touchEnabled=t,this.touchChildren=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"animate",{set:function(t){},enumerable:!0,configurable:!0}),n.prototype.playAnimate=function(e,n){return null==n&&(n=e.tag?e.tag:e.hashCode),null==this._playingAnimates&&(this._playingAnimates=new Array),null!=this.findAnimate(n)?(t.warn("存在同样名字的动画"),null):(e=e.clone(),e.tag=n,this._playingAnimates.push(e),e.complete(this.__cb_aniend,this),e.bind(this).play(),e)},n.prototype.findAnimate=function(e){return this._playingAnimates?t.ArrayT.QueryObject(this._playingAnimates,function(t){return t.tag==e}):null},n.prototype.stopAnimate=function(e){if(null!=this._playingAnimates){var n=this.findAnimate(e);null!=n&&(n.stop(),t.ArrayT.RemoveObject(this._playingAnimates,n))}},n.prototype.stopAllAnimates=function(){this._playingAnimates&&t.ArrayT.Clear(this._playingAnimates,function(t){t.stop()})},n.prototype.__cb_aniend=function(e){var n=e.sender;t.ArrayT.RemoveObject(this._playingAnimates,n)},n.prototype.impSetFrame=function(t,e){},n.prototype.updateCache=function(){this.cacheEnabled&&this.setNeedsCache()},n.prototype.setNeedsCache=function(){t.FramesManager.needsCache(this)},n.prototype.onLoaded=function(){this._signals&&this._signals.emit(t.SignalLoaded)
},n.GetReqResources=function(){return t.ReqResources.GetReqResources.call(this)},n.ResourcesRequire=function(e){t.ReqResources.ResourcesRequire.call(this,e)},n.prototype.getReqResources=function(){return t.ReqResources.prototype.getReqResources.call(this)},n.prototype.updateResource=function(){},n.prototype.loadReqResources=function(e,n){var i=t.ObjectClass(this),r=t.ArrayT.Concat(i.GetReqResources(),this.getReqResources());if(0==t.length(r))return void e.call(n);var o=t.ResManager.capsules(r);if(i.ShowResourceProgress)if(i.ClazzResourceProgress){var s=i.ClazzResourceProgress;null==s&&(s=t.CApplication.shared.clazzResourceProgress.type);var a=new s;o.signals.connect(t.SignalChanged,function(t){a.progressValue=t.data},null),a.open(!1),o.load(function(){a.close(),e.call(n)})}else t.RESOURCELOADINGISHUD&&(t.Hud.ShowProgress(),o.load(function(){t.Hud.HideProgress(),e.call(n)}));else o.load(function(){e.call(n)})},n.New=function(e){for(var n=this,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];var o=t.ObjectClass(this),s=o.GetReqResources();if(0==t.length(s)){var a=t.NewObject(o,i);return e.call(this,a),a}var c=t.ResManager.capsules(s);if(o.ShowResourceProgress)if(o.ClazzResourceProgress){var u=o.ClazzResourceProgress;null==u&&(u=t.CApplication.shared.clazzResourceProgress.type);var l=new u;c.signals.connect(t.SignalChanged,function(t){l.progressValue=t.data},null),l.open(!1),c.load(function(){l.close();var r=t.NewObject(o,i);e.call(n,r)})}else t.RESOURCELOADINGISHUD&&(t.Hud.ShowProgress(),c.load(function(){t.Hud.HideProgress();var r=t.NewObject(o,i);e.call(n,r)}));else c.load(function(){var r=t.NewObject(o,i);e.call(n,r)});return null},n.prototype.setNeedsLayout=function(){t.FramesManager.needsLayout(this)},n.prototype.flushLayout=function(){t.FramesManager.cancelLayout(this),this.updateLayout()},n.prototype.updateLayout=function(){},n.prototype.setNeedsZPosition=function(){t.FramesManager.needsZPosition(this)},n.prototype.updateData=function(){},n.prototype.setX=function(t){var e=this.frame;return e.x=t,this.frame=e,this},n.prototype.getX=function(){return this.frame.x},n.prototype.setY=function(t){var e=this.frame;return e.y=t,this.frame=e,this},n.prototype.getY=function(){return this.frame.y},n.prototype.setWidth=function(t){var e=this.frame;return e.width==t?this:(e.width=t,this.frame=e,this)},n.prototype.getWidth=function(){return this.frame.width},n.prototype.setHeight=function(t){var e=this.frame;return e.height==t?this:(e.height=t,this.frame=e,this)},n.prototype.getHeight=function(){return this.frame.height},n.prototype.setSize=function(t){var e=this.frame;return e.width==t.width&&e.height==t.height?this:(e.size=t,this.frame=e,this)},n.prototype.setOrigin=function(t){var e=this.frame;if(e.x!=t.x||e.y!=t.y)return e.position=t,this.frame=e,this},n.prototype.offsetOrigin=function(t){var e=this.frame;return e.add(t.x,t.y),this.frame=e,this},n.prototype.setCenter=function(t){var e=this.frame;return e.center=t,this.frame=e,this},n.prototype.setLeftTop=function(t){var e=this.frame;return e.leftTop=t,this.frame=e,this},n.prototype.setLeftCenter=function(t){var e=this.frame;return e.leftCenter=t,this.frame=e,this},n.prototype.setLeftBottom=function(t){var e=this.frame;return e.leftBottom=t,this.frame=e,this},n.prototype.setTopCenter=function(t){var e=this.frame;return e.topCenter=t,this.frame=e,this},n.prototype.setBottomCenter=function(t){var e=this.frame;return e.bottomCenter=t,this.frame=e,this},n.prototype.setRightTop=function(t){var e=this.frame;return e.rightTop=t,this.frame=e,this},n.prototype.setRightCenter=function(t){var e=this.frame;return e.rightCenter=t,this.frame=e,this},n.prototype.setRightBottom=function(t){var e=this.frame;return e.rightBottom=t,this.frame=e,this},n.prototype.setScaleX=function(e){var n=this.scale;n=null==n?new t.Point(e,1):new t.Point(e,n.y),this.scale=n},n.prototype.setScaleY=function(e){var n=this.scale;return n=null==n?new t.Point(1,e):new t.Point(n.x,e),this.scale=n,this},n.prototype.setScale=function(e){return this.scale=new t.Point(e,e),this},n.prototype.setTranslateX=function(e){var n=this.translate;return n=null==n?new t.Point(e,0):new t.Point(e,n.y),this.translate=n,this},n.prototype.setTranslateY=function(e){var n=this.translate;return n=null==n?new t.Point(0,e):new t.Point(n.x,e),this.translate=n,this},n.prototype.bestFrame=function(e){return t.ObjectClass(this).BestFrame(e)},n.prototype.bestPosition=function(){return null},n.BestFrame=function(e){return new t.Rect},n.prototype.getEdgeInsets=function(){return null==this.edgeInsets&&(this.edgeInsets=new t.EdgeInsets),this.edgeInsets},n.prototype.boundsForLayout=function(){return this.bounds().applyEdgeInsets(this.edgeInsets)},n.prototype.onVisibleChanged=function(){},n.prototype.onAppeared=function(){t.ISDEBUG&&this.isAppeared&&t.warn(t.Classname(this)+" 重复显示"),this.isAppeared=!0,this._playingAnimates&&this._playingAnimates.forEach(function(t){-1==t.count&&t.isPaused()&&t.resume()}),this.children.forEach(function(t){t.isAppeared||t.onAppeared()},this)},n.prototype.onDisappeared=function(){t.ISDEBUG&&(this.isAppeared||t.warn(t.Classname(this)+" 重复消失")),this.isAppeared=!1,this._playingAnimates&&this._playingAnimates.forEach(function(t){-1==t.count&&t.pause()}),this.children.forEach(function(t){t.isAppeared&&t.onDisappeared()},this)},n.prototype.setNeedsAppear=function(){t.FramesManager.needsAppear(this)},n.prototype.removeFromParent=function(){var t=this.parent;t&&t.removeChild(this)},Object.defineProperty(n.prototype,"viewStack",{get:function(){if(this._viewStack)return this._viewStack;var t=this.parent;return t?t.viewStack:null},set:function(t){this._viewStack=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"states",{get:function(){return null==this._states&&(this._states=new t.States,this._states.cbset=this.onChangeState,this._states.cbctx=this,this._states.nullobj=null),this._states},enumerable:!0,configurable:!0}),n.prototype.onChangeState=function(e){t.State.As(e).setIn(this),this.updateCache()},n}(t.SObject);e.ClazzResourceProgress=t.ReqResources.ClazzResourceProgress,e.ShowResourceProgress=t.ReqResources.ShowResourceProgress,t.CComponent=e}(nn||(nn={}));var nn;!function(t){var e=function(){function t(){this._preproperties=new KvObject,this._properties=new KvObject}return t.prototype.translate=function(t){return this.backMode?(this._preproperties.dx=-t.x,this._preproperties.dy=-t.y,this._properties.dx=0,this._properties.dy=0):(this._properties.dx=t.x,this._properties.dy=t.y),this},t.prototype.translatex=function(t){return this.backMode?(this._preproperties.dx=-t,this._properties.dx=0):this._properties.dx=t,this},t.prototype.translatey=function(t){return this.backMode?(this._preproperties.dy=-t,this._properties.dy=0):this._properties.dy=t,this},t.prototype.stranslate=function(t){return this.backMode?(this._preproperties.dxs=-t.x,this._preproperties.dys=-t.y,this._properties.dxs=0,this._properties.dys=0):(this._properties.dxs=t.x,this._properties.dys=t.y),this},t.prototype.moveto=function(t){return this._properties.x=t.x,this._properties.y=t.y,this},t.prototype.movetox=function(t){return this._properties.x=t,this},t.prototype.movetoy=function(t){return this._properties.y=t,this},t.prototype.scale=function(t){return this.backMode?(this._preproperties.dsx=-t.x,this._preproperties.dsy=-t.y,this._properties.dsx=0,this._properties.dsy=0):(this._properties.dsx=t.x,this._properties.dsy=t.y),this},t.prototype.scaleto=function(t){return this._properties.scaleX=t.x,this._properties.scaleY=t.y,this},t.prototype.rotate=function(t){return this.backMode&&(this._preproperties.dangle=-t.angle),this._properties.dangle=t.angle,this},t.prototype.fade=function(t,e){return null!=e&&(this._preproperties.alpha=e),null!=t&&(this._properties.alpha=t),this},t.prototype.fadeIn=function(t){return void 0===t&&(t=1),this.fade(t,0)},t.prototype.fadeOut=function(t){return void 0===t&&(t=0),this.fade(t)},t.prototype.change=function(t,e,n){return null!=n&&(this._preproperties[t]=n),null!=e&&(this._properties[t]=e),this},t}();t.Animator=e;var n=function(){function t(){}return t}();n.IN=1,n.OUT=2,n.INOUT=3,t.TimeFunction=n;var i=function(e){function i(){var t=e.call(this)||this;return t.count=1,t._firedCount=0,t.autoUnbind=!0,t.autoDrop=!0,t}return __extends(i,e),i.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},i.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalEnd),this._signals.register(t.SignalDone)},i.prototype.repeat=function(t){return this.count=t,this},i.prototype.then=function(t,e,n,r){return void 0===e&&(e=null),void 0===n&&(n=i.Duration),void 0===r&&(r=null),this.to(n,r,t,e)},i.prototype.complete=function(e,n){return this.signals.connect(t.SignalDone,e,n),this},i.prototype.clone=function(){var e=t.InstanceNewObject(this);return e.autoReset=this.autoReset,e.autoUnbind=this.autoUnbind,e.autoDrop=this.autoDrop,e.count=this.count,e.tag=this.tag,e},i.Stop=function(t){},i.prototype.inTo=function(t,e,i,r){return void 0===r&&(r=n.Quad(n.OUT)),this.to(t,r,e,i)},i.prototype.outTo=function(t,e,i,r){return void 0===r&&(r=n.Quad(n.IN)),this.to(t,r,e,i)},i.prototype.tremble=function(t,e){return void 0===t&&(t=i.Duration),this.next({scaleX:1.3,scaleY:1.3},.2*t,e).next({scaleX:.8,scaleY:.8},.2*t,e).next({scaleX:1.1,scaleY:1.1},.2*t,e).next({scaleX:.9,scaleY:.9},.2*t,e).next({scaleX:1,scaleY:1},.2*t,e)},i}(t.SObject);i.Duration=.33,t.CAnimate=i;var r=function(){function t(){}return t.Get=function(t,e){return null},t.Stop=function(t){},t}();t.CTween=r}(nn||(nn={}));var nn;!function(t){function e(e,n){var i=n?n[t.ResPartKey]:null,r=n?n.scale9Grid:null;if(i){var o=new t.URL(i);if(void 0!==o.fields.repeat&&(e.fillMode=egret.BitmapFillMode.REPEAT),void 0!==o.fields.point9){var s=t.ArrayT.Convert(o.fields.point9.split(","),function(t){return parseInt(t)});r=new egret.Rectangle(s[0],s[1],s[2],s[3])}}e.texture=n,e.scale9Grid=r}var n=new egret.Point,i=new egret.Rectangle,r=function(e){function i(){return e.apply(this,arguments)||this}return __extends(i,e),Object.defineProperty(i.prototype,"target",{get:function(){return this._e.target},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTarget",{get:function(){return this._e.currentTarget},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_event",{set:function(e){if(this._e=e,null!=e){var i,r;switch(e.currentTarget!=e.target?(e.currentTarget.globalToLocal(e.stageX,e.stageY,n),i=n.x,r=n.y):(i=e.localX,r=e.localY),i*=t.ScaleFactorDeX,r*=t.ScaleFactorDeY,e.type){case egret.TouchEvent.TOUCH_MOVE:this.currentPosition.reset(i,r);break;case egret.TouchEvent.TOUCH_BEGIN:this.startPosition.reset(i,r),this.lastPosition.copy(this.startPosition),this.currentPosition.copy(this.startPosition);break;case egret.TouchEvent.TOUCH_END:case egret.TouchEvent.TOUCH_RELEASE_OUTSIDE:case egret.TouchEvent.TOUCH_TAP:this.currentPosition.reset(i,r)}}},enumerable:!0,configurable:!0}),i.prototype.cancel=function(){this._e.stopImmediatePropagation()},i.prototype.veto=function(){this._e.stopPropagation()},i.prototype.positionInView=function(e){var n=t.CComponent.FromImp(this._e.currentTarget);return n.convertPointTo(this.currentPosition,e)},i}(t.CTouch);t.Touch=r;var o=function(e){function n(){var t=e.call(this)||this;return t.width=0,t.height=0,t}return __extends(n,e),n.prototype.$hitTest=function(n,i){var r=t.CComponent.FromImp(this);return r?r.hitTest(n,i):e.prototype.$hitTest.call(this,n,i)},n.prototype.$measureContentBounds=function(t){t.width=this.width,t.height=this.height},n}(egret.Sprite),s=function(t){function e(){var e=t.call(this)||this;return e.width=0,e.height=0,e}return __extends(e,t),e}(egret.Bitmap);t.ExtBitmap=s;var a=function(a){function c(){return a.call(this)||this}return __extends(c,a),c.prototype.createImp=function(){this._imp=new o},c.prototype._signalConnected=function(e,n){switch(a.prototype._signalConnected.call(this,e,n),e){case t.SignalTouchBegin:case t.SignalTouchEnd:case t.SignalTouchMove:this.touchEnabled=!0,t.EventHook(this._imp,egret.TouchEvent.TOUCH_BEGIN,this.__dsp_touchbegin,this),t.EventHook(this._imp,egret.TouchEvent.TOUCH_END,this.__dsp_touchend,this),t.EventHook(this._imp,egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.__dsp_touchrelease,this),t.EventHook(this._imp,egret.TouchEvent.TOUCH_MOVE,this.__dsp_touchmove,this);break;case t.SignalAddedToStage:t.EventHook(this._imp,egret.Event.ADDED_TO_STAGE,this.__dsp_addedtostage,this);break;case t.SignalClicked:this.touchEnabled=!0,t.EventHook(this._imp,egret.TouchEvent.TOUCH_TAP,this.__dsp_tap,this);break;case t.SignalPreTouch:t.EventHook(this._imp,egret.TouchEvent.TOUCH_BEGIN,this.__dsp_pretouch,this,!0),t.EventHook(this._imp,egret.TouchEvent.TOUCH_END,this.__dsp_pretouch,this,!0),t.EventHook(this._imp,egret.TouchEvent.TOUCH_MOVE,this.__dsp_pretouch,this,!0);break;case t.SignalPreClick:t.EventHook(this._imp,egret.TouchEvent.TOUCH_TAP,this.__dsp_preclick,this,!0)}},c.prototype.dispose=function(){for(var t=0;t<this._imp.numChildren;++t){var e=this.getChildAt(t);e&&e.drop()}this._touch=void 0,a.prototype.dispose.call(this)},c.prototype.instance=function(){this._imp=new egret.Sprite},c.prototype.validate=function(){var t=this._imp;return null!=t&&t.width>0&&t.height>0},c.prototype.hitTestChild=function(t,e){return egret.Sprite.prototype.$hitTest.call(this._imp,t,e)},c.prototype.hitTestClient=function(e,n){var i=this._imp;if(!i.$renderNode||!i.$visible)return null;var r=i.$getInvertedConcatenatedMatrix(),o=r.a*e+r.c*n+r.tx,s=r.b*e+r.d*n+r.ty;return t.Rect.ContainsPoint(o,s,0,0,i.width,i.height)?i:null},Object.defineProperty(c.prototype,"onStage",{get:function(){return null!=this._imp.stage},enumerable:!0,configurable:!0}),c.prototype.loadScene=function(e,n){if(t.ResManager.isGroupsArrayLoaded(this.resourceGroups))e.call(n);else{var i=t.ResManager.capsules(this.resourceGroups);if(this.showResourceProgress)if(t.RESOURCELOADINGISHUD)t.Hud.ShowProgress(),i.load(function(){t.Hud.HideProgress(),e.call(n)});else{var r=this.clazzResourceProgress;null==r&&(r=t.CApplication.shared.clazzResourceProgress.type);var o=new r;i.signals.connect(t.SignalChanged,function(t){o.progressValue=t.data},null),o.open(!1),i.load(function(){o.close(),e.call(n)})}else i.load(function(){e.call(n)})}},c.prototype.addChild=function(t,e){var n=this;void 0===e&&(e=!0),this._imp.addChild(t._imp),t.loadScene(function(){n.__disposed||n.onChildAdded(t,e)},this)},c.prototype.addChildAt=function(t,e,n){var i=this;void 0===n&&(n=!0),this._imp.addChildAt(t._imp,e),t.loadScene(function(){i.__disposed||i.onChildAdded(t,n)},this)},c.prototype.removeChild=function(t){this._imp.removeChild(t._imp),this.onChildRemoved(t)},c.prototype.removeChildren=function(){var t=this;this.children.forEach(function(e){t.removeChild(e)},this),this._imp.removeChildren()},c.prototype.getChildAt=function(t){return c.FromImp(this._imp.getChildAt(t))},c.prototype.setChildIndex=function(t,e){this._imp.setChildIndex(t.handle(),e)},c.prototype.getChildIndex=function(t){return this._imp.getChildIndex(t.handle())},c.prototype.swapChildAt=function(t,e){this._imp.swapChildrenAt(t,e)},c.prototype.swapChild=function(t,e){this._imp.swapChildren(t.handle(),e.handle())},c.prototype.hasChild=function(t){return this._imp.contains(t.handle())},c.prototype.bringFront=function(t){var e=t?this.parent.getChildIndex(t):this.parent._imp.numChildren;this.parent._imp.setChildIndex(this._imp,e)},c.prototype.sendBack=function(t){var e=t?this.parent.getChildIndex(t):0;e>0&&--e,this.parent._imp.setChildIndex(this._imp,e)},c.prototype.hollowOut=function(t){t.handle().blendMode=egret.BlendMode.ERASE,this._imp.addChild(t.handle()),this.hasHollowOut=!0},Object.defineProperty(c.prototype,"numChildren",{get:function(){return this._imp.numChildren},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"zPosition",{get:function(){var t=this._imp;if(null==t.parent)return t._zposition;var e=t.parent.numChildren,n=t.parent.getChildIndex(t);return e-1-n},set:function(t){var e=this,n=e._imp;n._zposition!=t&&(n._zposition=t,null!=n.parent&&e.parent.setNeedsZPosition())},enumerable:!0,configurable:!0}),c._SortDepth=function(t,e){return e._zposition-t._zposition},c.prototype.updateZPosition=function(){for(var e=this,n=e._imp,i=n.numChildren,r=[],o=[],s=0;i>s;++s){var a=n.getChildAt(s);a._zposition>t.ZPOSITION.DEFAULT?r.push(a):a._zposition<t.ZPOSITION.DEFAULT&&o.push(a)}o.length&&(o.sort(c._SortDepth),o.forEach(function(t){n.setChildIndex(t,i)})),r.length&&(r.sort(c._SortDepth),r.forEach(function(t,e){n.setChildIndex(t,0)}))},Object.defineProperty(c.prototype,"children",{get:function(){for(var t=[],e=0;e<this.numChildren;++e){var n=c.FromImp(this._imp.getChildAt(e));n&&t.push(n)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"parent",{get:function(){var t=this._imp.parent;return t?c.FromImp(t):null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"touchEnabled",{get:function(){return this._imp.touchEnabled},set:function(t){this._imp.touchEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"touchChildren",{get:function(){return this._imp.touchChildren},set:function(t){this._imp.touchChildren=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"visible",{get:function(){return this._imp.visible},set:function(t){t!=this._imp.visible&&(this._imp.visible=t,this.onVisibleChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"clipsToBounds",{get:function(){return null!=this._imp.mask},set:function(e){this._imp.mask&&!e?this._imp.mask=void 0:null==this._imp.mask&&e&&(this._imp.mask=new t.Rect(0,0,this._imp.width,this._imp.height))},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"clipsRegion",{get:function(){return this._imp.mask},set:function(t){this._imp.mask=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"maskView",{get:function(){var t=this._imp.mask;return t?t._fmui:null},set:function(t){this._imp.mask=t.handle()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"animate",{get:function(){return t.warn("Component的animate只允许set"),null},set:function(t){t.clone().bind(this).play()},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"translate",{get:function(){return this._translate?this._translate.clone():null},set:function(t){var e=this.frame;this._translate&&(e.x-=this._translate.x,e.y-=this._translate.y),this._translate=t,this.frame=e},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"scale",{get:function(){return this._scale},set:function(t){this._scale=t,this._imp.scaleX=t?t.x:1,this._imp.scaleY=t?t.y:1},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._imp.rotation=t?t.angle:0},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"alpha",{get:function(){return this._imp.alpha},set:function(t){this._imp.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"cacheEnabled",{get:function(){return this._cacheEnabled},set:function(t){this._cacheEnabled!=t&&(this._cacheEnabled=t,this._imp.cacheAsBitmap=t)},enumerable:!0,configurable:!0}),c.prototype.flushCache=function(){},c.prototype.updateCache=function(){},c.prototype.setNeedsCache=function(){},Object.defineProperty(c.prototype,"anchor",{get:function(){return this._anchorPoint},set:function(e){if(!t.ObjectT.IsEqual(e,this._anchorPoint))if(this._anchorPoint=e,this._anchorOffset=void 0,null==e){var n=this._imp.anchorOffsetX,i=this._imp.anchorOffsetY;this._imp.x-=n,this._imp.y-=i,this._imp.anchorOffsetX=0,this._imp.anchorOffsetY=0}else{var n=e.x*this._imp.width,i=e.y*this._imp.height;this._imp.anchorOffsetX=n,this._imp.anchorOffsetY=i,this._imp.x+=n,this._imp.y+=i}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"anchorOffset",{get:function(){return this._anchorOffset},set:function(e){t.ObjectT.IsEqual(e,this._anchorOffset)||(this._anchorOffset=e,this._anchorPoint=null,this._imp.x-=this._imp.anchorOffsetX,this._imp.y-=this._imp.anchorOffsetY,null==e?(this._imp.anchorOffsetX=0,this._imp.anchorOffsetY=0):(this._imp.anchorOffsetX=e.x,this._imp.anchorOffsetY=e.y,this._imp.x+=e.x,this._imp.y+=e.y))},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"frame",{get:function(){var e=this._imp.x,n=this._imp.y,i=this._imp.width,r=this._imp.height;return(this._anchorPoint||this._anchorOffset)&&(e-=this._imp.anchorOffsetX,n-=this._imp.anchorOffsetY),e*=t.ScaleFactorDeX,n*=t.ScaleFactorDeY,i*=t.ScaleFactorDeW,r*=t.ScaleFactorDeH,new t.Rect(e,n,i,r)},set:function(t){this.setFrame(t,!0)},enumerable:!0,configurable:!0}),c.prototype.setFrame=function(e,n){void 0===n&&(n=!0);var i=e.x*t.ScaleFactorX,r=e.y*t.ScaleFactorY,o=e.width*t.ScaleFactorW,s=e.height*t.ScaleFactorH;if(this._translate&&(i+=this._translate.x*t.ScaleFactorX,r+=this._translate.y*t.ScaleFactorY),n&&this._anchorPoint){var a=this._anchorPoint.x*o,c=this._anchorPoint.y*s;this._imp.anchorOffsetX=a,this._imp.anchorOffsetY=c,i+=a,r+=c}this.floatCoordinate||(i=t.Integral(i),r=t.Integral(r),o=t.Integral(o),s=t.Integral(s));var u=this._imp,l=u.width!=o||u.height!=s;u.x=i,u.y=r,u.width=o,u.height=s,u.mask instanceof egret.Rectangle&&u.mask.setTo(0,0,o,s),l&&this.setNeedsLayout()},c.prototype.getX=function(){return this._imp.x*t.ScaleFactorDeX},c.prototype.getY=function(){return this._imp.y*t.ScaleFactorDeY},c.prototype.getWidth=function(){return this._imp.width*t.ScaleFactorDeW},c.prototype.getHeight=function(){return this._imp.height*t.ScaleFactorDeH},c.prototype.impSetFrame=function(e,n){this.floatCoordinate?(n.x=e.x*t.ScaleFactorX,n.y=e.y*t.ScaleFactorY,n.width=e.width*t.ScaleFactorW,n.height=e.height*t.ScaleFactorH):(n.x=t.Integral(e.x*t.ScaleFactorX),n.y=t.Integral(e.y*t.ScaleFactorY),n.width=t.Integral(e.width*t.ScaleFactorW),n.height=t.Integral(e.height*t.ScaleFactorH))},c.prototype.bounds=function(){return new t.Rect(0,0,this._imp.width*t.ScaleFactorDeW,this._imp.height*t.ScaleFactorDeH)},Object.defineProperty(c.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._drawBackground(null)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"borderLine",{get:function(){return this._borderLine},set:function(t){this._borderLine=t,this._drawBackground(null)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"backgroundImage",{get:function(){return null==this._backgroundImageView?null:(t.COriginType.shared.imp=this._backgroundImageView.texture,t.COriginType.shared)},set:function(n){var i=this;if(this._backgroundImageSource!=n){if(this._backgroundImageSource=n,null==n)return void(this._backgroundImageView&&(this._backgroundImageView.texture=null));null==this._backgroundImageView&&(this._backgroundImageView=new s,this._imp.addChildAt(this._backgroundImageView,0),this.setNeedsLayout()),t.ResManager.getTexture(n,t.ResPriority.NORMAL,function(t){i._backgroundImageSource==n&&e(i._backgroundImageView,t.use())},this)}},enumerable:!0,configurable:!0}),c.prototype._drawBackground=function(e){var n=this;null==e&&(e=n.bounds().applyEdgeInsets(n.backgroundEdgeInsets).applyScaleFactor());var i;if(n.hasHollowOut){var r=n._lyrBackground;null==r&&(r=new egret.Shape,r._zposition=t.ZPOSITION.DEFAULT+1,n._imp.addChildAt(r,0),n._lyrBackground=r),r.x=e.x,r.y=e.y,r.width=e.width,r.height=e.height,i=r.graphics,e.x=e.y=0}else i=n._imp.graphics;i.clear();var o=n._backgroundColor;o&&(i.beginFill.apply(i,t.GetColorComponent(o)),i.drawRect(e.x,e.y,e.width,e.height),i.endFill());var s=n._borderLine;if(this._borderLine){var a=t.GetColorComponent(s.color);i.lineStyle(s.width,a[0],a[1],s.smooth),i.drawRect(e.x,e.y,e.width,e.height)}},Object.defineProperty(c.prototype,"gestures",{get:function(){return null==this._gestures&&(this._gestures=new Array),this._gestures},enumerable:!0,configurable:!0}),c.prototype.addGesture=function(t){t.detach(),t.attach(this)},c.prototype.clearGestures=function(){this._gestures&&t.ArrayT.Clear(this._gestures,function(t){t.drop()})},c.prototype.updateLayout=function(){a.prototype.updateLayout.call(this);var t=this.bounds().applyEdgeInsets(this.backgroundEdgeInsets).applyScaleFactor();this._backgroundColor&&this._drawBackground(t);var e=this._backgroundImageView;e&&(e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height)},Object.defineProperty(c.prototype,"touch",{get:function(){return null==this._touch&&(this._touch=new r),this._touch},enumerable:!0,configurable:!0}),c.prototype.__dsp_touchbegin=function(e){var n=this.touch;n._event=e,this._signals.emit(t.SignalTouchBegin,n)},c.prototype.__dsp_touchend=function(e){var n=this.touch;n._event=e,this._signals.emit(t.SignalTouchEnd,n)},c.prototype.__dsp_touchrelease=function(e){if(!this.__disposed){var n=this.touch;n._event=e,this._signals.emit(t.SignalTouchEnd,n)}},c.prototype.__dsp_touchmove=function(e){var n=this.touch;n._event=e,this._signals.emit(t.SignalTouchMove,n),n.lastPosition.copy(n.currentPosition)},c.prototype.__dsp_pretouch=function(e){var n=this.touch;n._event=e,this._signals.emit(t.SignalPreTouch,n)},c.prototype.__dsp_preclick=function(e){var n=this.touch;n._event=e,this._signals.emit(t.SignalPreClick,n)},c.prototype.__dsp_addedtostage=function(){this._signals.emit(t.SignalAddedToStage)},c.prototype.__dsp_tap=function(e){var n=this.touch;n._event=e,this._signals&&this._signals.emit(t.SignalClicked,n),e.stopPropagation()},c.prototype.convertPointTo=function(e,i){var r=this._imp,o=i?i._imp:t.CApplication.shared.gameLayer._imp;return r.localToGlobal(e.x*t.ScaleFactorX,e.y*t.ScaleFactorY,n),o.globalToLocal(n.x,n.y,n),n.x*=t.ScaleFactorDeX,n.y*=t.ScaleFactorDeY,new t.Point(n.x,n.y)},c.prototype.convertRectTo=function(e,i){var r=this._imp,o=i?i._imp:t.CApplication.shared.gameLayer._imp;return r.localToGlobal(e.x*t.ScaleFactorX,e.y*t.ScaleFactorY,n),o.globalToLocal(n.x,n.y,n),n.x*=t.ScaleFactorDeX,n.y*=t.ScaleFactorDeY,new t.Rect(n.x,n.y,e.width,e.height)},c.prototype.renderToTexture=function(){i.x=i.y=0,i.width=this._imp.width,i.height=this._imp.height,this.updateCache();var e=new egret.RenderTexture;return 0==e.drawToTexture(this._imp,i)&&t.warn("绘制 ui 到纹理失败"),t.COriginType.shared.imp=e,t.COriginType.shared},c}(t.CComponent);t.Component=a,t.impSetTexture=e;var c=t.Point.prototype;c.setTo=function(t,e){this.x=t,this.y=e}}(nn||(nn={}));var nn;!function(t){t.TimeFunction.Pow=function(e,n){return n==t.TimeFunction.INOUT?egret.Ease.getPowInOut(e):n==t.TimeFunction.OUT?egret.Ease.getPowOut(e):egret.Ease.getPowIn(e)},t.TimeFunction.Quad=function(e){return e==t.TimeFunction.INOUT?egret.Ease.quadInOut:e==t.TimeFunction.OUT?egret.Ease.quadOut:egret.Ease.quadIn},t.TimeFunction.Bounce=function(e){return e==t.TimeFunction.INOUT?egret.Ease.bounceInOut:e==t.TimeFunction.OUT?egret.Ease.bounceOut:egret.Ease.bounceIn},t.TimeFunction.Elastic=function(e,n,i){return null==e&&null==n?i==t.TimeFunction.INOUT?egret.Ease.elasticInOut:i==t.TimeFunction.OUT?egret.Ease.elasticOut:egret.Ease.elasticIn:i==t.TimeFunction.INOUT?egret.Ease.getElasticInOut(e,n):i==t.TimeFunction.OUT?egret.Ease.getElasticOut(e,n):egret.Ease.getElasticIn(e,n)},t.TimeFunction.Circ=function(e){return e==t.TimeFunction.INOUT?egret.Ease.circInOut:e==t.TimeFunction.OUT?egret.Ease.circOut:egret.Ease.circIn},t.TimeFunction.Back=function(e,n){return null==e?n==t.TimeFunction.INOUT?egret.Ease.backInOut:n==t.TimeFunction.OUT?egret.Ease.backOut:egret.Ease.backIn:n==t.TimeFunction.INOUT?egret.Ease.getBackInOut(e):n==t.TimeFunction.OUT?egret.Ease.getBackOut(e):egret.Ease.getBackIn(e)};var e=function(e){function n(){var n=e.call(this)||this;return n.__ani_ended=0,n._paused=!1,n._targets=new t.CSet,n._steps=new Array,n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype.bind=function(t){return this._targets.add(t.handle()),this},n.prototype.unbind=function(t){this._targets["delete"](t.handle())},n.prototype.unbindAll=function(){t.SetT.Clear(this._targets)},n.prototype.clear=function(){return this.stop(),t.ArrayT.Clear(this._steps),this},n.prototype.stop=function(){this._targets.forEach(function(t){return egret.Tween.removeTweens(t),!0})},n.prototype.next=function(t,e,n){return this._steps.push({preprops:{},props:t,duration:e,time:n}),this},n.prototype.to=function(e,n,i,r){var o=new t.Animator;return i.call(r,o),this._steps.push({preprops:o._preproperties,props:o._properties,duration:e,time:n}),this},n.prototype.wait=function(t,e){return this._steps.push({preprops:{},props:{},duration:t,time:null,opt:e}),this},n.prototype.invoke=function(t,e){return this._steps.push({preprops:{},props:{},workfun:t,workctx:e,time:null}),this},n.prototype._doPlay=function(e){var n=this,i=this;i.__ani_ended=0,i._targets.forEach(function(r){var o=egret.Tween.get(r,{loop:i.count<1});i._steps.forEach(function(s){var a=s.preprops,c=s.props,u=t.MapT.Length(a);if(u){var l={};t.MapT.Foreach(a,function(n,i){switch(e&&(i=-i),n){case"dx":l.x=r.x+i*t.ScaleFactorW;break;case"dy":l.y=r.y+i*t.ScaleFactorH;break;case"dsx":l.scaleX=r.scaleX+i;break;case"dsy":l.scaleY=r.scaleY+i;break;case"dxs":l.x=r.x+r.width*i;break;case"dys":l.y=r.y+r.height*i;break;case"alpha":l.alpha=i;break;case"dangle":l.rotation=r.rotation+i;break;default:l[n]=r[n]+i}return!0}),o.to(l,0,null)}var h=t.MapT.Length(c);if(h){var l={};t.MapT.Foreach(c,function(n,i){switch(e&&(i=-i),n){case"x":l.x=i*t.ScaleFactorX+r.anchorOffsetX;break;case"y":l.y=i*t.ScaleFactorY+r.anchorOffsetY;break;case"dx":l.x=r.x+i*t.ScaleFactorW;break;case"dy":l.y=r.y+i*t.ScaleFactorH;break;case"dsx":l.scaleX=r.scaleX+i;break;case"dsy":l.scaleY=r.scaleY+i;break;case"dxs":l.x=r.x+r.width*i;break;case"dys":l.y=r.y+r.height*i;break;case"alpha":l.alpha=i;break;case"dangle":l.rotation=r.rotation+i;break;default:l[n]=i}return!0},n),o.to(l,1e3*s.duration,s.time)}if(0==u&&0==h&&(s.duration?o.wait(1e3*s.duration,s.opt):s.workfun&&s.workfun.call(s.workctx)),i.autoReset&&h){var l={};t.MapT.Foreach(c,function(t,e){switch(t){case"dx":l.x=r.x;break;case"dy":l.y=r.y;break;case"dsx":l.scaleX=r.scaleX;break;case"dsy":l.scaleY=r.scaleY;break;case"dxs":l.x=r.x;break;case"dys":l.y=r.y;break;case"alpha":l.alpha=r.alpha;break;case"dangle":l.rotation=r.rotation;break;default:l[t]=r[e]}return!0},n),o.to(l,0,null)}},n),o.call(function(n){++i.__ani_ended==i._targets.size&&(i.__ani_ended=0,i._signals&&i._signals.emit(t.SignalEnd),i.count>0&&(++i._firedCount>=i.count?(i.stop(),i._signals&&i._signals.emit(t.SignalDone),i.autoUnbind&&i.unbindAll(),i.autoDrop&&(i=t.drop(i))):i._doPlay(e)))},i,[r])},i)},n.prototype.play=function(e){var n=this;n._firedCount=0;var i=!1;return(0!=n._targets.size||0!=n._steps.length)&&(n._doPlay(e),i=!0),i&&n._signals&&n._signals.emit(t.SignalStart),n},n.prototype.pause=function(){this._paused||(this._paused=!0,this._targets.forEach(function(t){egret.Tween.pauseTweens(t)}))},n.prototype.resume=function(){0!=this._paused&&(this._paused=!1,this._targets.forEach(function(t){egret.Tween.resumeTweens(t)}))},n.prototype.isPaused=function(){return this._paused},n.prototype.clone=function(){var n=e.prototype.clone.call(this);return n._targets=t.SetT.Clone(this._targets),n._steps=t.ArrayT.Clone(this._steps),n},n.Stop=function(t){egret.Tween.removeTweens(t.handle())},n}(t.CAnimate);t.Animate=e;var n=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.Get=function(t,e){return egret.Tween.get(t.handle(),e)},e.Stop=function(t){egret.Tween.removeTweens(t.handle())},e}(t.CTween);t.Tween=n;var i=function(e){function n(){var t=e.call(this)||this;return t._list=new Array,t}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalDone)},n.prototype.add=function(e){return this._list.push(e),e.signals.connect(t.SignalDone,this._cb_aniend,this),this
},n.prototype.play=function(){return this._counter=0,this._list.forEach(function(t){t.play()}),this},n.prototype.complete=function(e,n){return this.signals.connect(t.SignalDone,e,n),this},n.prototype._cb_aniend=function(){++this._counter==this._list.length&&this.signals.emit(t.SignalDone)},n}(t.SObject);t.Animates=i;var r=function(e){function n(){var t=e.call(this)||this;return t._animates=new Array,t}return __extends(n,e),n.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalDone)},n.prototype.add=function(t){return this._current().add(t),this},n.prototype.next=function(t){return this._next().add(t),this},n.prototype.play=function(){var e=this;if(0==this._animates.length)return this._signals&&this._signals.emit(t.SignalDone),void this.drop();var n=this._animates[0],i=this._animates[this._animates.length-1];return i.complete(function(){e._signals&&e._signals.emit(t.SignalDone),e.drop()},this),n.play(),this},n.prototype.complete=function(e,n){return this.signals.connect(t.SignalDone,e,n),this},n.prototype.clear=function(){t.ArrayT.Clear(this._animates,function(t){t.drop()})},n.prototype._current=function(){return this.__current?this.__current:(this.__current=new i,this._animates.push(this.__current),this.__current)},n.prototype._next=function(){var t=this.__current;return this.__current=new i,t&&t.complete(this.__current.play,this.__current),this._animates.push(this.__current),this.__current},n}(t.SObject);t.AnimateGroup=r;var o=function(e){function n(t,n){var i=e.call(this)||this;return i._ani_step=0,i._ani_cnt=0,i.appear=t,i.disappear=n,i}return __extends(n,e),n.prototype.dispose=function(){this.appear=void 0,this.disappear=void 0,e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalDone)},n.prototype.play=function(e,n){if(this._ani_step=0,this._ani_cnt=0,this.appear&&e){++this._ani_cnt;var i=this.appear.clone();i.signals.connect(t.SignalDone,this.__cbani_end,this),i.bind(e).play(this.reverse)}if(this.disappear&&n){++this._ani_cnt;var i=this.disappear.clone();i.signals.connect(t.SignalDone,this.__cbani_end,this),i.bind(n).play(this.reverse)}0==this._ani_cnt&&(this.signals.emit(t.SignalDone),this.drop())},n.prototype.__cbani_end=function(){++this._ani_step,this._ani_step==this._ani_cnt&&(this.appear&&(this.appear.signals.disconnect(t.SignalDone,this.__cbani_end,this),this.appear.unbindAll()),this.disappear&&(this.disappear.signals.disconnect(t.SignalDone,this.__cbani_end,this),this.disappear.unbindAll()),this.signals.emit(t.SignalDone),this.drop())},n}(t.SObject);t.Transition=o}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.rootPopable=!1,n._opers=new t.OperationQueue,n._views=new Array,n}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalSelectionChanged)},n.prototype.dispose=function(){t.ArrayT.Clear(this._views,function(t){0==t.isnull()&&null==t.obj.parent&&t.drop()},this),this._topView=null,e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"topView",{get:function(){return this._topView},set:function(e){t.fatal("请使用index来设置当前页面")},enumerable:!0,configurable:!0}),n.prototype.setTopView=function(e,n){if(void 0===n&&(n=!0),null==e)return null;if(t.ISDEBUG&&-1==this._views.indexOf(e))return t.fatal("不能设置一个不属于当前Stack的页面为 Top"),null;var i,r=this._topView?this._topView.obj:null;return e.isnull()?(i=e.obj,this._addPage(e,!0)):(i=e.obj,null==i.parent?this.addChild(i):i.setNeedsAppear()),this._topView=e,this.swapPages(i,r,n),r},n.prototype.swapPages=function(e,n,i){var r=this;if(e.updateData(),this.setPageFrame(e),e.visible=!0,n){this._emitSelectionChanged(e,n),e.signals.emit(t.SignalSelected);var o=void 0;o=n==e?function(){r._opers.next()}:function(){n.visible=!1,n.onDisappeared(),n.signals.emit(t.SignalDeselected),r._opers.next()},i?n==e?this.transiting(null,e,!1,o):this.transiting(n,e,!1,o):o()}else this._emitSelectionChanged(e,n),e.signals.emit(t.SignalSelected),this._opers.next()},n.prototype._emitSelectionChanged=function(e,n){this._signals&&this._signals.emit(t.SignalSelectionChanged,{now:e,old:n})},n.prototype.removeChild=function(n){n==this._topView&&(this._views.length>1&&t.warn("直接移除 topView 会对 ViewStack 产生风险"),this._topView=void 0),e.prototype.removeChild.call(this,n)},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this._topView&&this.setPageFrame(this._topView.obj)},n.prototype.setPageFrame=function(t){var e=this.bounds();t.frame=e},n.prototype.setViews=function(t){var e=this;t!=this._views&&(this.clear(),t.forEach(function(t){if(e._views.push(t),0==t.isnull()){var n=t.obj;n.visible=!1,e._addPage(t,!1)}},this))},n.prototype.push=function(e,n){return void 0===n&&(n=!0),null==e?(t.warn("不能推入一个null页面"),!1):t.ArrayT.Contains(this._views,e)?(t.warn("不能重复推入页面"),!1):(this._opers.add(new t.OperationCall(this._doPush,this,[e,n])),!0)},n.prototype._doPush=function(t,e){void 0===e&&(e=!0),this._views.push(t);var n=t.obj,i=this._topView?this._topView.obj:null;this._addPage(t,!0),this._topView=t,this.swapPages(n,i,e)},n.prototype._addPage=function(e,n){var i=e.obj;i.viewStack=this,i.signals.register(t.SignalSelected),i.signals.register(t.SignalDeselected),n&&this.addChild(i)},n.prototype.pop=function(e,n){if(void 0===e&&(e=null),void 0===n&&(n=!0),0==this._views.length)return!1;if(!this.rootPopable&&1==this._views.length)return!1;null==e&&(e=this.topView);var i=this._views.indexOf(e);return-1==i?(t.fatal("不能弹出不属于Stack的页面"),!1):(this._opers.add(new t.OperationCall(this._doPop,this,[e,n])),!0)},n.prototype._doPop=function(e,n){var i=this,r=this._views.indexOf(e),o=e.obj;if(this.topView==e){this._topView=this._views[r-1];var s=void 0;this._topView&&(s=this._topView.obj,s.visible=!0,s.setNeedsAppear(),this._emitSelectionChanged(s,null),s.signals.emit(t.SignalSelected));var a=function(){o.onDisappeared(),o.signals.emit(t.SignalDeselected),i.removeChild(o),i._opers.next()};n?this.transiting(o,s,!0,a):a()}else this.removeChild(o),this._opers.next();t.ArrayT.RemoveObjectAtIndex(this._views,r)},n.prototype.popTo=function(e,n){void 0===n&&(n=!0);var i,r;"number"==typeof e?(i=e,r=this._views[i]):(r=e,i=this._views.indexOf(r));var o=this._views.indexOf(this._topView);return 0>i||i>=o||null==r?!1:(this._opers.add(new t.OperationCall(this._doPopTo,this,[i,o,n])),!0)},n.prototype._doPopTo=function(e,n,i){var r=this;void 0===i&&(i=!0),t.ArrayT.RemoveObjectsByFilter(this._views,function(i,o){if(o>e&&n>o){var s=i.obj;return s.onDisappeared(),s.signals.emit(t.SignalDeselected),r.removeChild(s),!0}return!1},this),this._doPop(this._topView,i)},n.prototype.popToRoot=function(t){void 0===t&&(t=!0),this.popTo(0,t)},n.prototype.clear=function(){var e=this;t.ArrayT.Clear(this._views,function(t){0==t.isnull()&&(null==t.obj.parent?t.drop():e.removeChild(t.obj))},this),this._topView=null},n.prototype.transiting=function(e,n,i,r,o){var s=this,a=this.transitionObject,c=a?a.appear:null,u=a?a.disappear:null,l=e?e.transitionObject:null;l&&(u=l.disappear);var h=n?n.transitionObject:null;h&&(c=h.appear);var p=new t.Transition(c,u);p.reverse=i;var d=this.touchChildren;return this.touchChildren=!1,p.signals.connect(t.SignalDone,function(){s.touchChildren=d,r&&r.call(o?o:s)},this),p.play(n,e),p},n}(t.Component);t.ViewStack=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype._addPage=function(n,i){var r=this,o=n.obj;o.signals.register(t.SignalRequestClose),o.signals.connect(t.SignalRequestClose,function(){r.pop()},this),e.prototype._addPage.call(this,n,i)},Object.defineProperty(n.prototype,"pages",{get:function(){return this._views},set:function(e){t.fatal("不能直接设置navi的pages")},enumerable:!0,configurable:!0}),n}(t.ViewStack);t.Navigation=e;var n=function(e){function n(n){void 0===n&&(n=t.Animate.Duration);var i=e.call(this)||this,r=new t.Animate;return r.autoReset=!0,r.inTo(n,function(e){e.backMode=!0,e.stranslate(new t.Point(-1,0))}),i.appear=r,r=new t.Animate,r.autoReset=!0,r.outTo(n,function(e){e.stranslate(new t.Point(-1,0))}),i.disappear=r,i}return __extends(n,e),n}(t.Transition);t.TransitionNavigation=n;var i=function(e){function n(n){void 0===n&&(n=t.Animate.Duration);var i=e.call(this)||this,r=new t.Animate;return r.autoReset=!0,r.inTo(n,function(t){t.backMode=!0,t.fadeIn()}),i.appear=r,r=new t.Animate,r.autoReset=!0,r.outTo(n,function(t){t.fadeOut()}),i.disappear=r,i}return __extends(n,e),n}(t.Transition);t.TransitionFade=i}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.hitTest=function(e,n){return 0==this.touchEnabled?null:t.prototype.hitTest.call(this,e,n)},e}(t.Component);t.Widget=e;var n=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.reuse=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];null==this._reuseUis&&(this._reuseUis=new KvObject);var i=this._reuseUis[e[0]];if(null==i){if(3==e.length)i=e[1].call(e[2]);else if(2==e.length){var r=e[1];i="function"==typeof r?new e[1]:r}i&&(i instanceof t.CComponent&&this.addChild(i),this._reuseUis[e[0]]=i)}return i},n}(t.Component);t.Sprite=n;var i=function(t){function e(e){var n=t.call(this)||this;return e&&(n.contentView=e),n}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this.contentView=null},Object.defineProperty(e.prototype,"contentView",{get:function(){return this._contentView},set:function(t){this._contentView!=t&&(this._contentView&&this.removeChild(this._contentView),this._contentView=t,this._contentView&&this.addChild(this._contentView))},enumerable:!0,configurable:!0}),e.prototype.updateLayout=function(){t.prototype.updateLayout.call(this),this._contentView&&(this._contentView.frame=this.boundsForLayout())},e}(t.Component);t.SpriteWrapper=i}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(n){var i=e.call(this)||this;return i.floatingIdentifier=!0,i._contentOffset=new t.Point,n&&(i.contentView=n),i}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalScrollBegin),this._signals.register(t.SignalScrollEnd),this._signals.register(t.SignalScrolled)},Object.defineProperty(n.prototype,"contentOffset",{get:function(){return this._contentOffset},set:function(t){this.setContentOffset(t,0)},enumerable:!0,configurable:!0}),n.prototype.setContentOffset=function(t,e){this._contentOffset=t},n.prototype.setContentOffsetX=function(e,n){var i=new t.Point(e,this._contentOffset.y);this.setContentOffset(i,n)},n.prototype.setContentOffsetY=function(e,n){var i=new t.Point(this._contentOffset.x,e);this.setContentOffset(i,n)},n.prototype.onPositionChanged=function(){this._signals&&this._signals.emit(t.SignalScrolled)},n.prototype.stopDecelerating=function(){},n.Wrapper=function(e){var n=t.ObjectClass(this),i=new n(e);(e instanceof t.CBitmap||e instanceof t.CLabel)&&e.signals.redirect(t.SignalChanged,t.SignalConstriantChanged);var r=e.bestFrame();return i.contentSize=r.size,e.signals.connect(t.SignalConstriantChanged,function(){var n;if(e instanceof t.CLabel){var r=e,o=i.boundsForContent();n=r.multilines?e.bestFrame(new t.Rect(0,0,o.width,0)):e.bestFrame(new t.Rect(0,0,0,o.height))}else n=e.bestFrame();i.contentSize=n.size},this),i},n}(t.Component);t.CScrollView=e}(nn||(nn={}));var nn;!function(t){var e=function(){function t(){}return t}();e.CENTER="center",e.LEFT="left",e.RIGHT="right",t.TextAlign=e;var n=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalChanged),this._signals.register(t.SignalAction)},n}(t.Widget);n.FontSize=30,t.CLabel=n;var i=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Widget);t.CBitmapLabel=i}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return this.topView.obj},set:function(t){this.push(t)},enumerable:!0,configurable:!0}),e}(t.Navigation);t._GameLayer=e;var n=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Sprite);t._DesktopLayer=n;var i=function(i){function r(){var e=i.call(this)||this;return e.clazzHudText=new t.Class(t.HudText),e.clazzHudProgress=new t.Class(t.HudProgress),e.clazzResourceProgress=new t.Class,e.clazzLoadingScene=new t.Class(t.LoadingScreen),e.reqResources=[],e.url=new t.URL(Js.siteUrl),e.version=t.APPVERSION,e.icon=t.APPICON,e.resourceFile="default.res.json",e.themeFile="default.thm.json",e.dataFile="default.data.js",e.configFile="app.json",e._identifier="::n2",e.fontFamily=t.FontsManager.font("黑体"),e.signals.connect(t.SignalAddedToStage,e.__app_addedtostage,e),e.signals.connect(t.SignalPreTouch,e.__app_pretouch,e),e.signals.connect(t.SignalPreClick,e.__app_preclick,e),t.Device.shared.signals.connect(t.SignalOrientationChanged,e.__app_orientationchanged,e),t.ResManager.directory="resource",e}return __extends(r,i),r.prototype.getReqResources=function(){return this.reqResources},r.prototype._initSignals=function(){i.prototype._initSignals.call(this),this._signals.register(t.SignalLoaded),this._signals.register(t.SignalActivated),this._signals.register(t.SignalDeactivated),this._signals.register(t.SignalFrameChanged),this._signals.register(t.SignalException)},Object.defineProperty(r.prototype,"versioninfo",{get:function(){var e=[this.version];return t.ISDEBUG&&app.debug&&e.push(new t.DateTime(app.debug.BUILDDATE).toString("yyyy/M/d HH:mm:ss")),e.join(" ")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"identifier",{get:function(){return this._identifier},set:function(e){this._identifier!=e&&(this._identifier=e,t.Storage.shared.prefix=e)},enumerable:!0,configurable:!0}),r.prototype.__app_addedtostage=function(){var i=this;t.RESOURCELOADINGISHUD=this.clazzResourceProgress.isEqual(this.clazzHudProgress),this._gameLayer=new e,this._desktopLayer=new n,this.addChild(this._gameLayer),this.addChild(this._desktopLayer);var o=new t.OperationQueue;o.autoMode=!1;var s=new t.OperationGroup;this._preloadConfig(s),o.add(s),o.add(new t.OperationClosure(function(){r.shared=i,t.ResManager.cacheEnabled=t.val(i.config["resource.gc"],!0),t.CTimer.SAFE_TIMER_ENABLED&&(t.CTimer.SAFE_TIMER_ENABLED=!1,t.SetT.Clear(t.CTimer.SAFE_TIMERS,function(t){t.start()})),i.onActivated(),i.backgroundImagePattern&&(t.Dom.style.backgroundImage="url("+t.ResManager.getResUrl(i.backgroundImagePattern)+")");var e=r._OPERATIONS.remove("boot");e&&e.forEach(function(t){t()});var n=new t.svc.LoadingContent(100,100);t.ServicesManager.fetch(n,function(){});var o=document.getElementById("launchDiv");o&&o.parentElement.removeChild(o),i._loadingScreen=i.clazzLoadingScene.instance(),i._loadingScreen.signals.connect(t.SignalDone,i._cbLoadingComplete,i),i._loadingScreen.signals.connect(t.SignalStart,i.onLoadingScreenStart,i),i.addChild(i._loadingScreen)},this)),o.tryrun()},r.prototype.capsules=function(e){var n=[new t.ResourceEntity(t.ResManager.directory+this.dataFile+"?v="+this.version,t.ResType.JSREF)],i=t.ResManager.capsules(e.concat(n));return i.signals.connect(t.SignalDone,function(){var t=r._OPERATIONS.remove("data");t&&t.forEach(function(t){t()})},this),i},r.prototype._preloadConfig=function(e){var n=this;e.add(new t.OperationClosure(function(e){var i=n.resourceFile+"?v="+n.version;t.ResManager.loadConfig(i,function(){e.done()},n)},this)),e.add(new t.OperationClosure(function(e){var i=n.configFile+"?v="+n.version;t.ResManager.getResByUrl(i,t.ResPriority.NORMAL,function(i){n.config=i.val,app.debug.CONFIG?t.ResManager.getResByUrl("~debug.json",t.ResPriority.NORMAL,function(t){var i=t.val;Object.keys(i).forEach(function(t){n.config[t]=i[t]}),e.done()},n,t.ResType.JSON):e.done()},n,t.ResType.JSON)},this))},r.prototype.onLoadingScreenStart=function(){var e=t.ResManager.capsules(this.getReqResources());e.signals.connect(t.SignalChanged,this._cbResLoadChanged,this),e.load(this._cbResLoadCompleted,this)},r.prototype._cbResLoadChanged=function(t){this._loadingScreen.progressValue=t.data},r.prototype._cbResLoadCompleted=function(){this._loadingScreen?this._loadingScreen.complete():this._cbLoadingComplete()},r.prototype._cbLoadingComplete=function(){this.onLoaded(),this._loadingScreen.removeFromParent(),this._loadingScreen=null},r.prototype.onLoaded=function(){t.log("加载应用业务"),this.signals.emit(t.SignalLoaded)},Object.defineProperty(r.prototype,"gameLayer",{get:function(){return this._gameLayer},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"desktopLayer",{get:function(){return this._desktopLayer},enumerable:!0,configurable:!0}),r.prototype.updateLayout=function(){i.prototype.updateLayout.call(this);var t=this.bounds();this._gameLayer.setFrame(t),this._desktopLayer.setFrame(t),this._loadingScreen&&this._loadingScreen.setFrame(t)},Object.defineProperty(r.prototype,"viewStack",{get:function(){return this._gameLayer},set:function(e){t.fatal("不能设置 Application 的 viewStack")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"uniqueId",{get:function(){if(this._uniqueId)return this._uniqueId;var e=t.Storage.shared.value("::n2::app::uid");return null==e?(e=this.generateUniqueId(),t.Storage.shared.set("::n2::app::uid",e),this._uniqueId=e):this._uniqueId=e,this._uniqueId},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"idfa",{get:function(){if(this._idfa)return this._idfa;var e=[navigator.appName,navigator.vendor,navigator.platform,navigator.product];return this._idfa=t.StringT.Hash(e.join("#")).toString(),this._idfa},enumerable:!0,configurable:!0}),r.prototype.uniqueKey=function(t){return this.uniqueId+"/"+t},r.BestFrame=function(){return null},r.Orientation=function(){return"undefined"==typeof document_orientation&&(document_orientation=0),document_orientation},r.ScreenFillMode=function(){return t.FillMode.CENTER},r.ScreenScale=function(){return 1},r.Features=function(){return t.FrameworkFeature.DEFAULT},r.prototype.generateUniqueId=function(){return Js.uuid(16,16)},r.prototype.__app_preclick=function(e){r.NeedFullscreen&&(r.NeedFullscreen=!1,this.enterFullscreen());var n=e.data,i=t.ArrayT.Top(t.Desktop._AllNeedFilters);if(i){var o=t.ArrayT.Top(t.Desktop._AllOpenings);if(i==o){var s=n.positionInView(i),a=i.hitTestInFilters(s);null==a?n.cancel():i.signals.emit(t.SignalHitTest,a)}}},r.prototype.__app_pretouch=function(e){var n=e.data,i=t.ArrayT.Top(t.Desktop._AllNeedFilters);if(i){var r=t.ArrayT.Top(t.Desktop._AllOpenings);if(i==r){var o=n.positionInView(i),s=i.hitTestInFilters(o);null==s&&n.cancel()}}},r.prototype.enterFullscreen=function(){t.ISNATIVE||this.isFullscreen||Js.enterFullscreen(document.body)},r.prototype.exitFullscreen=function(){!t.ISNATIVE&&this.isFullscreen&&Js.exitFullscreen()},Object.defineProperty(r.prototype,"isFullscreen",{get:function(){return t.ISNATIVE?!0:Js.isFullscreen()},enumerable:!0,configurable:!0}),r.prototype.onActivated=function(){t.log("应用激活"),t.SoundManager.background._app_actived(),this.isActivating=!0,this.signals.emit(t.SignalActivated)},r.prototype.onDeactived=function(){t.log("应用切换到后台"),t.SoundManager.background._app_deactived(),this.isActivating=!1,this.signals.emit(t.SignalDeactivated)},r.prototype.restart=function(){this.__restarting||(this.__restarting=!0,t.ServicesManager.fetch(new t.svc.LogoutContent))},r.prototype.__app_orientationchanged=function(e){t.log("方向变化")},r.InBoot=function(t){this._OPERATIONS.add("boot",t)},r.InData=function(t){this._OPERATIONS.add("data",t)},r}(t.Sprite);i._OPERATIONS=new t.MultiMap,t.CApplication=i}(nn||(nn={})),function(t){var e;!function(e){function n(t){o.push(t)}function i(){o.forEach(function(t){t()}),o.length=0}var r=function(e,n,i){if(-1!=n.indexOf(location.host+location.pathname)){var r=["遇到一个未处理的错误:",e,n,"L"+i].join("\n");t.ISDEBUG?alert(r):console.warn(r),t.CApplication.shared&&t.CApplication.shared.signals.emit(t.SignalException,new t.Failed(-1,e,n))}};window.onerror=r;var o=new Array;e.InBoot=n,e.InvokeBoot=i}(e=t.loader||(t.loader={}))}(nn||(nn={}));var app;!function(t){var e;!function(t){}(e=t.debug||(t.debug={}))}(app||(app={}));var Js;!function(t){function e(t,e){for(var n=[];e>0;n[--e]=t);return n.join("")}function n(t){for(var e=[],n=t.length,i=0;n>i;++i)e.push(t[i]);return e}function i(t,e){var n;do n=Object.getOwnPropertyDescriptor(t,e),t=t.__proto__;while(null==n&&null!=t);return n}function r(t,e,n,i){var r=Object.getOwnPropertyDescriptor(t,e),o=r.set,s=r.get;r.set=function(t){n.call(null,this,o,t)},r.get=function(){return i.call(null,this,s)},Object.defineProperty(t,e,r)}function o(t,e,i){var r=t[e];t[e]=function(){return i.apply(this,[r].concat(n(arguments)))}}function s(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function a(){var t=document;t.exitFullscreen?t.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitExitFullscreen&&t.webkitExitFullscreen()}function c(){var t=document;return t.isFullScreen?!0:t.mozIsFullScreen?!0:t.webkitIsFullScreen?!0:t.msIsFullScreen?!0:!1}function u(t,e,n){var i=0,r=function(){l(t[i],function(){i++,i>=t.length?e.call(n):r()},this)};r()}function l(t,e,n){var i=document.createElement("script");i.hasOwnProperty("async")&&(i.async=!1),i.src=t;var r=function(){this.removeEventListener("load",r,!1),e.call(n)};i.addEventListener("load",r,!1),document.body.appendChild(i)}function h(t,e,n){var i=0,r=function(){p(t[i],function(){i++,i>=t.length?e.call(n):r()},this)};r()}function p(t,e,n){var i=document.createElement("link");i.hasOwnProperty("async")&&(i.async=!1),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href",t);var r=function(){this.removeEventListener("load",r,!1),e.call(n)};i.addEventListener("load",r,!1),document.body.appendChild(i)}function d(t,e,n){var i=0,r=function(){f(t[i],function(){i++,i>=t.length?e.call(n):r()},this)};r()}function f(t,e,n){0==t[1]?l(t[0],e,n):1==t[1]?p(t[0],e,n):e.call(n)}function g(){var t=[],e=!1;try{var n=null;n.dont.exist+=0}catch(i){var r=window;if(i.stack){for(var o=i.stack.split("\n"),n=0,s=o.length;s>n;n++){var a=o[n].match("at (.+)$");a&&2==a.length&&t.push(a[1])}t.shift(),e=!0}else if(r.opera&&i.message){for(var o=i.message.split("\n"),n=0,s=o.length;s>n;n++)if(o[n].match(/^\s*[A-Za-z0-9\-_\$]+\(/)){var c=o[n];o[n+1]&&(c+=" at "+o[n+1],n++),t.push(c)}t.shift(),e=!0}}if(!e)for(var u=arguments.callee.caller;u;){var l=u.toString(),h=l.substring(l.indexOf("function")+8,l.indexOf(""))||"anonymous";t.push(h),u=u.caller}return t.join("\n")}t.siteUrl=location.href;var _=Date.prototype;_.pattern=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},n={0:"/u65e5",1:"/u4e00",2:"/u4e8c",3:"/u4e09",4:"/u56db",5:"/u4e94",6:"/u516d"};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),/(E+)/.test(t)&&(t=t.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"/u661f/u671f":"/u5468":"")+n[this.getDay()+""]));for(var i in e)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?e[i]:("00"+e[i]).substr((""+e[i]).length)));return t},t.printf=function(){for(var t,n,i,r,o,s=0,a=arguments[s++],c=[],u="";a;){if(n=/^[^\x25]+/.exec(a))c.push(n[0]);else if(n=/^\x25{2}/.exec(a))c.push("%");else{if(!(n=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a)))throw"Huh ?!";if(null==(t=arguments[n[1]||s++])||void 0==t)throw"Too few arguments.";if(/[^s]/.test(n[7])&&"number"!=typeof t)throw"Expecting number but found "+typeof t;switch(n[7]){case"b":t=t.toString(2);break;case"c":t=String.fromCharCode(t);break;case"d":t=parseInt(t);break;case"e":t=n[6]?t.toExponential(n[6]):t.toExponential();break;case"f":t=n[6]?parseFloat(t).toFixed(n[6]):parseFloat(t);break;case"o":t=t.toString(8);break;case"s":t=(t=String(t))&&n[6]?t.substring(0,n[6]):t;break;case"u":t=Math.abs(t);break;case"x":t=t.toString(16);break;case"X":t=t.toString(16).toUpperCase()}t=/[def]/.test(n[7])&&n[2]&&t>=0?"+"+t:t,r=n[3]?"0"==n[3]?"0":n[3].charAt(1):" ",o=n[5]-String(t).length-u.length,i=n[5]?e(r,o):"",c.push(u+(n[4]?t+i:i+t))}a=a.substring(n[0].length)}return c.join("")},t.guid=function(){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},t.uuid=function(t,e){var n,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=[];if(e=e||i.length,t)for(n=0;t>n;n++)r[n]=i[0|Math.random()*e];else{var o;for(r[8]=r[13]=r[18]=r[23]="-",r[14]="4",n=0;36>n;n++)r[n]||(o=0|16*Math.random(),r[n]=i[19==n?3&o|8:o])}return r.join("")},t.getBrowserSize=function(){if(nn.ISNATIVE)return{width:egret_native.EGTView.getFrameWidth(),height:egret_native.EGTView.getFrameHeight()};var t=0,e=0;return document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(t=document.documentElement.clientHeight,e=document.documentElement.clientWidth):document.body&&(document.body.clientWidth||document.body.clientHeight)?document.body.scrollHeight>document.body.clientHeight?(t=document.body.scrollHeight,e=document.body.scrollWidth):(t=document.body.clientHeight,e=document.body.clientWidth):"number"==typeof window.innerWidth&&(t=window.innerHeight,e=window.innerWidth),{width:e,height:t}},t.getScreenSize=function(){if(nn.ISNATIVE)return{width:egret_native.EGTView.getFrameWidth(),height:egret_native.EGTView.getFrameHeight()};if("undefined"==typeof window.screen)return t.getBrowserSize();var e=window.screen.width,n=window.screen.height;return{width:e,height:n}},t.getBrowserOrientation=function(){var e,n=t.getBrowserSize();return e=n.width>=n.height?90:0},t.hashKey=function(t){if(null==t)return null;var e=typeof t;return"string"==e||"number"==e||"function"==e?t:t.hashCode?t.hashCode:t.toString()},_=Object,_.getPropertyDescriptor=i,t.OverrideGetSet=r,t.OverrideFunction=o,t.enterFullscreen=s,t.exitFullscreen=a,t.isFullscreen=c,function(t){"use strict";var e=t.Base64,n="2.1.9",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(t){for(var e={},n=0,i=t.length;i>n;n++)e[t.charAt(n)]=n;return e}(i),o=String.fromCharCode,s=function(t){if(t.length<2){var e=t.charCodeAt(0);return 128>e?t:2048>e?o(192|e>>>6)+o(128|63&e):o(224|e>>>12&15)+o(128|e>>>6&63)+o(128|63&e)}var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return o(240|e>>>18&7)+o(128|e>>>12&63)+o(128|e>>>6&63)+o(128|63&e)},a=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,c=function(t){return t.replace(a,s)},u=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0),r=[i.charAt(n>>>18),i.charAt(n>>>12&63),e>=2?"=":i.charAt(n>>>6&63),e>=1?"=":i.charAt(63&n)];return r.join("")},l=t.btoa?function(e){return t.btoa(e)}:function(t){return t.replace(/[\s\S]{1,3}/g,u)},h=null,p=h?function(t){return(t.constructor===h.constructor?t:new h(t)).toString("base64")}:function(t){return l(c(t))},d=function(t,e){return e?p(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):p(String(t))},f=function(t){return d(t,!0)},g=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),_=function(t){switch(t.length){case 4:var e=(7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3),n=e-65536;return o((n>>>10)+55296)+o((1023&n)+56320);case 3:return o((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return o((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},y=function(t){return t.replace(g,_)},m=function(t){var e=t.length,n=e%4,i=(e>0?r[t.charAt(0)]<<18:0)|(e>1?r[t.charAt(1)]<<12:0)|(e>2?r[t.charAt(2)]<<6:0)|(e>3?r[t.charAt(3)]:0),s=[o(i>>>16),o(i>>>8&255),o(255&i)];return s.length-=[0,0,2,1][n],s.join("")},v=t.atob?function(e){return t.atob(e)}:function(t){return t.replace(/[\s\S]{1,4}/g,m)},b=h?function(t){return(t.constructor===h.constructor?t:new h(t,"base64")).toString()}:function(t){return y(v(t))},S=function(t){return b(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))},w=function(){var n=t.Base64;return t.Base64=e,n};if(t.Base64={VERSION:n,atob:v,btoa:l,fromBase64:S,toBase64:d,utob:c,encode:d,encodeURI:f,btou:y,decode:S,noConflict:w},"function"==typeof Object.defineProperty){var T=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};t.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",T(function(){return S(this)})),Object.defineProperty(String.prototype,"toBase64",T(function(t){return d(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",T(function(){return d(this,!0)}))}}t.Meteor&&(Base64=t.Base64),"undefined"==typeof l&&(l=t.Base64.btoa),"undefined"==typeof v&&(v=t.Base64.atob),"undefined"==typeof c&&(c=t.Base64.utob),"undefined"==typeof y&&(y=t.Base64.btou)}({}),t.loadScripts=u,t.loadScript=l,t.loadStyles=h,t.loadStyle=p,t.loadSources=d,t.loadSource=f,t.stacktrace=g}(Js||(Js={}));var nn;!function(t){var e=function(e){function n(n){var i=e.call(this)||this;return i.fillMode=t.FillMode.STRETCH,i}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalChanged)},n}(t.Widget);t.CBitmap=e}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(e){var n=t.call(this)||this;return n.setContent(e.handle()),n}return __extends(e,t),e.prototype.dispose=function(){this._fmui=void 0},e.prototype._updateContentPosition=function(){t.prototype._updateContentPosition.call(this),this._fmui&&this._fmui.onPositionChanged()},e.prototype.setScrollPosition=function(e,n,i){t.prototype.setScrollPosition.call(this,e,n,i)},e.prototype._onTouchBegin=function(e){t.prototype._onTouchBegin.call(this,e),this._fmui&&this._fmui._onTouchBegin(e)},e.prototype._onTouchMove=function(e){t.prototype._onTouchMove.call(this,e),this._fmui&&this._fmui.onPositionChanged()},e.prototype._onTouchEnd=function(e){t.prototype._onTouchEnd.call(this,e),this._fmui&&this._fmui._onTouchEnd(e)},e.prototype._onScrollStarted=function(){t.prototype._onScrollStarted.call(this),this._fmui&&this._fmui._onScrollStarted()},e.prototype._onScrollFinished=function(){t.prototype._onScrollFinished.call(this),this._fmui&&this._fmui._onScrollFinished()},e}(egret.ScrollView),n=function(n){function i(i){var r=n.call(this,null)||this;return r._contentSize=new t.Size,r._scrollTouching=!1,r.regionBounds=new t.Rect,r._scrollContent=new t.SpriteWrapper,r._scrollView=new e(r._scrollContent),r._scrollView._fmui=r,r._imp.addChild(r._scrollView),i&&(r.contentView=i),r}return __extends(i,n),i.prototype.dispose=function(){this._scrollView.dispose(),n.prototype.dispose.call(this)},Object.defineProperty(i.prototype,"contentEdgeInsets",{get:function(){return this._scrollContent.edgeInsets},set:function(t){this._scrollContent.edgeInsets=t},enumerable:!0,configurable:!0}),i.prototype.updateData=function(){n.prototype.updateData.call(this),this.contentView.updateData()},i.prototype.stopDecelerating=function(){var t=this._scrollView;t._ScrV_Props_._isHTweenPlaying&&(egret.ScrollTween.removeTweens(t),t._ScrV_Props_._isHTweenPlaying=!1,t._ScrV_Props_._hScrollTween=null),t._ScrV_Props_._isVTweenPlaying&&(egret.ScrollTween.removeTweens(t),t._ScrV_Props_._isVTweenPlaying=!1,t._ScrV_Props_._vScrollTween=null)
},i.prototype.updateLayout=function(){var e=this;n.prototype.updateLayout.call(this);var i=this.bounds();if(0==this.floatingIdentifier){if(this._verticalIdentifier){var r=this._verticalIdentifier.bestFrame();i.width-=Math.abs(r.x)+r.width}if(this._horizonIdentifier){var r=this._horizonIdentifier.bestFrame();i.height-=Math.abs(r.y)+r.height}}var o=new t.HBox(this).setRect(this.bounds());if(o.addFlexVBox(1,function(t){if(e._horizonIdentifier){var n=e._horizonIdentifier.bestFrame();t.addFlex(1),t.addPixel(n.height,e._horizonIdentifier)}}),this._verticalIdentifier){var r=this._verticalIdentifier.bestFrame();o.addPixel(r.width,this._verticalIdentifier)}o.apply(),i.applyEdgeInsets(this.edgeInsets),this.regionBounds.setSize(i.width,i.height),this.impSetFrame(i,this._scrollView),this._scrollView.mask=new egret.Rectangle(0,0,200,200)},i.prototype.boundsForContent=function(){return this.bounds().applyEdgeInsets(this.contentEdgeInsets)},i.prototype.addChild=function(t){return this.contentView.addChild(t)},i.prototype.removeChild=function(t){this.contentView.removeChild(t)},Object.defineProperty(i.prototype,"verticalIdentifier",{get:function(){return this._verticalIdentifier},set:function(t){t!=this._verticalIdentifier&&(this._verticalIdentifier&&n.prototype.removeChild.call(this,this._verticalIdentifier),this._verticalIdentifier=t,t&&(t.touchEnabled=!1,n.prototype.addChild.call(this,t)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizonIdentifier",{get:function(){return this._horizonIdentifier},set:function(t){t!=this._horizonIdentifier&&(this._horizonIdentifier&&n.prototype.removeChild.call(this,this._horizonIdentifier),this._horizonIdentifier=t,t&&(t.touchEnabled=!1,n.prototype.addChild.call(this,t)))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentSize",{get:function(){return this._contentSize.clone()},set:function(e){this._contentSize.copy(e),e.add(t.EdgeInsets.Width(this.contentEdgeInsets),t.EdgeInsets.Height(this.contentEdgeInsets));var n=this.contentOffset,i=e.width-this._contentSize.width;0>i&&n.x+i>=0&&(n.x+=i,this.regionBounds.x=n.x-t.EdgeInsets.Left(this.contentEdgeInsets));var i=e.height-this._contentSize.height;0>i&&n.y+i>=0&&(n.y+=i,this.regionBounds.y=n.y-t.EdgeInsets.Top(this.contentEdgeInsets)),this.contentOffset=n,this._scrollContent.setSize(new t.Size(e.width,e.height)),this._updateIdentifier(),this._signals&&this._signals.emit(t.SignalConstriantChanged)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentView",{get:function(){var e=this._scrollContent.contentView;return null==e&&(e=new t.Sprite,this._scrollContent.contentView=e),e},set:function(t){this._scrollContent.contentView&&(this._scrollContent.contentView.belong=null),this._scrollContent.contentView=t,t&&(t.belong=this)},enumerable:!0,configurable:!0}),i.prototype._updateIdentifier=function(){if(null!=this._verticalIdentifier||null!=this._horizonIdentifier){var e=this.contentSize,n=this.regionBounds;if(this._verticalIdentifier){var i=new t.Percentage(e.height-n.height,n.y);this._verticalIdentifier.progressValue=i}if(this._horizonIdentifier){var i=new t.Percentage(e.width-n.width,n.x);this._horizonIdentifier.progressValue=i}}},i.prototype.onPositionChanged=function(){this._contentOffset.x=this._scrollView.scrollLeft*t.ScaleFactorDeX,this._contentOffset.y=this._scrollView.scrollTop*t.ScaleFactorDeY,this.regionBounds.x=this._contentOffset.x-t.EdgeInsets.Left(this.contentEdgeInsets),this.regionBounds.y=this._contentOffset.y-t.EdgeInsets.Top(this.contentEdgeInsets),this._updateIdentifier(),n.prototype.onPositionChanged.call(this)},i.prototype._onTouchBegin=function(e){this._scrollTouching=!0,this._signals&&this._signals.emit(t.SignalScrollBegin)},i.prototype._onTouchEnd=function(t){},i.prototype._onScrollStarted=function(){},i.prototype._onScrollFinished=function(){0!=this._scrollTouching&&(this._scrollTouching=!1,this._signals&&this._signals.emit(t.SignalScrollEnd))},i.prototype.setContentOffset=function(e,i){n.prototype.setContentOffset.call(this,e,i),0==i?(this._scrollView.scrollLeft=e.x*t.ScaleFactorX,this._scrollView.scrollTop=e.y*t.ScaleFactorY):(this._scrollView.setScrollLeft(e.x*t.ScaleFactorX,1e3*i),this._scrollView.setScrollTop(e.y*t.ScaleFactorY,1e3*i))},i}(t.CScrollView);t.ScrollView=n}(nn||(nn={}));var nn;!function(t){function e(t){if(null==t)return null;var e=t.prototype;return e?e:t.__proto__}function n(t){return null==t?Object:e(t).constructor}function i(t){return e(t).__class__}function r(t){return e(e(t))}function o(t,n){for(var i=e(t),r=e(n);i&&i!=r;)i=e(i);return!(!i||i!=r)}function s(e,n){var i=n.length;return 0==i?new e:1==i?new e(n[0]):2==i?new e(n[0],n[1]):3==i?new e(n[0],n[1],n[2]):4==i?new e(n[0],n[1],n[2],n[3]):5==i?new e(n[0],n[1],n[2],n[3],n[4]):6==i?new e(n[0],n[1],n[2],n[3],n[4],n[5]):7==i?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6]):8==i?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]):9==i?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8]):10==i?new e(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9]):(t.fatal("Typescript没有对 "+i+" 个参数的的 NewObject 实现"),null)}function a(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var r=n(t);return s(r,e)}function c(t,n){return e(t)[n]!=r(t)[n]}function u(t,n){return void 0!=e(t)[n]}function l(t,n){return e(t)[n]}function h(t){return new y(t)}function p(e,n,i){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var s=t.ArrayT.Concat(r,i);return e.apply(n,s)}function d(e,n,i,r){var o=t.ArrayT.Concat(i,r);return e.apply(n,o)}function f(t){return t()}var g=function(){function t(){}return t}();t.ObjectReference=g,t.ObjectClass=n,t.Classname=i,t.SuperClass=r,t.IsInherit=o,t.NewObject=s,t.InstanceNewObject=a,t.MethodIsOverrided=c,t.HasMethod=u,t.Method=l;var _=function(){function t(t){this.type=t}return t.prototype.instance=function(){return null==this.type?null:new this.type},t.prototype.isEqual=function(t){return this.type==t.type},t}();t.Class=_;var y=function(){function e(t){"function"==typeof t?this._clazz=t:this._obj=t}return e.prototype.drop=function(){this._obj=t.drop(this._obj)},Object.defineProperty(e.prototype,"obj",{get:function(){if(null==this._obj){var t=this._clazz;this._obj=new t}return this._obj},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"clazz",{get:function(){return this._clazz},enumerable:!0,configurable:!0}),e.prototype.isnull=function(){return null==this._obj?!0:1==this._obj.__disposed?!0:!1},e}();t.Instance=y,t.New=h;var m=function(){function t(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.cb=t,this.ctx=e,this.argus=n}return t.prototype.dispose=function(){this.cb=void 0,this.ctx=void 0,this.argus=void 0},t.prototype.invoke=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.cb?this.cb.apply(this.ctx,t?t:this.argus):void 0},t.prototype.reset=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];this.cb=t,this.ctx=e,this.argus=n},t}();t.Closure=m,t.Invoke1=p,t.Invoke2=d,t.call=f}(nn||(nn={}));var tmp;!function(t){function e(){return"__rt"+n++}var n=0;t.rtname=e}(tmp||(tmp={})),"undefined"==typeof document_class&&(document_class="Main");var nn;!function(nn){var EgretApp=function(t){function e(){var e=t.call(this)||this;return egret.MainContext.instance.stage.addEventListener(egret.Event.ACTIVATE,e.onActivated,e),egret.MainContext.instance.stage.addEventListener(egret.Event.DEACTIVATE,e.onDeactived,e),e}return __extends(e,t),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return egret.TextField.default_fontFamily},set:function(t){egret.TextField.default_fontFamily=t},enumerable:!0,configurable:!0}),e}(nn.CApplication);nn.EgretApp=EgretApp,nn.EUI_MODE=!1;var CLAZZ_MAIN,_CloakMain=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(nn.CApplication),_InstrumentObject=function(t){function e(){var e=t.apply(this,arguments)||this;return e.totalTime=0,e.lastTime=0,e.totalTick=0,e.drawCalls=0,e}return __extends(e,t),e.prototype.update=function(t,e,n,i){var r=egret.getTimer();this.totalTime+=r-this.lastTime,this.lastTime=r,this.totalTick++,this.drawCalls=Math.max(t,this.drawCalls),this.totalTime>500&&(nn.COLLECT_FPS=Math.round(1e3*this.totalTick/this.totalTime),nn.COLLECT_COST=n,nn.COLLECT_DRAWS=t,nn.COLLECT_DIRTYR=e,nn.Instrument.shared.updateData(),this.totalTick=0,this.totalTime=0,this.drawCalls=0)},e}(egret.DisplayObject),_Player=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.start=function(){t.prototype.start.call(this)},e.prototype.$render=function(e,n){t.prototype.$render.call(this,e,n)},e}(egret.sys.Player);egret.sys.Player=_Player;var _AppStage=function(_super){function _AppStage(){var t=_super.call(this)||this;return _AppStage.shared=t,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.__stage_added,t),nn.FramesManager.launch(t),t}return __extends(_AppStage,_super),_AppStage.prototype.__stage_added=function(){var t=new CLAZZ_MAIN;this.appMain=t,this.addChild(t.handle()),egret.MainContext.instance.stage.setContentSize(_AppStage.StageBounds.width,_AppStage.StageBounds.height);var e=document.querySelector(".egret-player");if(e){var n=e.children[0];nn.DomScaleFactorX=n.clientWidth/nn.toInt(n.getAttribute("width")),nn.DomScaleFactorY=n.clientHeight/nn.toInt(n.getAttribute("height")),nn.DomOffsetX=n.offsetLeft,nn.DomOffsetY=n.offsetTop}this.updateLayout()},_AppStage.Init=function(){CLAZZ_MAIN=eval("Main");var features=CLAZZ_MAIN.Features();nn.Mask.isset(nn.FrameworkFeature.MULTIRES,features)&&(nn.ResManager.multiRes=!0),nn.Device.shared.isAndroid&&nn.Mask.isset(nn.FrameworkFeature.NOSYNC,features)?_AppStage.Fps=0:_AppStage.Fps=30,nn.Mask.isset(nn.FrameworkFeature.FULLSCREEN,features)&&(nn.CApplication.NeedFullscreen=!0),_AppStage.UpdateBounds()},_AppStage.UpdateBounds=function(){document_orientation=CLAZZ_MAIN.Orientation(),nn.Device.shared._updateScreen(),nn.Dom.updateBounds(),this.ScreenBounds=nn.Device.shared.screenBounds,this.DesignBounds=CLAZZ_MAIN.BestFrame(),null==this.DesignBounds&&(this.DesignBounds=this.ScreenBounds.clone());var t=this.DesignBounds.clone(),e=CLAZZ_MAIN.ScreenFillMode();if(this.ScreenScale=nn.ISHTML5?CLAZZ_MAIN.ScreenScale():1,nn.Device.shared.isPurePC&&(e=nn.FillMode.CENTER,this.ScreenScale=1),t.fill(this.ScreenBounds,e),t.width>t.height){t.width/t.height;(nn.Mask.isset(nn.FillMode.MAXIMUM,e)?t.width>800:t.width<800)&&(t.height*=800/t.width,t.width=800)}else{t.height/t.width;(nn.Mask.isset(nn.FillMode.MAXIMUM,e)?t.height>800:t.height<800)&&(t.width*=800/t.height,t.height=800)}t.scale(this.ScreenScale).integral(),this.StageBounds=new nn.Rect(0,0,t.width,t.height);var n=nn.Rect.Area(t)/nn.Rect.Area(this.DesignBounds);n>=3?nn.Device.shared.screenType=nn.ScreenType.EXTRAHIGH:n>=1.5?nn.Device.shared.screenType=nn.ScreenType.HIGH:.3>=n?nn.Device.shared.screenType=nn.ScreenType.EXTRALOW:.75>=n?nn.Device.shared.screenType=nn.ScreenType.LOW:nn.Device.shared.screenType=nn.ScreenType.NORMAL,(e&nn.FillMode.MASK_MAJOR)==nn.FillMode.CENTER?(nn.ScaleFactorX=nn.ScaleFactorY=this.ScreenScale,nn.ScaleFactorW=nn.ScaleFactorH=this.ScreenScale,nn.Mask.isset(nn.FillMode.NOBORDER,e)?(nn.StageScaleFactorX=t.width/this.DesignBounds.width/this.ScreenScale,nn.StageScaleFactorY=t.height/this.DesignBounds.height/this.ScreenScale):(nn.StageScaleFactorX=this.ScreenScale,nn.StageScaleFactorY=this.ScreenScale)):(nn.ScaleFactorX=t.width/this.DesignBounds.width,nn.ScaleFactorY=t.height/this.DesignBounds.height,(e&nn.FillMode.MASK_MAJOR)==nn.FillMode.STRETCH?(nn.ScaleFactorW=nn.ScaleFactorX,nn.ScaleFactorH=nn.ScaleFactorY):nn.ScaleFactorW=nn.ScaleFactorH=Math.min(nn.ScaleFactorX,nn.ScaleFactorY),nn.StageScaleFactorX=this.ScreenScale,nn.StageScaleFactorY=this.ScreenScale),nn.ScaleFactorDeX=1/nn.ScaleFactorX,nn.ScaleFactorDeY=1/nn.ScaleFactorY,nn.ScaleFactorDeW=1/nn.ScaleFactorW,nn.ScaleFactorDeH=1/nn.ScaleFactorH,nn.ScaleFactorS=Math.min(nn.ScaleFactorW,nn.ScaleFactorH),nn.ScaleFactorDeS=1/nn.ScaleFactorS,nn.StageBounds.reset(0,0,t.width*nn.ScaleFactorDeW,t.height*nn.ScaleFactorDeH).integral(),egret.MainContext.instance.stage&&egret.MainContext.instance.stage.setContentSize(this.StageBounds.width,this.StageBounds.height)},_AppStage.prototype.updateLayout=function(){this.appMain.setFrame(nn.StageBounds)},_AppStage}(egret.Sprite);Js.OverrideFunction(egret,"updateAllScreens",function(t){null!=CLAZZ_MAIN&&(nn.Keyboard.visible||(nn.log("尺寸改变"),_AppStage.UpdateBounds(),_AppStage.shared.updateLayout(),nn.emit(nn.CApplication.shared,nn.SignalFrameChanged),t.call(this)))}),Js.OverrideFunction(egret,"getDefinitionByName",function(t,e){return"Main"==e?_AppStage:t(e)});var ExtScreenAdapter=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.calculateStageSize=function(e,n,i,r,o){return nn.Device.shared.isPurePC?t.prototype.calculateStageSize.call(this,e,n,i,r,o):t.prototype.calculateStageSize.call(this,e,n,i,_AppStage.StageBounds.width,_AppStage.StageBounds.height)},e}(egret.sys.DefaultScreenAdapter);egret.sys.screenAdapter=new ExtScreenAdapter,nn.loader.webstart=function(){nn.loader.InvokeBoot(),_AppStage.Init();var t=!1;if(-1!=location.href.indexOf("nowebgl=1")?t=!1:-1!=location.href.indexOf("webgl=1")&&(t=!0),t){var e=navigator.userAgent;-1!=e.indexOf("UCBrowser")&&(t=!1)}t?egret.runEgret({renderMode:"webgl"}):egret.runEgret(),"webgl"==egret.Capabilities.renderMode&&(egret.MainContext.instance.stage.dirtyRegionPolicy=egret.DirtyRegionPolicy.OFF,nn.Device.shared.isCanvas=!1)},nn.loader.nativestart=function(){_AppStage.Init(),egret.runEgret()},nn.loader.runtimestart=function(){_AppStage.Init(),egret.runEgret()}}(nn||(nn={}));var egret;!function(t){function e(t,e,n){return 1e4*t+100*e+n}t.VERSION=40001,t.MAKE_VERSION=e}(egret||(egret={}));var nn;!function(t){t.ERROR_NETWORK_FAILED=-4294967294;var e=function(e){function n(){var n=e.call(this)||this;return n.action="",n.params=new KvObject,n.withCredentials=!0,n.method=t.HttpMethod.GET,n.isDebug=!1,n.showError=!0,n.timeout=0,n}return __extends(n,e),n.prototype.dispose=function(){this.response=void 0,t.MapT.Clear(this.params),e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalEnd),this._signals.register(t.SignalSucceed),this._signals.register(t.SignalFailed),this._signals.register(t.SignalTimeout)},n.prototype.keyForCache=function(){return this.host+"|"+this.action+"|"+JSON.stringify(this.paramsForCache())},n.prototype.paramsForCache=function(){return this.params},n.prototype.valueForCache=function(){return this.response},Object.defineProperty(n.prototype,"modelcallback",{get:function(){return this._modelcallback},set:function(t){this._modelcallback=t,this.params.modelcallback=t},enumerable:!0,configurable:!0}),n.prototype.iscross=function(){return this.useproxy()?!1:-1==this.host.indexOf(n.HTTP)&&-1==this.host.indexOf(n.HTTPS)},n.prototype.useproxy=function(){return t.ISDEBUG},n.prototype.url=function(){return this.host+this.action},n.prototype.fields=function(){return this.params},n.prototype.isSucceed=function(){return 0===this.code},n.prototype.serialize=function(t){return!1},n.prototype.unserialize=function(t){return!0},n.prototype.urlForLog=function(){return this.url()},n.prototype.fieldsForLog=function(){return this.fields()},n.prototype.__mdl_start=function(){if(t.VERBOSE){var e=this.urlForLog(),n=this.fieldsForLog();0==t.MapT.IsEmpty(n)&&(e+=" >> "+t.URL.MapToField(n)),t.log("API "+this.action+" 请求 "+e)}this.showWaiting&&t.Hud.ShowProgress(),this.timeout&&(this._tmr_timeout=t.Delay(this.timeout,this.__mdl_timeout,this)),this.signals.emit(t.SignalStart)},n.prototype.__mdl_completed=function(e){var n=this._urlreq?this._urlreq.data:e;if("string"==typeof n)try{this.response=JSON.parse(n)}catch(i){t.exception(i)}else this.response=n;this.processResponse(),this.__mdl_end()},n.prototype.__mdl_failed=function(e){this.code=t.ERROR_NETWORK_FAILED;var n=new t.SlotTunnel;if(this.signals.emit(t.SignalFailed,e.data,n),n.veto||t.RestSession.signals.emit(t.SignalFailed,this,n),!n.veto){var i=t.ISDEBUG?"API "+this.action+" 请求服务器失败":"请检查网络设置";t.Hud.Error(i)}this.__mdl_end()},n.prototype.__mdl_timeout=function(){t.VERBOSE&&t.log("API "+this.action+" 超时"),this.isDebug?(this.signals.emit(t.SignalSucceed),t.RestSession.signals.emit(t.SignalSucceed,this)):(this.timeoutAsFailed&&(this.signals.emit(t.SignalFailed),t.RestSession.signals.emit(t.SignalFailed,this)),this.signals.emit(t.SignalTimeout),t.RestSession.signals.emit(t.SignalTimeout,this)),this.__mdl_end()},n.prototype.__mdl_end=function(){this.clear(),this.signals.emit(t.SignalEnd),t.RestSession.signals.emit(t.SignalEnd,this),this.showWaiting&&t.Hud.HideProgress(),this.drop()},n.prototype.processResponse=function(){if("code"in this.response?this.code=this.response.code:"1"in this.response?this.code=this.response[1]:this.code=-1,"message"in this.response?this.message=this.response.message:"2"in this.response?this.message=this.response[2]:this.message="从服务器没有获取到数据",t.VERBOSE&&t.log("API "+this.action+" 返回 "+JSON.stringify(this.response)),this.cacheUpdated=!1,this.succeed=this.isSucceed())t.VERBOSE&&t.log("API "+this.action+" 请求成功"),this.cacheTime&&this.cacheFlush&&(this.cacheUpdated=!0,t.Memcache.shared.cache(this)),this.unserialize(this.response),this.signals.emit(t.SignalSucceed),t.RestSession.signals.emit(t.SignalSucceed,this);else{t.warn("API "+this.action+" "+this.message);var e=new t.SlotTunnel;this.isDebug?(this.signals.emit(t.SignalSucceed),t.RestSession.signals.emit(t.SignalSucceed,this)):(this.signals.emit(t.SignalFailed,this,e),e.veto||t.RestSession.signals.emit(t.SignalFailed,this,e)),!e.veto&&this.showError&&this.message&&t.Hud.Error(this.message)}},n.prototype.clear=function(){this._urlreq=t.drop(this._urlreq),this._urlreq=void 0,this._tmr_timeout&&(this._tmr_timeout.stop(),this._tmr_timeout=void 0)},n}(t.SObject);e.HTTP="http://"+document.domain,e.HTTPS="https://"+document.domain,t.Model=e;var n=function(){function e(){this.page=0,this._items=new t.IndexedMap}return e.prototype.add=function(t,e){this.changed=!1,this._items.contains(t)||0!=e.length&&(this.changed=!0,this._items.add(t,e),this.page=t)},Object.defineProperty(e.prototype,"items",{get:function(){return this._items.objectForKey(this.page)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allItems",{get:function(){var e=[];return this._items.forEach(function(n,i){t.ArrayT.PushObjects(e,i)}),e},enumerable:!0,configurable:!0}),e.prototype.previous=function(){var t=this._items.indexOfKey(this.page);return 0==t?!1:(this.page=this._items.keyForIndex(t-1),!0)},e.prototype.next=function(){var t=this._items.indexOfKey(this.page),e=this._items.keyForIndex(t+1);return null==e?!1:(this.page=e,!0)},e}();t.PagedModel=n}(nn||(nn={}));var nn;!function(t){t.DATAUPDATE=!0;var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.FromItem=function(e){return t.findParentByType(e,n)},Object.defineProperty(n.prototype,"item",{get:function(){return this._item},set:function(t){this._item!=t&&(this._item&&this.removeChild(this._item),this._item=t,this._item&&this.addChild(this._item))},enumerable:!0,configurable:!0}),n.prototype.updateData=function(){e.prototype.updateData.call(this),this._item&&this._item.updateData&&this._item.updateData()},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this._item&&(this._item.frame=this.boundsForLayout())},Object.defineProperty(n.prototype,"row",{get:function(){return this._row},set:function(e){t.warn("不能直接设置cell的行号")},enumerable:!0,configurable:!0}),n}(t.Sprite);t.TableViewCell=e;var n=function(n){function i(){var t=n.call(this)||this;return t.reuseMode=!0,t.cellClass=e,t.spacing=0,t._usedCells=new Array,t._unusedCells=new Array,t._rowHeights=new Array,t._reuseItems=new KvObject,t}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this),this._signals.register(t.SignalItemChanged)},i.prototype.dispose=function(){var e=this;this.dataSource=void 0,t.ArrayT.Clear(this._unusedCells,function(e){t.drop(e)},this),t.MapT.Clear(this._reuseItems,function(n,i){t.ArrayT.Clear(i,function(e){t.drop(e)},e)},this),n.prototype.dispose.call(this)},i.prototype.updateLayout=function(){n.prototype.updateLayout.call(this),this.reloadData()},Object.defineProperty(i.prototype,"headerEdgeInsets",{get:function(){return this._headerEdgeInsets},set:function(t){this._headerEdgeInsets=t,this._updateEdgeInsets()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footerEdgeInsets",{get:function(){return this._footerEdgeInsets},set:function(t){this._footerEdgeInsets=t,this._updateEdgeInsets()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"additionEdgeInsets",{get:function(){return this._additionEdgeInsets},set:function(t){this._additionEdgeInsets=t,this._updateEdgeInsets()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topIdentifierEdgeInsets",{get:function(){return this._topIdentifierEdgeInsets},set:function(t){this._topIdentifierEdgeInsets=t,this._updateEdgeInsets()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomIdentifierEdgeInsets",{get:function(){return this._bottomIdentifierEdgeInsets},set:function(t){this._bottomIdentifierEdgeInsets=t,this._updateEdgeInsets()},enumerable:!0,configurable:!0}),i.prototype._updateEdgeInsets=function(){var e=new t.EdgeInsets;e.addEdgeInsets(this._headerEdgeInsets),e.addEdgeInsets(this._footerEdgeInsets),e.addEdgeInsets(this._additionEdgeInsets),e.addEdgeInsets(this._topIdentifierEdgeInsets),e.addEdgeInsets(this._bottomIdentifierEdgeInsets),this.contentEdgeInsets=e},i.prototype.clear=function(){var e=this;return this.stopDecelerating(),this.horizonMode?this.setContentOffsetX(0,0):this.setContentOffsetY(0,0),0==this.reuseMode?void t.ArrayT.Clear(this._usedCells,function(t){e.removeChild(t)},this):void t.ArrayT.Clear(this._usedCells,function(t){var n=t.item;e.addOneReuseItem(n),t.item=null,t.visible=!1,t._row=void 0,e._unusedCells.push(t)},this)},i.prototype.reloadData=function(){var e=this.dataSource.numberOfRows();if(e<this._usedCells.length)for(var n=this._usedCells.length-e;n>0;--n)this.popUsedCell();var i=0;t.DATAUPDATE=!1;var r=this.useCell(void 0),o=this.boundsForContent();this.horizonMode?r.frame=new t.Rect(0,0,0,o.height):r.frame=new t.Rect(0,0,o.width,0);for(var n=0;e>n;++n){var s=this.dataSource.classForRow(n),a=0;if(t.MethodIsOverrided(s,"bestFrame")){var c=this.getOneReuseItem(s);r._item=c,this.updateRow(c,r,n),r.updateLayout();var u=c.bestFrame();a=this.horizonMode?u.width:u.height,r._item=null,this.addOneReuseItem(c)}else a=this.dataSource.heightForRow(n);a+=this.spacing,this._rowHeights[n]=a,i+=a}this.unuseCell(r),t.DATAUPDATE=!0;var l=this.contentSize;this.horizonMode?(l.width=i,l.height=o.height):(l.height=i,l.width=o.width),this.contentSize=l,this._updateValidCells(!0),this._layoutViews()},i.prototype.addOneReuseItem=function(e){var n=t.Classname(e),i=this._reuseItems[n];null==i&&(i=new Array,this._reuseItems[n]=i),i.push(e),t.grab(e)},i.prototype.getOneReuseItem=function(e){var n=t.Classname(e),i=this._reuseItems[n];return i&&0!=i.length?i.pop():this.instanceItem(e)},i.prototype.instanceItem=function(e){var n=new e;return n.signals.connect(t.SignalConstriantChanged,this._updateConstriant,this),n},i.prototype.findCell=function(e){return t.ArrayT.QueryObject(this._usedCells,function(t){return void 0!==e&&e!=t._row?!1:!0},this,null)},i.prototype.scrollToCell=function(e,n,i){void 0===n&&(n=t.CAnimate.Duration),void 0===i&&(i=t.EDGE.START);for(var r=0,o=Math.min(this._rowHeights.length,e),s=0;o>s;++s)r+=this._rowHeights[s];if(i==t.EDGE.MIDDLE){var a=this._rowHeights[e+1];null!=a&&(r+=a/2)}else if(i==t.EDGE.END){var a=this._rowHeights[e+1];null!=a&&(r+=a)}this.scrollToPos(r,n)},i.prototype.scrollToPos=function(e,n){void 0===n&&(n=t.CAnimate.Duration),this.contentEdgeInsets&&(e+=this.contentEdgeInsets.top),this.horizonMode?this.setContentOffsetX(e,n):this.setContentOffsetY(e,n)},Object.defineProperty(i.prototype,"visibledCells",{get:function(){return this._usedCells.sort(function(t,e){return t.row-e.row})},enumerable:!0,configurable:!0}),i.prototype.useCell=function(t){var e;return this._unusedCells.length?e=this._unusedCells.pop():(e=new this.cellClass,this.spacing&&(e.getEdgeInsets().bottom=this.spacing),this.addChild(e)),this._usedCells.push(e),e._row=t,e.visible=void 0!=t,e},i.prototype.unuseCell=function(e){if(0==this.reuseMode)return t.ArrayT.RemoveObject(this._usedCells,e),void this.removeChild(e);var n=e.item;n&&(this.addOneReuseItem(n),e.item=null),e.visible=!1,e._row=void 0,t.ArrayT.RemoveObject(this._usedCells,e),this._unusedCells.push(e)},i.prototype.popUsedCell=function(){var e=this._usedCells.pop();if(0==this.reuseMode)return t.ArrayT.RemoveObject(this._usedCells,e),void this.removeChild(e);var n=e.item;n&&(this.addOneReuseItem(n),e.item=null),e.visible=!1,e._row=void 0,this._unusedCells.push(e)},i.prototype.updateRow=function(t,e,n){this.dataSource.updateRow(t,e,n),e.updateData()},i.prototype._updateConstriant=function(t){var n=t.sender,i=e.FromItem(n);if(null!=i){var r,o=i.row,s=n.bestFrame();r=this.horizonMode?s.width:s.height;var a=r-this._rowHeights[o];if(0!=a){var c=this.contentSize;this.horizonMode?c.width+=a:c.height+=a,this.contentSize=c,this._rowHeights[o]=r,this._updateValidCells(!1),i.setHeight(r),this._layoutViews()}}},i.prototype._updateValidCells=function(e){for(var n=this.boundsForContent(),i=this.dataSource.numberOfRows(),r=this.regionBounds,o=0,s=0,a=0;i>a;++a){var c=this._rowHeights[a];if(void 0==c)return;var u=this.findCell(a);if(this.horizonMode){if(0==t.Range.Intersects(r.x,r.width,o,c)){u&&(++s,this.unuseCell(u)),o+=c;continue}}else if(0==t.Range.Intersects(r.y,r.height,o,c)){u&&(++s,this.unuseCell(u)),o+=c;continue}if(u)this.horizonMode?u.setX(o):u.setY(o),o+=c,this.horizonMode?u.setHeight(n.height):u.setWidth(n.width),e&&this.updateRow(u.item,u,a);else{u=this.useCell(a);var l=this.dataSource.classForRow(a),h=this.getOneReuseItem(l);u.item=h,++s,this.updateRow(u.item,u,a),h.frame=t.Rect.Zero,u.frame=t.Rect.Zero,this.horizonMode?u.frame=new t.Rect(o,0,c,n.height):u.frame=new t.Rect(0,o,n.width,c),o+=c}}s&&this._signals&&this._signals.emit(t.SignalItemChanged)},i.prototype.onPositionChanged=function(){n.prototype.onPositionChanged.call(this),this._updateValidCells(!1)},Object.defineProperty(i.prototype,"headerView",{get:function(){return this._headerView},set:function(e){if(e!=this._headerView)if(this._headerView&&this._scrollContent.removeChild(this._headerView),this._headerView=e,e){var n=e.frame;this.horizonMode?(0==n.width&&e.bestFrame&&(n=e.bestFrame()),this.headerEdgeInsets=new t.EdgeInsets(0,0,n.width,0)):(0==n.height&&e.bestFrame&&(n=e.bestFrame()),this.headerEdgeInsets=new t.EdgeInsets(n.height,0,0,0)),this._scrollContent.addChild(e)}else this.headerEdgeInsets=null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footerView",{get:function(){return this._footerView},set:function(e){if(e!=this._footerView)if(this._footerView&&this._scrollContent.removeChild(this._footerView),this._footerView=e,e){var n=e.frame;this.horizonMode?(0==n.width&&e.bestFrame&&(n=e.bestFrame()),this.footerEdgeInsets=new t.EdgeInsets(0,0,0,n.width)):(0==n.height&&e.bestFrame&&(n=e.bestFrame()),this.footerEdgeInsets=new t.EdgeInsets(0,n.height,0,0)),this._scrollContent.addChild(e)}else this.footerEdgeInsets=null},enumerable:!0,configurable:!0}),i.prototype._layoutViews=function(){var e=this.boundsForContent();if(this._headerView){var n=void 0;n=this.horizonMode?new t.Rect(0,0,this._headerEdgeInsets.left,e.height):new t.Rect(0,0,e.width,this._headerEdgeInsets.top),this._headerView.frame=n}if(this._footerView){var n=void 0;this.horizonMode?(n=new t.Rect(0,0,this._footerEdgeInsets.right,e.height),n.rightTop=this._scrollContent.frame.rightTop):(n=new t.Rect(0,0,e.width,this._footerEdgeInsets.bottom),n.leftBottom=this._scrollContent.frame.leftBottom),this._footerView.frame=n}},i}(t.ScrollView);t.TableViewContent=n;var i=function(e){function i(){var t=e.call(this)||this;return t._table=t.instanceTable(),t._table.dataSource=t,t.addChild(t._table),t}return __extends(i,e),i.FromItem=function(e){return t.findParentByType(e,i)},i.prototype.instanceTable=function(){return new n},Object.defineProperty(i.prototype,"table",{get:function(){return this._table},enumerable:!0,configurable:!0}),i.prototype.classForRow=function(t){return this._table.rowClass},i.prototype.heightForRow=function(t){return this._table.rowHeight},i.prototype.updateRow=function(t,e,n){},i.prototype.numberOfRows=function(){return 0},i.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this._table.frame=this.boundsForLayout()},i}(t.Sprite);t.TableView=i}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.eps=3,n.touchEnabled=!0,n.anchor=t.Point.AnchorCC,n}return __extends(n,e),n.prototype._signalConnected=function(n,i){e.prototype._signalConnected.call(this,n,i),n==t.SignalClicked&&(i.eps=this.eps)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalClicked)},n.prototype.isSelection=function(){return this._isSelected},n}(t.Widget);e.STATE_NORMAL="::button::state::normal",e.STATE_DISABLED="::button::state::disable",e.STATE_HIGHLIGHT="::button::state::highlight",e.STATE_SELECTED="::button::state::selected",t.CButton=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(n){var i=e.call(this)||this;return i._bmp=new t.ExtBitmap,i._imageSource=null,i._bmp.width=i._bmp.height=0,i._imp.addChild(i._bmp),n&&(i.imageSource=n,i.setFrame(i.bestFrame())),i}return __extends(n,e),n.prototype.onChangeState=function(t){return null==t?void(this.imageSource=null):void e.prototype.onChangeState.call(this,t)},n.prototype.bestFrame=function(e){if(this.preferredFrame)return this.preferredFrame.clone();var n=this._getTexture();return null==n?new t.Rect:new t.Rect(0,0,n.textureWidth,n.textureHeight)},n.prototype._getTexture=function(){return this._bmp.texture instanceof egret.Texture?this._bmp.texture:null},Object.defineProperty(n.prototype,"imageSource",{get:function(){var e=this._getTexture();return null==e?this._imageSource:(t.COriginType.shared.imp=e,t.COriginType.shared)},set:function(e){var n=this;this._imageSource!=e&&(this._imageSource=e,t.ResManager.getTexture(e,t.ResPriority.NORMAL,function(t){e==n._imageSource&&n._setTexture(t.use())},this))},enumerable:!0,configurable:!0}),n.prototype._setTexture=function(e){this._bmp.scale9Grid=e?e.scale9Grid:null,this._bmp.texture=e,this._signals&&this._signals.emit(t.SignalChanged,e),this.setNeedsLayout()},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this);var t=this,n=t.boundsForLayout();if(0==n.width&&0==n.height){var i=t._bmp;return i.width=i.height=0,void t.updateCache()}var r=t.bestFrame();if(0==r.width||0==r.height)return t.impSetFrame(n,t._bmp),void t.updateCache();r.fill(n,t.fillMode);var o=n.center;t.preferredFrame&&(o.x+=t.preferredFrame.x,o.y+=t.preferredFrame.y),r.center=o,t.impSetFrame(r,t._bmp),t.updateCache()},n}(t.CBitmap);t.Bitmap=e;var n=function(e){function n(n){var i=e.call(this,n)||this;return i.fillMode=t.FillMode.CENTER,i}return __extends(n,e),n}(e);t.Picture=n}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(t.Component);t.CDom=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.replaceArr.push([/\\n/g,"\n"]),t.replaceArr.push([/\\t/g,"	"]),t}return __extends(n,e),n.prototype.parser=function(n){var i=null;try{i=e.prototype.parser.call(this,n)}catch(r){t.exception(r,"HtmlTextParser出错")}return i},n}(egret.HtmlTextParser);t.ExtHtmlTextParser=e;
var n=function(t){function e(){var e=t.call(this)||this;return e.width=0,e.height=0,e}return __extends(e,t),e}(egret.TextField),i=new egret.TextField,r=function(r){function o(){var e=r.call(this)||this;return e._lbl=new n,e._lineSpacing=0,e.fontSize=t.CLabel.FontSize,e._lbl.touchEnabled=!0,e._lbl.verticalAlign=egret.VerticalAlign.MIDDLE,e._imp.addChild(e._lbl),e}return __extends(o,r),o.prototype._signalConnected=function(e,n){r.prototype._signalConnected.call(this,e,n),e==t.SignalAction&&(this.touchEnabled=!0,t.EventHook(this._lbl,egret.TextEvent.LINK,this.__lbl_link,this))},o.prototype.hitTestClient=function(t,e){return r.prototype.hitTestClient.call(this,t,e)?this._imp:null},o.prototype.updateLayout=function(){r.prototype.updateLayout.call(this),this.impSetFrame(this.boundsForLayout(),this._lbl),this._scaleToFit&&this.doScaleToFit(),this.updateCache()},Object.defineProperty(o.prototype,"bold",{get:function(){return this._lbl.bold},set:function(t){this._lbl.bold=t,this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"italic",{get:function(){return this._lbl.italic},set:function(t){this._lbl.italic=t,this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"stroke",{get:function(){return this._lbl.stroke},set:function(t){this._lbl.stroke=t,this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"strokeColor",{get:function(){return this._lbl.strokeColor},set:function(e){this._lbl.strokeColor=t.GetColorComponent(e)[0],this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lineSpacing",{get:function(){return this._lineSpacing*t.ScaleFactorDeS},set:function(e){this._lineSpacing=e*t.ScaleFactorS,this._lbl.lineSpacing=this._lineSpacing,this.updateCache()},enumerable:!0,configurable:!0}),o.prototype.bestFrame=function(e){var n,r=e?e.width:0,o=e?e.height:0;return this._lbl.textFlow?(i.multiline=this._lbl.multiline,i.size=this._lbl.size,i.fontFamily=this._lbl.fontFamily,i.lineSpacing=this._lbl.lineSpacing,i.width=r*t.ScaleFactorW,i.height=o*t.ScaleFactorH,i.textFlow=this._lbl.textFlow,n=new t.Rect(0,0,i.textWidth+1,i.textHeight+1).unapplyScaleFactor()):n=t.Font.sizeFitString(this.text,this.fontSize,r,o,this.lineSpacing).toRect(),this.edgeInsets?n.unapplyEdgeInsets(this.edgeInsets):n},o.prototype._setFontSize=function(e){this._tfnsz!=e&&(this._tfnsz=e*t.ScaleFactorS,this._lbl.size=this._tfnsz,this.updateCache())},Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._lbl.size*t.ScaleFactorDeS},set:function(t){this._setFontSize(t)},enumerable:!0,configurable:!0}),o.prototype._setTextAlign=function(t){this._lbl.textAlign=t,this.updateCache()},o.prototype._setTextSide=function(t){this._lbl.verticalAlign=t,this.updateCache()},Object.defineProperty(o.prototype,"textAlign",{get:function(){return this._lbl.textAlign},set:function(t){this._setTextAlign(t)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"textSide",{get:function(){return this._lbl.verticalAlign},set:function(t){this._setTextSide(t)},enumerable:!0,configurable:!0}),o.prototype._setText=function(t){return this._lbl.text==t?!1:(this._htmlText&&(this._htmlText=void 0),this._lbl.text=t,this._scaleToFit&&this.doScaleToFit(),this.updateCache(),!0)},Object.defineProperty(o.prototype,"text",{get:function(){return this._lbl.text},set:function(e){this._setText(e),this._signals&&this._signals.emit(t.SignalChanged,e)},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"attributedText",{get:function(){return this._lbl.textFlow},set:function(t){this._htmlText=void 0,this._lbl.textFlow=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"htmlText",{get:function(){return this._htmlText},set:function(n){if(this._htmlText!=n&&t.StringT.Count(n,"<")==t.StringT.Count(n,">")){var i=(new e).parser(n);this._setTextFlow(i),this._signals&&this._signals.emit(t.SignalChanged,n)}},enumerable:!0,configurable:!0}),o.prototype._setTextFlow=function(e){e&&e.forEach(function(e){var n=e.style;n&&null!=n.size&&(n.size*=t.ScaleFactorS)}),this._lbl.textFlow=e},Object.defineProperty(o.prototype,"textColor",{get:function(){return this._lbl.textColor},set:function(e){this._lbl.textColor=t.GetColorComponent(e)[0],this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"fontFamily",{get:function(){return this._lbl.fontFamily},set:function(t){this._lbl.fontFamily=t,this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"numlines",{get:function(){return this._lbl.numLines},set:function(t){if(-1==t||t>1){if(this._scaleToFit)return;this._lbl.multiline=!0}else this._lbl.multiline=!1;this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"multilines",{get:function(){return this._lbl.multiline},set:function(t){this._lbl.multiline!=t&&(this._lbl.multiline=t,this.updateCache())},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"textFlow",{get:function(){return this._lbl.textFlow},set:function(t){this._lbl.textFlow=t,this.updateCache()},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"scaleToFit",{get:function(){return this._scaleToFit},set:function(t){t!=this._scaleToFit&&(t&&this._lbl.multiline||(this._scaleToFit=t,t&&this.doScaleToFit()))},enumerable:!0,configurable:!0}),o.prototype.doScaleToFit=function(){var e=this.text;if(0!=e.length){var n=this.boundsForLayout(),i=n.width/e.length*t.ScaleFactorS;i>this._lbl.size?this._lbl.size!=this._tfnsz&&(this._lbl.size=this._tfnsz,this.updateCache()):(this._lbl.size=i,this.updateCache())}},o.prototype.appendText=function(t){this._lbl.appendText(t),this.updateCache()},o.prototype.href=function(e,n,i){null==this._links&&(this._links=new Array,this.touchEnabled=!0,t.EventHook(this._lbl,egret.TextEvent.LINK,this.__lbl_link,this));var r=new t.Closure(n,i);r.payload=e,this._links.push(r)},o.prototype.__lbl_link=function(e){var n=e.text;t.noti("点击链接 "+n),this.signals.emit(t.SignalAction,n),this._links&&this._links.forEach(function(t){var e=t.payload;n.match(e)&&e.invoke(n)})},o}(t.CLabel);t.Label=r}(nn||(nn={}));var nn;!function(t){t.COPYRIGHT="WYBOSYS",t.AUTHOR="WYBOSYS@GMAIL.COM",t.ISHTML5="web"==egret.Capabilities.runtimeType,t.ISNATIVE=!t.ISHTML5;var e=function(){function t(){this.protocol="http:"}return t}(),n=function(){function t(){this.domain="localhost",this.location=new e}return t.prototype.getElementsByTagName=function(t){return[]},t}(),i=function(){function t(){this.platform="native",this.userAgent="Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X; en-us) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53"}return t}();t.ISNATIVE&&"undefined"==typeof document&&(document=new n,navigator=new i),t.ISHTTPS="https:"==document.location.protocol;var r=document.getElementsByTagName("app");if(r.length){r=r[0],t.APPICON=r.getAttribute("icon"),t.APPNAME=r.getAttribute("name");var o=function(t){if(void 0!=t){var e=t.replace(/ /g,"").split(",");e.forEach(function(t){if(-1==t.indexOf("="))this["__tag_"+t]=!0;else{var e=t.split("=");this["__tag_"+e[0]]=e[1]}})}};o(r.getAttribute("content"));for(var s,a,c=r.children,u=0;u<c.length;++u){var l=c[u],h=l.getAttribute("url");h&&document.domain.match(h)?(a=!0,o(l.getAttribute("content"))):void 0==h&&(s=l.getAttribute("content"))}a||o(s)}else if(t.ISNATIVE){var p;(p=egret.getOption("debug"))&&(__tag_debug="true"==p),(p=egret.getOption("verbose"))&&(__tag_verbose="true"==p),(p=egret.getOption("version"))&&(__tag_version=p),(p=egret.getOption("publish"))&&(__tag_publish="true"==p)}else alert("没有配置 app 的基础信息");t.ISDEBUG="undefined"==typeof __tag_debug?!1:__tag_debug,t.VERBOSE="undefined"==typeof __tag_verbose?!1:__tag_verbose,t.APPVERSION="undefined"==typeof __tag_version?"":__tag_version,t.PUBLISH="undefined"==typeof __tag_publish?!1:__tag_publish}(nn||(nn={}));var nn;!function(t){var e;!function(t){t[t.NORMAL=0]="NORMAL",t[t.CLIP=1]="CLIP"}(e=t.ResPriority||(t.ResPriority={})),t.ResCurrentPriority=e.NORMAL;var n;!function(t){t[t.JSON=0]="JSON",t[t.TEXTURE=1]="TEXTURE",t[t.TEXT=2]="TEXT",t[t.FONT=3]="FONT",t[t.SOUND=4]="SOUND",t[t.BINARY=5]="BINARY",t[t.JSREF=6]="JSREF"}(n=t.ResType||(t.ResType={})),t.ResPartKey="::res::part";var i=function(){function e(t,e){this.source=t,this.type=e}return Object.defineProperty(e.prototype,"hashCode",{get:function(){return t.StringT.Hash(this.source+":"+this.type)},enumerable:!0,configurable:!0}),e}();t.ResourceEntity=i;var r=/^([\w]+):\/\/(.+)$/i,o=function(e){function n(t){var n=e.call(this)||this;return n._reqRes=t,n}return __extends(n,e),n.prototype.dispose=function(){this._reqRes=void 0,e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalDone),this._signals.register(t.SignalFailed),this._signals.register(t.SignalChanged)},n.prototype.load=function(e,n){var i=this;if(t.IsEmpty(this._reqRes))return void(e&&e.call(n));if(e&&this.signals.connect(t.SignalDone,e,n),!this._isloading){this._isloading=!0,this._total=this.total(),this._idx=0;var r=0;this._reqRes.forEach(function(e){null!=e&&i.loadOne(e,function(){i._reqRes.length==++r&&(i.grab(),t.ResManager.removeCapsule(i),i._isloading=!1,i.signals.emit(t.SignalDone),i.drop())},i)})}},n.prototype.hashKey=function(){return n.HashKey(this._reqRes)},n.HashKey=function(e){var n=[];return e.forEach(function(t){t instanceof i?n.push(t.hashCode):n.push(t)}),t.StringT.Hash(n.join("::"))},n}(t.SObject);t.CResCapsule=o;var s=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"directory",{get:function(){return this._directory},set:function(e){if(this._directory=e,this.multiRes)switch(t.Device.shared.screenType){case t.ScreenType.NORMAL:break;case t.ScreenType.LOW:this._directory+="_m";break;case t.ScreenType.EXTRALOW:this._directory+="_l";break;case t.ScreenType.EXTRAHIGH:this._directory+="_xh";break;case t.ScreenType.HIGH:this._directory+="_h"}t.PUBLISH&&(t.ISDEBUG||(this._directory=this._directory+"_"+t.APPVERSION)),this._directory+="/"},enumerable:!0,configurable:!0}),i.prototype.getSources=function(e,n,i,r){var o=this;if(0==t.length(e))return void i.call(r,[]);var s=[],a=function(t,c){o.getSourceByType(t[0],n,function(t){s.push(t),++c==e.length?i.call(r,s):a(e[c],c)},o,t[1])};a(e[0],0)},i.prototype.getSourceByType=function(e,i,o,s,a){if(null==e)return void o.call(s,new t.CacheRecord);if(a==n.JSREF)return void t.Scripts.require(e,function(){o.call(s)},this);var c,u=e.split("#");e=u[0],c=u[1];var l=e.match(r);if(null!=l){var h=l[1],p=l[2];if("http"==h||"https"==h)this.getResByUrl(e,i,function(e){e.prop(t.ResPartKey,c),o.call(s,e)},this,a);else if("file"==h)this.getResByUrl(p,i,function(e){e.prop(t.ResPartKey,c),o.call(s,e)},this,a);else if("assets"==h){var d=this.directory+"assets/"+p;this.getResByUrl(d,i,function(e){e.prop(t.ResPartKey,c),o.call(s,e)},this,a)}}else{var f=t.ResManager.tryGetRes(e);null!=f.val?(f.prop(t.ResPartKey,c),o.call(s,f)):t.ResManager.getResAsync(e,i,function(e){e.prop(t.ResPartKey,c),o.call(s,e)},this)}},i.prototype.getJson=function(t,e,i,r){this.getSourceByType(t,e,i,r,n.JSON)},i.prototype.getText=function(t,e,i,r){this.getSourceByType(t,e,i,r,n.TEXT)},i.prototype.getTexture=function(e,i,r,o){if(e instanceof t.COriginType){var s=new t.CacheRecord;return s.val=e.imp,void r.call(o,s)}this.getSourceByType(e,i,r,o,n.TEXTURE)},i.prototype.getBitmapFont=function(e,i,r,o){if(e instanceof t.COriginType){var s=new t.CacheRecord;return s.val=e.imp,void r.call(o,s)}this.getSourceByType(e,i,r,o,n.FONT)},i.prototype.getSound=function(e,i,r,o){if(e instanceof t.COriginType){var s=new t.CacheRecord;return s.val=e.imp,void r.call(o,s)}this.getSourceByType(e,i,r,o,n.SOUND)},i.prototype.getBinary=function(t,e,i,r){this.getSourceByType(t,e,i,r,n.BINARY)},i}(t.SObject);t.CResManager=s;var a=function(){function t(){}return t.normal=function(t){return t.replace("_hl","")},t.hl=function(t){return this.normal(t)+"_hl"},t}();t.ResName=a}(nn||(nn={}));var nn;!function(t){var e;!function(e){var n;!function(t){t[t.SHARE=0]="SHARE",t[t.PAY=1]="PAY",t[t.LOGIN=2]="LOGIN",t[t.SWITCHUSER=3]="SWITCHUSER",t[t.PROFILE=4]="PROFILE",t[t.AUTH=5]="AUTH",t[t.LOGOUT=6]="LOGOUT",t[t.REPORT=7]="REPORT",t[t.LOADING=8]="LOADING",t[t.GETAPP=9]="GETAPP",t[t.BIND=10]="BIND",t[t.SUBSCRIBE=11]="SUBSCRIBE",t[t.DESKTOP=12]="DESKTOP",t[t.BBS=13]="BBS",t[t.STATUS=14]="STATUS",t[t.CUSTOMER=15]="CUSTOMER",t[t.LANZUAN=16]="LANZUAN"}(n=e.Feature||(e.Feature={}));var i;!function(t){t[t.XHB=0]="XHB",t[t.WANBA=1]="WANBA",t[t.QQGAME=2]="QQGAME",t[t.QQBROWSER=3]="QQBROWSER",t[t.X360=4]="X360",t[t.X360ZS=5]="X360ZS",t[t.MOCK=6]="MOCK"}(i=e.Platform||(e.Platform={}));var r=function(){function t(){}return t}();e.Content=r;var o=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="pay",e}return __extends(e,t),e}(r);e.PayContent=o;var s=function(t){function e(){var e=t.apply(this,arguments)||this;return e.url="",e.image="",e.title="",e.detail="",e.proc="share",e}return __extends(e,t),e}(r);e.ShareContent=s;var a=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="login",e}return __extends(e,t),e}(r);e.LoginContent=a;var c=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="profile",e}return __extends(e,t),e}(r);e.ProfileContent=c;var u=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="status",e}return __extends(e,t),e.prototype.excharge=function(t){return null!=this.monetaryDiscount?t*this.monetaryRate*this.monetaryDiscount:t*this.monetaryRate},e}(r);e.StatusContent=u;var l=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="logout",e}return __extends(e,t),e}(r);e.LogoutContent=l;var h=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="switchuser",e}return __extends(e,t),e}(r);e.SwitchUserContent=h;var p=function(t){function e(e,n){var i=t.call(this)||this;return i.proc="loading",i.total=e,i.current=n,i}return __extends(e,t),e}(r);e.LoadingContent=p;var d=function(t){function e(){var e=t.apply(this,arguments)||this;return e.app="",e.pid="",e.channel=0,e.type=0,e.key="",e.ticket="",e.timestamp="",e.nonce="",e.signature="",e.proc="auth",e}return __extends(e,t),e}(r);e.AuthContent=d;var f;!function(t){t[t.LOGIN=0]="LOGIN",t[t.ROLE=1]="ROLE",t[t.UPGRADE=2]="UPGRADE",t[t.PROGRESS=3]="PROGRESS",t[t.SCORE=4]="SCORE"}(f=e.ReportType||(e.ReportType={}));var g=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="report",e}return __extends(e,t),e}(r);e.ReportContent=g;var _=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="bind",e}return __extends(e,t),e}(r);e.BindContent=_;var y=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="bbs",e}return __extends(e,t),e}(r);e.BBSContent=y;var m=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="subscribe",e}return __extends(e,t),e}(r);e.SubscribeContent=m;var v=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="getapp",e}return __extends(e,t),e}(r);e.GetAppContent=v;var b=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="sendtodesktop",e}return __extends(e,t),e}(r);e.SendToDesktopContent=b;var S=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="lanzuan",e}return __extends(e,t),e}(r);e.LanZuanContent=S;var w=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="lanzuanxufei",e}return __extends(e,t),e}(r);e.LanZuanXuFeiContent=w,e.SignalMessagesGot="::nn::service::messages::got",e.SignalStatusChanged="::nn::service::status::changed";var T=function(){function t(){}return t}();e.Message=T;var C=function(t){function e(){var e=t.apply(this,arguments)||this;return e.proc="customer",e}return __extends(e,t),e}(r);e.CustomerContent=C;var O=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e}(C);e.SendCustomerContent=O;var E=function(n){function i(){return n.call(this)||this}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this),this._signals.register(e.SignalMessagesGot),this._signals.register(e.SignalStatusChanged)},i.prototype.support=function(t){return!1},i.prototype.fetch=function(e){var n=this[e.proc];return null==n?void t.fatal("没有找到Service中对应Content的处理方法"):void n.call(this,e)},i.Prepare=function(t,e){t.call(e)},i.prototype.toString=function(){return["id: "+t.ObjectClass(this).ID,"description: "+t.ObjectClass(this).DESCRIPTION.NAME,"class: "+t.Classname(this)].join("\n")},i}(t.SObject);E.ID="",E.QQAPPID="",e.Service=E;var x=function(){function t(){}return t.prototype.next=function(t){this.cb.call(this.ctx,t)},t}();e.Signature=x}(e=t.svc||(t.svc={}))}(nn||(nn={})),function(t){var e=function(e){function n(n){var i=e.call(this,n)||this;return i.signals.register(t.SignalSucceed),i.signals.register(t.SignalFailed),i}return __extends(n,e),n}(t.SObjectWrapper),n=function(n){function i(){var t=n.call(this)||this;return t._service=null,t}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this)},i.prototype.dispose=function(){this._service=t.drop(this._service),n.prototype.dispose.call(this)},i.register=function(t){this._SERVICES.push(t)},i.prototype.bindSignature=function(t,e){this._sigfun=t,this._sigctx=e},i.prototype.signature=function(e,n,i){var r=new t.svc.Signature;r.content=e,r.cb=n,r.ctx=i,this._sigfun.call(this._sigctx,r)},Object.defineProperty(i.prototype,"service",{get:function(){return this._service},enumerable:!0,configurable:!0}),i.support=function(t){return this._shared._service.support(t)},i.fetch=function(){var e,n,i=this,r=arguments,o=r[0],s=r[1];"function"==typeof r[2]?(e=r[2],n=r[3]):(e=null,n=r[2]);var a=t.ObjectClass(this._shared._service);a.prepared?this.doFetch(o,s,e,n):a.Prepare(function(){a.prepared=!0,i.doFetch(o,s,e,n)},this)},i.doFetch=function(n,i,r,o){new e(n),o&&n.attach(o),i&&n.signals.connect(t.SignalSucceed,i,o),r&&n.signals.connect(t.SignalFailed,r,o),this._shared._service.fetch(n)},i.prototype.setAsDefault=function(t){return void 0===t&&(t=null),null==t&&(t=this.detectService()),this._service=new t,i._shared=this,this},Object.defineProperty(i,"shared",{get:function(){return this._shared},set:function(e){t.fatal("不能直接设置")},enumerable:!0,configurable:!0}),i}(t.SObject);n._SERVICES=new Array,t.ServicesManager=n;var i=function(e){function i(){return e.apply(this,arguments)||this}return __extends(i,e),i.prototype.detectService=function(){var e=t.ArrayT.QueryObject(n._SERVICES,function(t){return t.IsCurrent()});return t.assert(e),e},i}(n);t.AnyServices=i}(nn||(nn={}));var nn;!function(t){function e(t,e,n){t&&t._signals&&t._signals.emit(e,n)}var n=function(){function t(){}return t}();t.SlotTunnel=n;var i=function(){function e(){this.eps=0,this.emitedCount=0}return Object.defineProperty(e.prototype,"veto",{get:function(){return this._veto},set:function(t){this._veto=t,this.tunnel&&(this.tunnel.veto=t)},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this.cb=null,this.target=null,this.sender=null,this.data=null,this.payload=null,this.tunnel=null},e.prototype.toString=function(){var e="";return this.target?(this.cb?e+=this.cb.toString():this.redirect,e+="'"+this.redirect+"'",e+="@"+t.Classname(this.target)):this.cb&&(e+=this.cb.toString()),e},e.prototype.emit=function(e,n){if(this.eps){var i=egret.getTimer();if(void 0==this._epstms)this._epstms=i;else{var r=i-this._epstms;if(1e3/r>this.eps)return;this._epstms=i}}this.data=e,this.tunnel=n,this.delay?t.Delay(this.delay,this.doEmit,this):this.doEmit()},e.prototype.doEmit=function(){this.target?this.cb?this.cb.call(this.target,this):this.redirect&&this.target.signals&&this.target.signals.emit(this.redirect,this.data):this.cb&&this.cb.call(this,this),this.data=void 0,this.tunnel=void 0,++this.emitedCount},e.Data=function(t){var n=new e;return n.data=t,n},e}();t.Slot=i;var r=function(){function e(){this.slots=new Array,this._block=0}return e.prototype.dispose=function(){this.clear(),this.owner=void 0},e.prototype.clear=function(){t.ArrayT.Clear(this.slots,function(t){t.dispose()})},e.prototype.toString=function(){var t="";return this.slots.forEach(function(e,n){t+="	slot"+n+": "+e+"\n"},this),t},e.prototype.block=function(){this._block+=1},e.prototype.unblock=function(){this._block-=1},e.prototype.isblocked=function(){return 0!=this._block},e.prototype.add=function(t){this.slots.push(t)},e.prototype.emit=function(e,n){var i=this;if(this.isblocked())return null;var r;if(t.ArrayT.SafeForeach(this.slots,function(t,o){return null!=t.count&&t.emitedCount>=t.count?!0:(t.signal=i.signal,t.sender=i.owner,t.emit(e,n),null!=t.count&&t.emitedCount>=t.count?(null==r&&(r=new Array),r.push(o),!0):!t.veto)},this),r){var o=new t.CSet;return t.ArrayT.RemoveObjectsInIndexArray(this.slots,r).forEach(function(t){return t.target&&o.add(t.target),t.dispose(),!0}),o}return null},e.prototype.disconnect=function(e,n){var i=t.ArrayT.RemoveObjectsByFilter(this.slots,function(t){return e&&t.cb!=e?!1:t.target==n?(t.dispose(),!0):!1},this);return 0!=i.length},e.prototype.find_connected_function=function(e,n){return t.ArrayT.QueryObject(this.slots,function(t){return t.cb==e&&t.target==n})},e.prototype.find_redirected=function(e,n){return t.ArrayT.QueryObject(this.slots,function(t){return t.redirect==e&&t.target==n},this)},e.prototype.is_connected=function(e){return null!=t.ArrayT.QueryObject(this.slots,function(t){return t.target==e},this)},e}();t.Slots=r;var o=function(){function e(e){this._slots=new KvObject,this.__invtargets=new t.CSet,this.owner=e}return e.prototype.dispose=function(){var e=this;t.SetT.Clear(this.__invtargets,function(t){t.owner&&t.owner._signals&&t.owner._signals.disconnectOfTarget(e.owner,!1)},this),t.MapT.Clear(this._slots,function(t,e){e&&e.dispose()}),this.owner=null,this.delegate=null,this._castings=null},e.prototype.clear=function(){var e=this;t.SetT.Clear(this.__invtargets,function(t){t.owner&&t.owner._signals&&t.owner._signals.disconnectOfTarget(e.owner,!1)},this),t.MapT.Foreach(this._slots,function(t,e){e&&e.clear()})},e.prototype.toString=function(){var e="";return t.MapT.Foreach(this._slots,function(t,n){e+=t+": "+n+"\n"},this),e},e.prototype.register=function(e){return null==e?void t.fatal("不能注册一个空信号"):void(this._slots[e]||(this._slots[e]=null))},e.prototype.avaslots=function(e){var n=this._slots[e];return void 0===n?(t.fatal("对象 "+t.Classname(this.owner)+" 信号 "+e+" 不存在"),null):(null==n&&(n=new r,n.signal=e,n.owner=this.owner,this._slots[e]=n),n)},e.prototype.once=function(t,e,n){var i=this.connect(t,e,n);return i.count=1,i},e.prototype.connect=function(e,n,r){var o=this.avaslots(e);if(null==o)return t.fatal("对象 "+t.Classname(this.owner)+" 信号 "+e+" 不存在"),null;var s;return(s=o.find_connected_function(n,r))?s:(s=new i,s.cb=n,s.target=r,o.add(s),this.delegate&&this.delegate._signalConnected(e,s),this.__inv_connect(r),s)},e.prototype.isConnected=function(t){var e=this._slots[t];return null!=e&&0!=e.slots.length},e.prototype.redirect=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r,o,s;if(r=e[0],3==e.length)o=e[1],s=e[2];else{if(2!=e.length)return void t.fatal("SignalRedirect 传入了错误的参数");"string"==typeof e[1]?(o=e[1],s=this.owner):(o=r,s=e[1])}var a,c=this.avaslots(r);return(a=c.find_redirected(o,s))?a:(a=new i,a.redirect=o,a.target=s,c.add(a),this.delegate&&this.delegate._signalConnected(r,a),this.__inv_connect(s),a)},e.prototype.emit=function(e,n,i){var r=this,o=this._slots[e];if(o){var s=o.emit(n,i);s&&s.forEach(function(t){0==r.isConnectedOfTarget(t)&&r.__inv_disconnect(t)},this)}else if(void 0===o)return void t.fatal("对象 "+t.Classname(this.owner)+" 信号 "+e+" 不存在")},e.prototype.cast=function(e){null==this._castings&&(this._castings=new t.CSet,t.Defer(this._doCastings,this)),this._castings.add(e)},e.prototype._doCastings=function(){var t=this;null!=this._castings&&(this._castings.forEach(function(e){t.emit(e)}),this._castings=null)},e.prototype.disconnectOfTarget=function(e,n){void 0===n&&(n=!0),null!=e&&(t.MapT.Foreach(this._slots,function(t,n){n&&n.disconnect(null,e)},this),n&&this.__inv_disconnect(e))},e.prototype.disconnect=function(e,n,i){var r=this,o=this._slots[e];if(null==o)return null;if(null==n&&null==i){var s=new t.CSet;t.ArrayT.Clear(o.slots,function(t){t.target&&s.add(t.target),t.dispose()}),s.forEach(function(t){r.isConnectedOfTarget(t)||r.__inv_disconnect(t)},this)}else o.disconnect(n,i)&&i&&!this.isConnectedOfTarget(i)&&this.__inv_disconnect(i)},e.prototype.isConnectedOfTarget=function(e){return null!=t.MapT.QueryObject(this._slots,function(t,n){return n?n.is_connected(e):!1},this)},e.prototype.block=function(t){var e=this._slots[t];e&&e.block()},e.prototype.unblock=function(t){var e=this._slots[t];e&&e.unblock()},e.prototype.isblocked=function(t){var e=this._slots[t];return e?e.isblocked():!1},e.prototype.__inv_connect=function(t){null!=t&&null!=t.signals&&t.signals!=this&&t.signals.__invtargets.add(this)},e.prototype.__inv_disconnect=function(t){null!=t&&null!=t.signals&&t.signals!=this&&t.signals.__invtargets["delete"](this)},e}();t.Signals=o;var s=function(){function t(){this.cbs=new Array}return t.prototype.dispose=function(){this.cbs.forEach(function(t){t.dispose()}),this.cbs.length=0},t}(),a=function(){function e(){this._slots=new KvObject}return e.prototype.add=function(e,n,i){var r=this._slots[e];if(null!=r)r.cbs.push(new t.Closure(n,i));else{var o=new s;o.idr=e,o.cbs.push(new t.Closure(n,i)),this._slots[e]=o}},e.prototype.remove=function(t){var e=this._slots[t];e&&(e.dispose(),delete this._slots[t])},e.prototype.invoke=function(e,n,i){var r=this._slots[e];return null==r?void(i&&t.fatal("没有找到 "+e)):void r.cbs.forEach(function(t){t.cb&&t.ctx&&t.cb.call(t.ctx,n)},this)},e.prototype.clear=function(){t.MapT.Clear(this._slots)},e}();t.EventWeakDispatcher=a;var c=function(){function e(){this._slots=[]}return e.prototype.add=function(t,e){this._slots.push([t,e])},e.prototype.invoke=function(t){this._slots.forEach(function(e){e[0].call(e[1],t)})},e.prototype.clear=function(){t.ArrayT.Clear(this._slots)},e}();t.Reactors=c,t.emit=e,t.SignalException="::nn::exception",t.SignalDone="::nn::done",t.SignalSucceed="::nn::done",t.SignalOk="::nn::done",t.SignalTimeout="::nn::timeout",t.SignalEnd="::nn::end",t.SignalStart="::nn::start",t.SignalExit="::nn::exit",t.SignalChanged="::nn::changed",t.SignalUpdated="::nn::update::need",t.SignalPaused="::nn::paused",t.SignalResume="::nn::resume",t.SignalDataChanged="::nn::data::changed",t.SignalItemChanged="::nn::item::changed",t.SignalCancel="::nn::cancel",t.SignalFailed="::nn::failed",t.SignalAdding="::nn::adding",t.SignalAdded="::nn::added",t.SignalRemoving="::nn::removing",t.SignalRemoved="::nn::removed",t.SignalVisibleChanged="::nn::visible::changed",t.SignalNeedRedo="::nn::redo::need",t.SignalNeedReload="::nn::reload::need",t.SignalNeedFlush="::nn::flush::need",t.SignalNewChanged="::nn::new::changed",t.SignalAction="::nn::action",t.SignalSelected="::nn::selection::on",t.SignalDeselected="::nn::selection::off",t.SignalSelectionChanged="::nn::selection::changed",t.SignalSelectionChanging="::nn::selection::changing",t.SignalLoaded="::nn::loaded",t.SignalActivated="::nn::activated",t.SignalDeactivated="::nn::deactivated",t.SignalFocusGot="::nn::focus::got",t.SignalFocusLost="::nn::focus::lost",t.SignalConstriantChanged="::nn::constriant::changed",t.SignalClicked="::nn::clicked",t.SignalItemClicked="::nn::item::clicked",t.SignalTouchBegin="::nn::touch::begin",t.SignalTouchEnd="::nn::touch::end",t.SignalTouchMove="::nn::touch::move",t.SignalKeyPress="::nn::key::press",t.SignalEnterKey="::nn::key::enter",t.SignalScrollBegin="::nn::scroll::begin",t.SignalScrollEnd="::nn::scroll::end",t.SignalScrolled="::nn::scroll::changed",t.SignalHitTest="::nn::hittest",t.SignalFrameChanged="::nn::frame::changed",t.SignalStateChanged="::nn::state::changed",t.SignalOrientationChanged="::nn::orientation::changed",t.SignalOpening="::nn::opening",t.SignalOpen="::nn::open",t.SignalClosing="::nn::Closing",t.SignalClose="::nn::close"}(nn||(nn={}));var nn;!function(t){function e(t){var e;if(window.event)e=window.event;else{for(var n=arguments.callee.caller;null!=n.caller;)n=n.caller;e=n.arguments[0]}return t&&e.stopImmediatePropagation(),e}var n=function(){function t(){this._buf=""}return t.prototype.enter=function(t){return this._ele=t,this._buf+="<"+t+" ",this},t.prototype.pop=function(){return this._style&&(this._buf+='style="'+this._style+'" '),this._buf+=">",this._text&&(this._buf+=this._text),this._buf+="</"+this._ele+">",this},t.prototype.style=function(t,e){return null==this._style&&(this._style=""),this._style+=t+":"+e+";",this},t.prototype.attr=function(t,e){this._buf+=t+"=";var n=e;return"string"==typeof e&&n.length&&"#"!=n[0]?this._buf+='"'+e+'" ':this._buf+=e+" ",this},t.prototype.text=function(t){return this._text=t,this},t.prototype.toString=function(){return this._buf},t}();t.HtmlBuilder=n;var i;!function(n){function i(t){return"string"==typeof t?document.getElementById(t):t}function r(e){return t.Integral(e*n.ScaleFactorX)}function o(e){return t.Integral(e*n.ScaleFactorY)}function s(e){return t.Integral(e*n.ScaleFactorSize)}n.getElementById=i;var a=function(r){function o(t){var e=r.call(this)||this;return e._visible=!0,e.nodes=new Array,t&&(e.node=i(t)),e}return __extends(o,r),o.prototype.dispose=function(){r.prototype.dispose.call(this),this._listeners&&t.MapT.Clear(this._listeners)},o.From=function(t){return new o(t)},o.prototype._initSignals=function(){r.prototype._initSignals.call(this),this._signals.delegate=this,this._signals.register(t.SignalClicked)},o.prototype._signalConnected=function(e){switch(e){case t.SignalClicked:this.setAttr("onclick",this.method("__dom_clicked"))}},o.prototype.__dom_clicked=function(){this.event=e(!0),this._signals&&this._signals.emit(t.SignalClicked)},o.prototype.updateData=function(){},Object.defineProperty(o.prototype,"css",{get:function(){return this._node.style.cssText},set:function(t){this._node.style.cssText=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"style",{get:function(){return null==this._style&&(this._style=this._node.style),this._style},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"content",{get:function(){return this._node.textContent},set:function(t){this._node.textContent=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"id",{get:function(){return this.getAttr("id")},set:function(t){this.setAttr("id",t)},enumerable:!0,configurable:!0}),o.prototype.getAttr=function(t,e){var n=this._node.getAttribute(t);return null==n?e:n},o.prototype.setAttr=function(t,e){this._node.setAttribute(t,e)},Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize*n.ScaleFactorDeSize},set:function(t){this._fontSize!=t&&(this._fontSize=t,this._node.style.fontSize=t*n.ScaleFactorSize+"em")},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"src",{get:function(){return this._src},set:function(t){this._src=t,this._node.style.src="url("+t+")"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return this._node.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._node.clientHeight},enumerable:!0,configurable:!0}),o.prototype.add=function(t){return t.parent=this,this._node.appendChild(t._node),this.nodes.push(t),t.preload(function(){t.onLoaded()},this),this},o.prototype.preload=function(t,e){t.call(e)},o.prototype.onLoaded=function(){},o.prototype.br=function(){this._node.appendChild(document.createElement("br"))},o.prototype.remove=function(e){e.parent==this&&(e._node.parentElement.removeChild(e._node),e.parent=null,t.ArrayT.RemoveObject(this.nodes,e),t.drop(e))
},o.prototype.removeFromParent=function(){this.parent&&this.parent.remove(this)},Object.defineProperty(o.prototype,"visible",{get:function(){return this._visible},set:function(t){t!=this._visible&&(this._visible=t,this._node.style.display=t?"block":"none")},enumerable:!0,configurable:!0}),o.prototype.setFrame=function(t){"absolute"!=this._node.style.position&&(this._node.style.position="absolute"),this._node.style.left=t.x+"px",this._node.style.top=t.y+"px",this._node.style.width=t.width+"px",this._node.style.height=t.height+"px"},Object.defineProperty(o.prototype,"node",{get:function(){return this._node},set:function(t){t!=this._node&&(this._node&&this.remove(this._node),this._node=t,this._node&&(this.id=this.hashCode,this.parent&&this.parent.add(t)))},enumerable:!0,configurable:!0}),o.prototype.method=function(t){var e=this;return null==this.listener(t)&&(this._node[t]=this.bindListener(t,function(){e[t]()})),"document.getElementById("+this.id+")['"+t+"']()"},o.prototype.listener=function(t){return this._listeners?this._listeners[t]:void 0},o.prototype.bindListener=function(t,e){return this.listeners[t]=e,e},Object.defineProperty(o.prototype,"listeners",{get:function(){return null==this._listeners&&(this._listeners=new KvObject),this._listeners},enumerable:!0,configurable:!0}),o}(t.SObject);n.DomObject=a;var c=function(t){function e(e){var n=t.call(this,e)||this;return null==e&&(n.node=document.createElement("button")),n.style.backgroundColor="transparent",n.style.border="none",n}return __extends(e,t),Object.defineProperty(e.prototype,"image",{get:function(){return this._image},set:function(t){void 0==this._image&&(this.style.backgroundSize="contain",this.style.backgroundPosition="center",this.style.backgroundRepeat="no-repeat"),this._image=t,this.style.backgroundImage="url("+t+")"},enumerable:!0,configurable:!0}),e}(a);n.Button=c;var u=function(t){function e(e){var n=t.call(this,e)||this;return null==e&&(n.node=document.createElement("label")),n.fontSize=1,n}return __extends(e,t),e}(a);n.Label=u;var l=function(t){function e(e){var n=t.call(this,e)||this;return null==e&&(n.node=document.createElement("img")),n}return __extends(e,t),e}(a);n.Image=l;var h=function(t){function e(e){var n=t.call(this,e)||this;return null==e&&(n.node=document.createElement("div")),n.style.position="relative",n}return __extends(e,t),e}(a);n.Sprite=h;var p=function(e){function n(n,i){var r=e.call(this,i)||this;null==i&&(r.node=document.createElement("div")),r.contentView=n;var o=r.style;return o.position="absolute",o.zIndex=0,o.width="100%",o.height="100%",o.left="0px",o.top="0px",o.backgroundColor="rgba(0,0,0,0.7)",r.signals.connect(t.SignalClicked,r.__dsk_clicked,r),r}return __extends(n,e),Object.defineProperty(n.prototype,"contentView",{get:function(){return this._contentView},set:function(e){e!=this._contentView&&(this._contentView&&(this._contentView.removeFromParent(),this._contentView.signals.disconnectOfTarget(this)),this._contentView=e,e&&(e.signals.register(t.SignalRequestClose),e.signals.connect(t.SignalRequestClose,this.close,this),this.add(e)))},enumerable:!0,configurable:!0}),n.prototype.open=function(){t.Dom.add(this)},n.prototype.close=function(){this.removeFromParent()},n.prototype.__dsk_clicked=function(){this.clickedToClose&&this.close()},n}(a);n.Desktop=p,n.x=r,n.y=o,n.size=s}(i=t.dom||(t.dom={}));var r=function(e){function n(){var n=e.call(this)||this;return n._waitclick=new t.Closure(null,null),n.node=document.body,n}return __extends(n,e),n.prototype.updateBounds=function(){var e=new t.Size(320,568),n=t.Device.shared.screenBounds;i.ScaleFactorX=n.width/e.width,i.ScaleFactorY=n.height/e.height,i.ScaleFactorDeX=1/i.ScaleFactorX,i.ScaleFactorDeY=1/i.ScaleFactorY,i.ScaleFactorSize=Math.min(i.ScaleFactorX,i.ScaleFactorY),i.ScaleFactorDeSize=1/i.ScaleFactorDeSize},n.prototype._initSignals=function(){e.prototype._initSignals.call(this)},n.prototype.openLink=function(e){t.log("打开新页面："+e),window.open(e)},n.prototype.simulateLink=function(e){t.log("模拟点击链接："+e);try{window.top.location.href=e}catch(n){location.href=e}},n.prototype.openUrl=function(e){t.Device.shared.isMobile?this.simulateLink(e):this.openLink(e)},n.prototype.simulateClick=function(t,e){var n=document.createElement("div");return null==n?void t.call(e):(this._waitclick.reset(t,e),n.style.display="none",n.setAttribute("id","::n2::dom::simulateclick"),n.setAttribute("onclick",this.method("__cb_simulate_click")),this.node.appendChild(n),n.click(),void n.remove())},n.prototype.__cb_simulate_click=function(){this._waitclick.invoke(),this._waitclick.reset(null,null)},n}(i.DomObject);t._Dom=r,t.Dom=new r}(nn||(nn={}));var nn;!function(t){var e=function(){function e(){this.cost=0,this.past=0,this.count=0,this.start=this.now=t.DateTime.Pass()}return e}();t.FrameTimer=e;var n=function(){function n(){this._blayouts=NewSet(),this._bzpositions=NewSet(),this._bappears=NewSet(),this._bcaches=NewSet(),this._bmcs=NewSet(),this.RENDERS=NewSet(),this._ft=new e}return n.prototype.onPrepare=function(){t.ISDEBUG&&++this._ft.count,++n._layoutthreshold,t.SetT.SafeClear(this._blayouts,function(t){t.__disposed||(t._islayouting=!0,t.updateLayout(),t._islayouting=!1)}),--n._layoutthreshold,t.SetT.SafeClear(this._bzpositions,function(t){t.__disposed||t.updateZPosition()}),t.SetT.SafeClear(this._bappears,function(t){t.__disposed||t.isAppeared||t.onAppeared()}),t.SetT.Clear(this._bcaches,function(t){t.__disposed||t.flushCache()}),t.SetT.Clear(this._bmcs,function(t){t.gc()})},n.prototype.onRendering=function(){var e=t.DateTime.Pass();this._ft.cost=e-this._ft.now,this._ft.past=e-this._ft.start,this._ft.now=e;var n=this._ft.cost;this.RENDERS.forEach(function(t){t.onRender(n)},this)},n.prototype.needsLayout=function(t){0==n._layoutthreshold?(this._blayouts.add(t),this.invalidate()):t.updateLayout()},n.prototype.cancelLayout=function(t){this._blayouts["delete"](t)},n.prototype.needsZPosition=function(t){this._bzpositions.add(t),this.invalidate()},n.prototype.needsAppear=function(t){this._bappears.add(t),this.invalidate()},n.prototype.needsCache=function(t){this._bcaches.add(t),this.invalidate()},n.prototype.needsGC=function(t){this._bmcs.add(t),this.invalidate()},n}();n._layoutthreshold=0,t.CFramesManager=n}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._load=function(){},e}(t.SObject);t._DatasManager=e,t.DatasManager=new e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return t&&(n._imp=t,n._imp._fmui=n),n}return __extends(n,e),n.Wrapper=function(t){var e=new n(null);return e._imp=t,e},n.FromImp=function(t){for(var e=t._fmui;null==e&&t;)t=t.parent,t&&(e=t._fmui);return e},n.prototype.createImp=function(){},Object.defineProperty(n.prototype,"signals",{get:function(){return this._imp.signals},enumerable:!0,configurable:!0}),n.prototype._initSignals=function(){this._imp._initSignals()},Object.defineProperty(n.prototype,"descriptionName",{get:function(){return t.Classname(this._imp)},enumerable:!0,configurable:!0}),n.prototype.bestFrame=function(){return this._imp.bestFrame?this._imp.bestFrame():new t.Rect},n.prototype.bestPosition=function(){return this._imp.bestPosition?this._imp.bestPosition():null},n.prototype.updateCache=function(){this._imp.updateCache&&this._imp.updateCache()},n.prototype.grab=function(){this._imp.grab&&this._imp.grab(),e.prototype.grab.call(this)},n.prototype.drop=function(){this._imp.drop&&this._imp.drop(),e.prototype.drop.call(this)},n.prototype.onAppeared=function(){e.prototype.onAppeared.call(this),this._imp.onAppeared()},n.prototype.onDisappeared=function(){e.prototype.onDisappeared.call(this),this._imp.onDisappeared()},n}(t.Component);t.BridgedComponent=e}(nn||(nn={}));var nn;!function(t){var e;!function(e){var n=function(){function e(){var e=this;this._cnt=new t.WebSocketConnector,this._opers=new t.OperationQueue,this._cnt.host="ws://127.0.0.1:59001",this._cnt.signals.connect(t.SignalFailed,function(){t.warn("连接开发服务器失败，请使用n2build启动开发服务")},null),this._opers.add(new t.OperationClosure(function(n){e._cnt.signals.once(t.SignalOpen,function(){n.done()},null),e._cnt.open()}))}return e.prototype.fetch=function(e){var n=this;this._cnt.signals.once(t.SignalDataChanged,function(t){var n=JSON.parse(t.data);e(n)},null),this._opers.add(new t.OperationClosure(function(t){n._cnt.write(JSON.stringify({cmd:"::wswrk::developer",method:n.method,fields:n.fields})),t.done()}))},e}(),i=function(){function t(){}return t.prototype.pathForSave=function(t){var e=new n;e.method="::file::dialog::save",e.fields={filter:this.filter},e.fetch(function(e){t(e.path)})},t.prototype.pathForOpen=function(t){var e=new n;e.method="::file::dialog::open",e.fields={filter:this.filter},e.fetch(function(e){t(e.path)})},t.prototype.pathForDir=function(t){var e=new n;e.method="::file::dialog::dir",e.fields={filter:this.filter},e.fetch(function(e){t(e.path)})},t}();e.FileDialog=i;var r=function(){function t(){}return t.prototype.mkdir=function(t,e,i){var r=new n;r.method="::fs::mkdir",r.fields={p:e,path:t},r.fetch(function(t){i()})},t}();e.FileSystem=r;var o=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(t,e){var i=this,r=new n;r.method="::image::open",r.fields={file:t},r.fetch(function(t){i._hdl=t.hdl,e(null!=i._hdl)})},e.prototype.save=function(t,e){var i=new n;i.method="::image::save",i.fields={file:t,hdl:this._hdl},i.fetch(function(t){e(!0)})},e.prototype.scale=function(t,i,r){var o=new n;o.method="::image::scale",o.fields={x:t,y:i,hdl:this._hdl},o.fetch(function(t){var n=new e;n._hdl=t.hdl,r(n)})},e.prototype.subimage=function(t,i){var r=new n;r.method="::image::subimage",r.fields={hdl:this._hdl,rect:{x:t.x,y:t.y,w:t.width,h:t.height}},r.fetch(function(t){var n=new e;n._hdl=t.hdl,i(n)})},e}(t.SObject);e.Image=o}(e=t.developer||(t.developer={}))}(nn||(nn={}));var nn;!function(t){function e(){return r?r:r=new i}var n=function(){function t(){}return t.prototype.onRender=function(t){dragonBones.WorldClock.clock.advanceTime(t)},t}(),i=function(e){function i(){var i=e.call(this)||this;return i.turboMode=!0,i.fps=30,i._factory=new dragonBones.EgretFactory,t.FramesManager.RENDERS.add(new n),i}return __extends(i,e),i.prototype.instance=function(e,n,i){var r=this;t.length(e.resourceGroups)?t.ResManager.capsules(e.resourceGroups).load(function(){r.instanceOne(e.character,e.skeleton,e.place,e.texture,e.fps,n,i)},this):this.instanceOne(e.character,e.skeleton,e.place,e.texture,e.fps,n,i)},i.prototype.instanceOne=function(e,n,i,r,s,a,c){var u=this;t.ResManager.getSources([[n,t.ResType.JSON],[i,t.ResType.JSON],[r,t.ResType.TEXTURE]],t.ResPriority.CLIP,function(s){var l=s[0].use();if(null==l)return t.warn("bone-skcfg "+n+" not found"),void a.call(c,null);var h=s[1].use();if(null==h)return t.warn("bone-tcfg "+i+" not found"),void a.call(c,null);var p=s[2].use();if(null==p)return t.warn("bone-tex "+r+" not found"),void a.call(c,null);var d=dragonBones.DataParser.parseDragonBonesData(l);if(null==d)return t.warn("解析骨骼数据 "+e+" 失败"),void a.call(c,null);u._factory.addSkeletonData(d);var f=new dragonBones.EgretTextureAtlas(p,h);if(null==f)return t.warn("构造骨骼贴图 "+e+" 失败"),void a.call(c,null);if(u._factory.addTextureAtlas(f),u.turboMode){var g=u._factory.buildFastArmature(e);if(null==g)t.warn("创建加速骨骼 "+e+" 失败 ["+e+"]");else{var _=g._armatureData.frameRate;_||(_=u.fps),g.enableAnimationCache(_)}var y=new o(g);return void a.call(c,y)}var m=u._factory.buildArmature(e);null==m&&t.warn("创建普通骨骼 "+e+" 失败 ["+e+"]");var v=new o(m);a.call(c,v)},this)},i}(t.SObject);t._BonesManager=i;var r;t.BonesManager=e;var o=function(){function e(t){this._armature=t}return Object.defineProperty(e.prototype,"armature",{get:function(){return this._armature},set:function(e){t.warn("不能直接设置 BoneData")},enumerable:!0,configurable:!0}),e.prototype.addLoop=function(){this._armature&&dragonBones.WorldClock.clock.add(this._armature)},e.prototype.rmLoop=function(){this._armature&&dragonBones.WorldClock.clock.remove(this._armature)},e.prototype.calcFrameProgress=function(e,n){var i=this._armature.animation,r=t.ArrayT.QueryObject(i.animationDataList,function(t){return t.name==e});if(null==r)return 0;t.fatal("没有实现");var o=0,s=Math.ceil(r.duration/o),a=0>n?s+n:n;return a/s},e.prototype.playMotion=function(t,e,n){var i=this._armature.animation,r=i.gotoAndPlay(t,0,-1,e);r.__stopAtProgress=n},e.prototype.seekToMotion=function(t,e){var n=this._armature.animation;n.gotoAndStop(t,e)},e.prototype.hasMotion=function(t){var e=this._armature.animation;return e.hasAnimation(t)},e.prototype.bestFrame=function(){var e=new t.Rect;if(this._armature){var n=this._armature.display.getBounds();e.x=-n.x,e.y=-n.y,e.width=n.width,e.height=n.height}return e.unapplyScaleFactor()},Object.defineProperty(e.prototype,"display",{get:function(){return this._armature.display},enumerable:!0,configurable:!0}),e}();t.BoneData=o;var s=function(){function e(t,e,n,i,r){this._name=t,e?this._character=e:this._character=t,n?this._skeleton=n:this._skeleton=t+"_skeleton_json",i?this._place=i:this._place=t+"_texture_json",r?this._texture=r:this._texture=t+"_png"}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t,this._character||(this._character=name),this._skeleton||(this._skeleton=name+"_skeleton_json"),this._place||(this._place=name+"_texture_json"),this._texture||(this._texture=name+"_png")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._skeleton},set:function(t){this._skeleton=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"place",{get:function(){return this._place},set:function(t){this._place=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"character",{get:function(){return this._character},set:function(t){this._character=t},enumerable:!0,configurable:!0}),e.prototype.getReqResources=function(){var e=[];return e.push(new t.ResourceEntity(this.skeleton,t.ResType.JSON)),e.push(new t.ResourceEntity(this.place,t.ResType.JSON)),e.push(new t.ResourceEntity(this.texture,t.ResType.TEXTURE)),e},e}();t.BoneConfig=s;var a=function(n){function i(){var e=n.call(this)||this;return e._bs=null,e.additionScale=1,e.fillMode=t.FillMode.ASPECTSTRETCH,e.clipAlign=t.POSITION.BOTTOM_CENTER,e._motions=new Array,e.autoPlay=!0,e.count=-1,e}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalEnd),this._signals.register(t.SignalDone),this._signals.register(t.SignalChanged),this._signals.register(t.SignalUpdated)},i.prototype.dispose=function(){this._data&&(this._data.rmLoop(),this._data=void 0),n.prototype.dispose.call(this)},i.prototype.getBoneData=function(){return this._data},i.prototype.setBoneData=function(e){var n=this;if(n._data==e)return void(n._signals&&n._signals.emit(t.SignalUpdated));if(n._data&&(n._data.rmLoop(),n._imp.removeChild(n._data.display)),n._data=e,e){n._imp.addChild(n._data.display);var i=e.armature;t.EventHook(i,dragonBones.AnimationEvent.START,n.__db_start,n),t.EventHook(i,dragonBones.AnimationEvent.LOOP_COMPLETE,n.__db_loopcomplete,n),t.EventHook(i,dragonBones.AnimationEvent.COMPLETE,n.__db_complete,n),n.updateLayout(),(n._playingState==t.WorkState.DOING||n.autoPlay)&&(n._playingState=t.WorkState.DONE,n.play())}n._signals&&(n._signals.emit(t.SignalUpdated),n._signals.emit(t.SignalChanged))},Object.defineProperty(i.prototype,"boneSource",{get:function(){return this._bs},set:function(n){var i=this;if(this._bs!=n)if(this._bs=n,n instanceof s){var r=n;e().instance(r,function(t){i._bs==n&&i.setBoneData(t)},this)}else{var o=typeof n;if("string"==o){var r=new s(n);e().instance(r,function(t){i._bs==n&&i.setBoneData(t)},this)}else t.warn("设置了错误的骨骼数据")}},enumerable:!0,configurable:!0}),i.prototype.bestFrame=function(){return this._data?this._data.bestFrame():new t.Rect},i.prototype.updateLayout=function(){n.prototype.updateLayout.call(this);var t=this._data;if(null!=t){var e=this.boundsForLayout(),i=t.bestFrame();if(0!=i.width&&0!=i.height){var r=i.clone().fill(e,this.fillMode),o=r.width/i.width,s=r.height/i.height,a=Math.min(o,s)*this.additionScale;i.x*=a,i.y*=a,r.alignTo(e,this.clipAlign),i.x+=r.x,i.y+=r.y;var c=this._data.display;c.scaleX=c.scaleY=a,this.impSetFrame(i,c)}}},Object.defineProperty(i.prototype,"motion",{get:function(){return t.ArrayT.Top(this._motions)},set:function(e){e!=this.motion&&(t.ArrayT.SetTop(this._motions,e),(this._playingState==t.WorkState.DOING||this.autoPlay)&&(this._playingState=t.WorkState.DONE,this.play()))},enumerable:!0,configurable:!0}),i.prototype.pushMotion=function(e){this._motions.push(e),(this._playingState==t.WorkState.DOING||this.autoPlay)&&(this._playingState=t.WorkState.DONE,this.play())},i.prototype.popMotion=function(){this._motions.pop(),(this._playingState==t.WorkState.DOING||this.autoPlay)&&(this._playingState=t.WorkState.DONE,this.play())},i.prototype.motions=function(){return this._data?this._data.armature.animation.animationList:[]},i.prototype.hasMotion=function(t){return this._data&&this._data.hasMotion(t)},i.prototype.play=function(){var e=this;if(null!=e._data&&0!=e._motions.length&&e._playingState!=t.WorkState.DOING){var n=e.motion;if(0==e.hasMotion(n))return void t.warn("bone-motion "+n+" not found, avaliable motions:"+this.motions.toString());e.count<=-1?e._data.playMotion(n,0):e.count>0?e._data.playMotion(n,e.count):e._data.playMotion(n,0/0),e._playingState=t.WorkState.DOING,this._data.addLoop()}},i.prototype.stop=function(){var e=this;null!=e._data&&e._playingState==t.WorkState.DOING&&(e._playingState=t.WorkState.DONE,e._data.rmLoop())},i.prototype.__db_start=function(){this._signals&&this._signals.emit(t.SignalStart)},i.prototype.__db_complete=function(){this._data.rmLoop(),this._playingState=t.WorkState.DONE,this._signals&&(this._signals.emit(t.SignalEnd),this._signals.emit(t.SignalDone))},i.prototype.__db_loopcomplete=function(){this._signals&&this._signals.emit(t.SignalEnd)},i}(t.Widget);t.Bones=a;var c=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"progress",{get:function(){var t=this,e=t._progress,n=t.__stopAtProgress;return n&&e>=n?n:t._progress},enumerable:!0,configurable:!0}),e}(dragonBones.AnimationState);dragonBones.AnimationState=c}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),Object.defineProperty(e.prototype,"root",{get:function(){return this._gameLayer.root},set:function(t){this._gameLayer.root=t},enumerable:!0,configurable:!0}),e}(t.EgretApp);t.CoreApplication=e}(nn||(nn={}));var nn;!function(t){var e=function(){function e(){}return e.sizeOfString=function(e,n,i,r){var o=0,s=n;return o=(e.length?e.length+1:0)*n,i?(s=Math.ceil(o/i)*n,r&&s>r&&(s=r),o=Math.min(o,i),new t.Size(o,s)):r?(n>r&&(s=r),new t.Size(o,s)):new t.Size(o,s)},e.sizeFitString=function(n,i,r,o,s){if(!n||!n.length)return new t.Size;var a=new t.Size,c=n.split("\n");return c.forEach(function(t){var n=e.sizeOfString(t,i,r,o);a.width=Math.max(a.width,n.width),a.height+=n.height}),a.height+=c.length*s,a},e}();t.Font=e}(nn||(nn={}));var nn;!function(t){function e(){return o?o:o=new s}var n=function(e){function n(){var n=e.call(this)||this;return n.originBoundingBox=new t.Rect,n}return __extends(n,e),n.prototype.bestFrame=function(){return this.originBoundingBox.clone()},n.prototype.bindMovieClipData=function(e,n){this.movieClipData=e,this.factory=n,e?(this.originBoundingBox=e.boundingBox,this.originFrameRate=e.__fileFrameRate,this.visible=!0):(this.originBoundingBox=new t.Rect,this.originFrameRate=30,this.visible=!1)},n}(egret.MovieClip),i=function(i){function r(){var e=i.call(this)||this;return e.count=1,e.clearOnChanging=!0,e._mc=new n,e._cs=null,e.autoPlay=!0,e.additionScale=1,e.fillMode=t.FillMode.ASPECTSTRETCH,e.clipAlign=t.POSITION.CENTER,e._imp.addChild(e._mc),e}return __extends(r,i),r.prototype._initSignals=function(){i.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalChanged),this._signals.register(t.SignalUpdated),this._signals.register(t.SignalEnd),this._signals.register(t.SignalDone)},r.prototype._signalConnected=function(e,n){switch(i.prototype._signalConnected.call(this,e,n),e){case t.SignalEnd:t.EventHook(this._mc,egret.Event.LOOP_COMPLETE,this.__cb_end,this);break;case t.SignalDone:t.EventHook(this._mc,egret.Event.COMPLETE,this.__cb_done,this)}},r.prototype.dispose=function(){this.reverseMode&&!this.__needreverse&&(this.__needreverse=!0,this.tryReverseMovieClipData()),i.prototype.dispose.call(this)},Object.defineProperty(r.prototype,"fps",{get:function(){return this._mc.frameRate},set:function(t){this._fps=t,this._mc.frameRate=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clipSource",{get:function(){return this._cs},set:function(n){var i=this;if(t.ObjectT.IsEqual(n,i._cs))return void(i._signals&&i._signals.emit(t.SignalUpdated));if(null==n&&i._cs)return i._mc.bindMovieClipData(null,null),void(i._cs=null);i.clearOnChanging&&i._mc.bindMovieClipData(null,null);var r=i._cs;i._cs=n,e().instance(n,function(e,o){i.__disposed||0==t.ObjectT.IsEqual(n,i._cs)||(null!=n.additionScale&&(i.additionScale=n.additionScale),n.fps&&(i.fps=n.fps),r&&i.stop(),i._setMovieClipData(e,o))},i)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clip",{get:function(){return this._clip},set:function(t){t!=this._clip&&(this._location=void 0,this._clip=t,this.autoPlay&&!this.isPlaying&&this.play())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"location",{get:function(){return this._location},set:function(t){t!=this._location&&(this._clip=void 0,this._location=t,this.autoPlay&&!this.isPlaying&&this.play())},enumerable:!0,configurable:!0}),r.prototype.onAppeared=function(){i.prototype.onAppeared.call(this),1==this.__autopaused&&(this.__autopaused=!1,this.play())},r.prototype.onDisappeared=function(){i.prototype.onDisappeared.call(this),this.isPlaying&&-1==this.count&&(this.__autopaused=!0,this.stop())},Object.defineProperty(r.prototype,"isPlaying",{get:function(){return this._mc.isPlaying},enumerable:!0,configurable:!0}),r.prototype.stop=function(){this.isPlaying&&this._mc.stop()},r.prototype.play=function(){this.isPlaying||this._updateAnimation()},r.prototype.bestFrame=function(){var t=this._mc.bestFrame();return t.x=t.y=0,t},r.prototype._setMovieClipData=function(e,n){e?(this._mc.bindMovieClipData(e,n),this._fps?this._mc.frameRate=this._fps:this._mc.frameRate=this._mc.originFrameRate,this.updateLayout()):this._mc.bindMovieClipData(e,n),this._signals&&(this._signals.emit(t.SignalUpdated),this._signals.emit(t.SignalChanged)),this.autoPlay&&!this.isPlaying&&this.play()},Object.defineProperty(r.prototype,"reverseMode",{get:function(){return this._reverseMode},set:function(t){this._reverseMode!=t&&(this._reverseMode=t,this.__needreverse=!0)},enumerable:!0,configurable:!0}),r.prototype.tryReverseMovieClipData=function(){if(this.reverseMode||this.__needreverse){var t=this._mc.movieClipData;t.frames.reverse(),this.__needreverse=void 0}},Object.defineProperty(r.prototype,"flashMode",{get:function(){return this._flashMode},set:function(e){this._flashMode=e,e&&null==this.flashAnchorPoint&&(this.flashAnchorPoint=new t.Point(.5,.5))},enumerable:!0,configurable:!0}),r.prototype.updateLayout=function(){i.prototype.updateLayout.call(this);var e=this.bounds(),n=this._mc.bestFrame(),r=n.clone().fill(e,this.fillMode).scale(this.additionScale),o=r.width/n.width,s=r.height/n.height,a=Math.min(o,s);this._mc.scaleX=this._mc.scaleY=a*t.ScaleFactorS,r.alignTo(e,this.clipAlign),r.add(-n.x*a,-n.y*a),this.flashMode&&r.add((n.x+n.width*this.flashAnchorPoint.x)*a,(n.y+n.height*this.flashAnchorPoint.y)*a),this.impSetFrame(r.integral(),this._mc)},r.prototype._updateAnimation=function(){null==this._mc.movieClipData||this._mc.isPlaying||(null!=this._clip||null!=this._location)&&(this.tryReverseMovieClipData(),this._signals&&this._signals.emit(t.SignalStart),this._clip?this._mc.gotoAndPlay(this._clip,this.count):null!=this._location&&this._mc.gotoAndPlay(this._location,this.count))},r.prototype.__cb_end=function(e){this.__disposed||this._signals.emit(t.SignalEnd)},r.prototype.__cb_done=function(e){this.__disposed||this._signals.emit(t.SignalDone)},r}(t.Widget);t.MovieClip=i;var r=function(){function e(e,n,i){this.key="",this._name=e,this._frame=t.nonnull1st(null,n,e),this._texture=t.nonnull1st(null,i,n,e,n)}return Object.defineProperty(e.prototype,"frame",{get:function(){var t=this._frame;return t&&-1==t.indexOf("://")&&-1==t.indexOf("_json")&&(t+="_json"),t},set:function(t){this._frame=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){var t=this._texture;return t&&-1==t.indexOf("://")&&-1==t.indexOf("_png")&&(t+="_png"),t},set:function(t){this._texture=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t,null==this._frame&&(this._frame=t),null==this._texture&&(this._texture=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hashCode",{get:function(){return t.StringT.Hash(this.name+"::"+this._frame+"::"+this._texture+"::"+this.key)},enumerable:!0,configurable:!0}),e.prototype.isEqual=function(t){return this.name==t.name&&this._frame==t._frame&&this._texture==t._texture&&this.fps==t.fps&&this.additionScale==t.additionScale&&this.key==t.key},e.prototype.getReqResources=function(){var e=[];return e.push(new t.ResourceEntity(this.frame,t.ResType.JSON)),e.push(new t.ResourceEntity(this.texture,t.ResType.TEXTURE)),e},e.prototype.toString=function(){return[this.name,this._frame,this._texture,this.key].join("\n")},e}();t.ClipConfig=r;var o,s=function(){function e(){this._factorys=new KvObject}return e.prototype.instance=function(e,n,i){var r=this;t.length(e.resourceGroups)?t.ResManager.capsules(e.resourceGroups).load(function(){r.instanceOne(e,n,i)},this):this.instanceOne(e,n,i)},e.prototype.instanceOne=function(e,n,i){var r=this,o=e.name,s=e.frame,a=e.texture,c=e.hashCode,u=this._factorys[c];if(u){var l=this.instanceFromFactory(u,o,!1);0==l.frames.length&&(t.warn("MovieClip为空帧，清检查资源文件和配置是否一致\n"+e),l=null),n.call(i,l,u)}else t.ResManager.getSources([[s,t.ResType.JSON],[a,t.ResType.TEXTURE]],t.ResPriority.CLIP,function(u){var l=u[0].use(),h=u[1].use();if(null==l)return t.warn("mc-cfg "+s+" not found"),void n.call(i,null,null);if(null==h)return t.warn("mc-tex "+a+" not found"),void n.call(i,null,null);var p=r._factorys[c];p||(p={cfg:e,factory:new egret.MovieClipDataFactory(l,h)},r._factorys[c]=p);var d=r.instanceFromFactory(p,o,!0);0==d.frames.length&&(t.warn("MovieClip为空帧，请检查资源文件和配置是否一致\n"+e),d=null),n.call(i,d,p)},this)},e.prototype.instanceFromFactory=function(e,n,i){var r=e.factory.generateMovieClipData(n);if(null==r)t.warn("生成序列帧 "+n+" 失败");else{i&&(r.__fileFrameRate=r.frameRate);var o=new t.Rect,s=new t.PointCloud;t.ArrayT.Foreach(r.frames,function(e){if(e.hasOwnProperty("frame"))return!0;var n=r.textureData[e.res];return null==n?!0:(s.add(new t.Point(e.x,e.y)),o.union(new t.Rect(0,0,n.w,n.h)),!0)},this),o.position=s.boundingBox.position,r.boundingBox=o}return r},e}()}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(t){var n=e.call(this)||this;return n.touchEnabled=!0,t&&n.onChangeState(t),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),this._slavestates&&this._slavestates.dispose()},Object.defineProperty(n.prototype,"fontSize",{get:function(){return this._label?this._label.fontSize:0},set:function(t){this._getLabel().fontSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textColor",{get:function(){return this._label?this._label.textColor:0},set:function(e){this._getLabel().textColor=t.GetColorComponent(e)[0]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this._label?this._label.text:""},set:function(t){this._getLabel().text=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textAlign",{get:function(){return this._label?this._label.textAlign:"center"},set:function(t){this._getLabel().textAlign=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return this._label},set:function(e){t.warn("不能直接设置button的title类")},enumerable:!0,configurable:!0}),n.prototype._getLabel=function(){return null==this._label&&(this._label=new t.Label,this._label.textAlign="center",this.addChild(this._label)),this._label},Object.defineProperty(n.prototype,"imageView",{get:function(){return this._imageView},set:function(e){t.warn("不能直接设置button的image")},enumerable:!0,configurable:!0}),n.prototype._getImageView=function(){return null==this._imageView&&(this._imageView=new t.Bitmap,this._imageView.fillMode=t.FillMode.ASPECTSTRETCH,this.addChild(this._imageView)),this._imageView},Object.defineProperty(n.prototype,"imageSource",{get:function(){return this._imageView?this._imageView.imageSource:null},set:function(t){this._getImageView().imageSource=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"imageFillMode",{get:function(){return this._imageView?this._imageView.fillMode:t.FillMode.ASPECTSTRETCH},set:function(t){this._getImageView().fillMode=t},enumerable:!0,configurable:!0}),n.prototype.bestFrame=function(e){var n=new t.Rect;return this._label&&n.union(this._label.bestFrame()),n.unapplyEdgeInsets(this.edgeInsets)},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this);var t=this.boundsForLayout();this._label&&(this._label.frame=t),this._imageView&&(this._imageView.frame=t)},Object.defineProperty(n.prototype,"stateNormal",{get:function(){return this._slavestates?this._slavestates.get(n.STATE_NORMAL):null},set:function(t){this.slavestates.bind(n.STATE_NORMAL,t),this.disabled||(void 0==this._slavestates.state&&(this._slavestates.state=n.STATE_NORMAL),this.states.updateData(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stateDisabled",{get:function(){return this._slavestates?this._slavestates.get(n.STATE_DISABLED):null},set:function(t){this.slavestates.bind(n.STATE_DISABLED,t),this.disabled&&(void 0==this._slavestates.state&&(this._slavestates.state=n.STATE_DISABLED),this.states.updateData(!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stateHighlight",{get:function(){return this._slavestates?this._slavestates.get(n.STATE_HIGHLIGHT):null},set:function(t){this.slavestates.bind(n.STATE_HIGHLIGHT,t),this.states.updateData(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stateSelected",{get:function(){return this._slavestates?this._slavestates.get(n.STATE_SELECTED):null},set:function(t){this.slavestates.bind(n.STATE_SELECTED,t),this.states.updateData(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"slavestates",{get:function(){return null==this._slavestates&&(this._slavestates=new t.States,this.signals.connect(t.SignalTouchBegin,this.__btn_touchdown,this),this.signals.connect(t.SignalTouchEnd,this.__btn_touchup,this)),this._slavestates},enumerable:!0,configurable:!0}),n.prototype.onChangeState=function(e){var i=t.State.As(e);if(this._slavestates){var r=this._slavestates.state;if(r==n.STATE_NORMAL){var o=this._slavestates.get(n.STATE_NORMAL);o&&i.add("normal",o)}else if(r==n.STATE_DISABLED){var o=this._slavestates.get(n.STATE_DISABLED);o&&i.add("disabled",o)}else if(r==n.STATE_SELECTED){var o=this._slavestates.get(n.STATE_SELECTED);o&&i.add("selected",o)}else if(r==n.STATE_HIGHLIGHT){var o=this._slavestates.get(n.STATE_HIGHLIGHT);o&&i.add("highlight",o)
}}i.setIn(this)},Object.defineProperty(n.prototype,"disabled",{get:function(){return 1==this._disabled},set:function(t){t!=this._disabled&&(this._disabled=t,this._slavestates.changeState(this._disabled?n.STATE_DISABLED:n.STATE_NORMAL)&&this.states.updateData(!1),this.touchEnabled=!t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"touchEnabled",{get:function(){return this._imp.touchEnabled},set:function(t){this._imp.touchEnabled=!this._disabled&&t},enumerable:!0,configurable:!0}),n.prototype.__btn_touchdown=function(){null!=this._slavestates&&this._slavestates.changeState(n.STATE_HIGHLIGHT)&&this.states.updateData(!1)},n.prototype.__btn_touchup=function(){null!=this._slavestates&&(this._isSelected&&this._slavestates.get(n.STATE_SELECTED)?this._slavestates.changeState(n.STATE_SELECTED)&&this.states.updateData(!1):this._slavestates.changeState(this.disabled?n.STATE_DISABLED:n.STATE_NORMAL)&&this.states.updateData(!1))},n.prototype.setSelection=function(e){e!=this._isSelected&&(this._isSelected=e,this._isSelected&&this._slavestates.get(n.STATE_SELECTED)?this._slavestates.state=n.STATE_SELECTED:this._slavestates.state=this.disabled?n.STATE_DISABLED:n.STATE_NORMAL,this.states.updateData(!1),this.states.signals.emit(t.SignalStateChanged))},n}(t.CButton);t.Button=e;var n=function(e){function n(){var n=e.call(this)||this;return n.allowDeclick=!0,n.signals.connect(t.SignalClicked,n.__radio_clicked,n),n}return __extends(n,e),Object.defineProperty(n.prototype,"selectedState",{get:function(){return this._selectedState},set:function(t){this._selectedState!=t&&(this._selectedState=t,this.states.bind("selected",t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unselectedState",{get:function(){return this._unselectedState},set:function(t){this._unselectedState!=t&&(this._unselectedState=t,this.states.bind("unselected",t),void 0==this.states.state&&(this.states.state="unselected"))},enumerable:!0,configurable:!0}),n.prototype.setSelection=function(t){this._selection!=t&&(this._selection=t,this.states.state=t?"selected":"unselected")},n.prototype.isSelection=function(){return this._selection},n.prototype.__radio_clicked=function(){(this.allowDeclick||!this.isSelection())&&this.setSelection(!this.isSelection())},n}(e);t.RadioButton=n}(nn||(nn={}));var nn;!function(t){function e(t,e){t.__desktop=e}function n(t){return t?t.__desktop:null}var i=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setNeedsLayout=function(){},e}(t.Sprite),r=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setNeedsLayout=function(){},e}(t.Bitmap);t.DesktopOperationQueue=new t.OperationQueue;var o=function(o){function a(e){var n=o.call(this)||this;return n._filters=new Array,n._isOpened=!1,n.queue=t.DesktopOperationQueue,n.popupMode=!0,n._addIntoOpening=!0,n.clickedToClose=!1,n.adaptiveContentFrame=!0,t.ObjectClass(n).BackgroundColor&&(n.backgroundColor=t.ObjectClass(n).BackgroundColor),t.ObjectClass(n).BackgroundImage&&(n.backgroundImage=t.ObjectClass(n).BackgroundImage),n.touchEnabled=!0,n.contentView=e,n.frame=t.StageBounds,n.signals.connect(t.SignalClicked,n.__dsk_clicked,n),n.signals.connect(t.SignalHitTest,n.__dsk_clicked,n),n.signals.connect(t.SignalAddedToStage,n.__dsk_addedtostage,n),t.CApplication.shared.signals.connect(t.SignalFrameChanged,n.__dsk_sizechanged,n),n}return __extends(a,o),a.prototype.dispose=function(){t.ArrayT.Clear(this._filters),o.prototype.dispose.call(this)},a.FromView=function(t){for(var e=n(t);null==e&&t;)t=t.parent,e=n(t);return e},a.prototype.__dsk_sizechanged=function(e){this.frame=t.StageBounds},a.prototype._initSignals=function(){o.prototype._initSignals.call(this),this._signals.register(t.SignalHitTest),this._signals.register(t.SignalOpening),this._signals.register(t.SignalClosing),this._signals.register(t.SignalOpen),this._signals.register(t.SignalClose)},a.prototype.addFilter=function(t){this._filters.push(t)},Object.defineProperty(a.prototype,"onlyFiltersTouchEnabled",{get:function(){return this._onlyFiltersTouchEnabled},set:function(t){this._onlyFiltersTouchEnabled=t,this.touchEnabled=!t,this.touchChildren=!t},enumerable:!0,configurable:!0}),a.prototype.hitTestInFilters=function(e){var n=this;return t.ArrayT.QueryObject(this._filters,function(t){var i=t.convertRectTo(t.bounds(),n);return i.containsPoint(e)},this,null)},a.prototype.onLoaded=function(){o.prototype.onLoaded.call(this),this._contentView&&this._contentView.updateData()},a.prototype.__dsk_addedtostage=function(){this._contentView&&this.addChild(this._contentView)},a.prototype.onAppeared=function(){o.prototype.onAppeared.call(this),0==t.isZero(this.delayClose)&&t.Delay(this.delayClose,this.close,this),this.updateFilters()},a.prototype.updateFilters=function(){var t=this;if(0!=this._filters.length){var e=this.backgroundColor,n=this.backgroundImage;this.backgroundColor=null,this.backgroundImage=null;var o=new i;o.hasHollowOut=!0,o.backgroundColor=e,o.backgroundImage=n,o.frame=this.bounds(),o.updateLayout(),this._filters.forEach(function(e){var n=new r;n.frame=e.convertRectTo(e.bounds(),t),n.imageSource=e.renderToTexture(),n.updateLayout(),o.hollowOut(n)},this),this.backgroundImage=o.renderToTexture()}},Object.defineProperty(a.prototype,"contentView",{get:function(){return this._contentView},set:function(n){this._contentView!=n&&(this._contentView&&(this.removeChild(this._contentView),e(this._contentView,null)),this._contentView=n,n&&(e(n,this),this.onStage&&this.__dsk_addedtostage(),n.signals.register(t.SignalOpening),n.signals.register(t.SignalClosing),n.signals.register(t.SignalOpen),n.signals.register(t.SignalClose)))},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isOpened",{get:function(){return this._isOpened},enumerable:!0,configurable:!0}),a.prototype.open=function(t){void 0===t&&(t=!1),this._isOpened||(this._isOpened=!0,t?(this._oper=new s(this),this.queue.add(this._oper)):this.doOpen())},a.prototype.follow=function(t){if(!this._isOpened){this._isOpened=!0,this._oper=new s(this);var e=n(t);null==e._oper?this.queue.add(this._oper):this.queue.follow(e._oper,this._oper)}},a.prototype.replace=function(t){if(!this._isOpened){this._isOpened=!0;var e=n(t);null==e._oper?(e.close(),this.open()):(null==e.desktopLayer&&(e.desktopLayer=this.desktopLayer),this._oper=new s(this),this.queue.replace(e._oper,this._oper),e.close())}},a.prototype.doOpen=function(){null==this.desktopLayer&&(this.desktopLayer=t.CApplication.shared.gameLayer),this._onlyFiltersTouchEnabled&&a._AllNeedFilters.push(this),this._addIntoOpening&&a._AllOpenings.push(this),this.signals.emit(t.SignalOpening),this._contentView&&this._contentView.signals.emit(t.SignalOpening),this.popupMode?this.desktopLayer.addChild(this):this.desktopLayer.push(this),this._contentView&&this._contentView.signals.emit(t.SignalOpen),this.signals.emit(t.SignalOpen)},a.CloseAllOpenings=function(){t.ArrayT.SafeClear(this._AllOpenings,function(t){t.close()})},a.Current=function(){return t.ArrayT.Top(this._AllOpenings)},a.prototype.close=function(){if(this._isOpened){if(this._isOpened=!1,null==this.parent)return void(this._oper&&(this.queue.remove(this._oper),this._oper=null));this.doClose(),this._oper&&(this._oper.done(),this._oper=null)}},a.prototype.doClose=function(){this._onlyFiltersTouchEnabled&&t.ArrayT.RemoveObject(a._AllNeedFilters,this),this._addIntoOpening&&t.ArrayT.RemoveObject(a._AllOpenings,this),this.signals.emit(t.SignalClosing),this._contentView&&this._contentView.signals.emit(t.SignalClosing),this.grab(),this._contentView&&this._contentView.grab(),this.popupMode?(this.onDisappeared(),this.desktopLayer.removeChild(this)):this.desktopLayer.pop(this),this._contentView&&this._contentView.signals.emit(t.SignalClose),this.signals.emit(t.SignalClose),this._contentView&&this._contentView.drop(),this.drop()},a.prototype.__dsk_clicked=function(){this.clickedToClose&&this.close()},a.prototype.updateLayout=function(){if(o.prototype.updateLayout.call(this),this._contentView&&this.adaptiveContentFrame){var t=this._contentView.bestFrame();if(t){t.center=this.bounds().center.add(t.x,t.y);var e=this._contentView.bestPosition();e&&(t.position=e),this._contentView.frame=t}}},a}(t.Component);o.BackgroundColor=t.Color.RGBf(0,0,0,.61),o._AllNeedFilters=new Array,o._AllOpenings=new Array,t.Desktop=o;var s=function(e){function n(t){var n=e.call(this)||this;return n._desktop=t,n}return __extends(n,e),n.prototype.start=function(){var e=this._desktop,n=e.delayOpenInQueue;n?t.Delay(n,e.doOpen,e):e.doOpen()},n}(t.Operation)}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._imp=new egret.HttpRequest,n._prg=new t.Percentage,t.EventHook(n._imp,egret.Event.COMPLETE,n.__cnt_completed,n),t.EventHook(n._imp,egret.IOErrorEvent.IO_ERROR,n.__cnt_error,n),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),this._imp=void 0},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.delegate=this},n.prototype._signalConnected=function(e,n){e==t.SignalChanged&&t.EventHook(this._imp,egret.ProgressEvent.PROGRESS,this.__cnt_progress,this)},n.prototype.start=function(){if(this.data=null,this.method==t.HttpMethod.GET)this._imp.open(this.fullUrl(),egret.HttpMethod.GET),this._imp.send();else if(this._imp.open(this.url,egret.HttpMethod.POST),this.fields){this._imp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var e=t.URL.MapToField(this.fields);this._imp.send(e)}else this._imp.send()},n.prototype.useCredentials=function(){this._imp.withCredentials=!0},n.prototype.__cnt_completed=function(e){this.data=this._imp?this._imp.response:null,this.signals.emit(t.SignalDone,this.data),this.signals.emit(t.SignalEnd)},n.prototype.__cnt_error=function(e){this.signals.emit(t.SignalFailed,new t.Failed(-1,"网络连接失败")),this.signals.emit(t.SignalEnd)},n.prototype.__cnt_progress=function(e){this._prg.max=e.bytesTotal,this._prg.value=e.bytesLoaded,this.signals.emit(t.SignalChanged,this._prg)},n}(t.CHttpConnector);t.HttpConnector=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this,n=document.querySelector(".egret-player");return t._node=document.createElement("div"),t._node.style.cssText="position:absolute;",n.appendChild(t._node),t}return __extends(n,e),n.prototype.dispose=function(){this._node.remove(),e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"text",{get:function(){return this._html},set:function(t){this._html=t,this._node.innerHTML=t;var e=this._node.children[0];e&&(e.style.width="100%",e.style.height="100%")},enumerable:!0,configurable:!0}),n.prototype.onAppeared=function(){e.prototype.onAppeared.call(this),this._node.style.display="block"},n.prototype.onDisappeared=function(){e.prototype.onDisappeared.call(this),this._node.style.display="none"},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this);var n=this.bounds();n=this.convertRectTo(n,null),n.x*=t.DomScaleFactorX*t.ScaleFactorX,n.y*=t.DomScaleFactorY*t.ScaleFactorY,n.x+=t.DomOffsetX,n.y+=t.DomOffsetY,n.width*=t.DomScaleFactorX*t.ScaleFactorX,n.height*=t.DomScaleFactorY*t.ScaleFactorY,this._node.style.left=n.x+"px",this._node.style.top=n.y+"px",this._node.style.width=n.width+"px",this._node.style.height=n.height+"px"},n}(t.CDom);t.Div=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return t.ObjectClass(n).BackgroundColor&&(n.backgroundColor=t.ObjectClass(n).BackgroundColor),t.ObjectClass(n).BackgroundImage&&(n.backgroundImage=t.ObjectClass(n).BackgroundImage),n.edgeInsets=new t.EdgeInsets(30,30,30,30),n.visible=!1,n}return __extends(n,e),n.prototype.onAppeared=function(){e.prototype.onAppeared.call(this),this.visible=!0},n.prototype.instanceDesktop=function(){var e=new t.Desktop(this);return e.desktopLayer=t.CApplication.shared.desktopLayer,e.backgroundColor=null,e.backgroundImage=null,e},n.prototype.open=function(){this._desk||(this._desk=this.instanceDesktop(),this._desk.open())},n.prototype.close=function(){this._desk&&(this._desk.close(),this._desk=null)},n.Text=function(e,n){void 0===n&&(n=2);var i=t.CApplication.shared.clazzHudText.instance();return i.message=e,i.open(),t.Delay(n,function(){i.close()},this),i},n.Error=function(e,n){void 0===n&&(n=2);var i=t.CApplication.shared.clazzHudText.instance();return i.message=e,i.mode=!1,i.open(),t.Delay(n,function(){i.close()},this),i},n.ShowProgress=function(){if(i.__hud_progress_counter+=1,i.__hud_progress)return void i.__hud_progress.open();var e=t.CApplication.shared.clazzHudProgress.instance();return e.open(),e},n.HideProgress=function(){i.__hud_progress_counter-=1,0==i.__hud_progress_counter&&i.__hud_progress.delayClose(),t.ISDEBUG&&i.__hud_progress_counter<0&&t.fatal("HudProgress 的计数器 <0， 正常逻辑下必须 >=0，可能执行了不匹配的 Show/Hide 过程")},n}(t.Sprite);e.BackgroundColor=new t.Color(16777215,240),t.Hud=e;var n=function(e){function n(){var n=e.call(this)||this;return n.labelMessage=new t.Label,n.labelMessage.textColor=0,n.labelMessage.textAlign="center",n.addChild(n.labelMessage),n}return __extends(n,e),n.prototype.instanceDesktop=function(){var t=e.prototype.instanceDesktop.call(this);return t._addIntoOpening=!1,t},Object.defineProperty(n.prototype,"message",{get:function(){return this.labelMessage.text},set:function(t){this._setMessage(t)},enumerable:!0,configurable:!0}),n.prototype._setMessage=function(t){this.labelMessage.text=t},n.prototype.open=function(){e.prototype.open.call(this),this._desk.touchEnabled=!1},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this.labelMessage.frame=this.boundsForLayout()},n.prototype.bestFrame=function(e){var n=.9*t.StageBounds.width,i=this.labelMessage.bestFrame(new t.Rect(0,0,n,0));return i=i.unapplyEdgeInsets(this.edgeInsets),i.x=i.y=0,i},n}(e);n.BackgroundColor=null,n.BackgroundImage=null,t.HudText=n;var i=function(e){function n(){var n=e.call(this)||this;return n._progressValue=new t.Percentage(1,0),n}return __extends(n,e),Object.defineProperty(n.prototype,"activity",{get:function(){return this._activity},set:function(t){this._activity!=t&&(this._activity&&this.removeChild(this._activity),this._activity=t,this._activity&&this.addChild(t))},enumerable:!0,configurable:!0}),n.Current=function(){return n.__hud_progress},Object.defineProperty(n.prototype,"progressValue",{get:function(){return this._progressValue},set:function(t){this._progressValue=t,this.updateData()},enumerable:!0,configurable:!0}),n.prototype.open=function(){this.__tmrdc&&(egret.clearTimeout(this.__tmrdc),this.__tmrdc=0),n.__hud_progress||(n.__hud_progress=this,e.prototype.open.call(this),this.__tmropen=egret.getTimer(),this._activity&&this._activity.startAnimation())},n.prototype.close=function(){e.prototype.close.call(this),n.__hud_progress==this&&(n.__hud_progress=null),this._activity&&this._activity.stopAnimation()},n.prototype.delayClose=function(t){return void 0===t&&(t=.3),this.__tmrdc&&egret.clearTimeout(this.__tmrdc),.001*(egret.getTimer()-this.__tmropen)>t?void this.close():void(this.__tmrdc=egret.setTimeout(this.doDelayClose,this,1e3*t))},n.prototype.doDelayClose=function(){egret.clearTimeout(this.__tmrdc),this.__tmrdc=0,this.close()},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this._activity&&(this._activity.frame=this.boundsForLayout())},n.prototype.bestFrame=function(e){return this._activity?this._activity.bestFrame():new t.Rect},n}(e);i.BackgroundColor=null,i.BackgroundImage=null,i.__hud_progress=null,i.__hud_progress_counter=0,t.HudProgress=i}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){return e.apply(this,arguments)||this}return __extends(n,e),n.prototype.launch=function(e){t.EventHook(e,egret.Event.ENTER_FRAME,this.onRendering,this),t.EventHook(e,egret.Event.RENDER,this.onPrepare,this)},n.prototype.onPrepare=function(){this.__invalidating=!1,e.prototype.onPrepare.call(this),this.__invalidating&&egret.callLater(this.invalidate,this)},n.prototype.invalidate=function(){this.__invalidating=!0,egret.MainContext.instance.stage.invalidate()},n}(t.CFramesManager);t._FramesManager=e,t.loader.InBoot(function(){t.FramesManager=new e})}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.horizonMode=!0,n._progressValue=new t.Percentage(1,0),n.clipsToBounds=!0,n.signals.connect(t.SignalTouchBegin,n.__sld_touchchanged,n),n.signals.connect(t.SignalTouchEnd,n.__sld_touchchanged,n),n.signals.connect(t.SignalTouchMove,n.__sld_touchchanged,n),n}return __extends(n,e),n.prototype.dispose=function(){this._progressValue=void 0,e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalChanged)},Object.defineProperty(n.prototype,"identifierView",{get:function(){return this._identifierView},set:function(t){this._identifierView!=t&&(this._identifierView&&this.removeChild(this._identifierView),this._identifierView=t,t&&this.addChild(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"progressValue",{get:function(){return this._progressValue},set:function(t){this._progressValue=t,this.updateLayout()},enumerable:!0,configurable:!0}),n.prototype.updateLayout=function(){if(e.prototype.updateLayout.call(this),null!=this._identifierView){var t=this.boundsForLayout(),n=this._identifierView.frame;this.horizonMode?(n.x=this._progressValue.safepercent*(t.width-n.width),n.y=t.y+.5*(t.height-n.height)):(n.y=this._progressValue.safepercent*(t.height-n.height),n.x=t.x+.5*(t.width-n.width)),this._identifierView.frame=n}},n.prototype.__sld_touchchanged=function(e){var n=e.data;if(this._identifierView){var i=this.boundsForLayout(),r=this._identifierView.frame;r.x+=n.delta.x;var o=r.center;o.x>i.width?(o=i.rightCenter,r.center=o):o.x<0&&(o=i.leftCenter,r.center=o),this._identifierView.frame=r;var s=o.x/i.width;s!=this.progressValue.percent&&(this.progressValue.percent=s,this.signals.emit(t.SignalChanged,this.progressValue))}},n}(t.Widget);t.Slider=e}(nn||(nn={}));var nn;!function(t){egret.sys.BitmapNode.$updateTextureDataWithScale9Grid=function(e,n,i,r,o,s,a,c,u,l,h,p){var d=o,f=s;h-=u-o*egret.$TextureScaleFactor,p-=l-s*egret.$TextureScaleFactor;var g=n.x-a,_=n.y-c,y=g/egret.$TextureScaleFactor,m=_/egret.$TextureScaleFactor,v=n.width/egret.$TextureScaleFactor,b=n.height/egret.$TextureScaleFactor;0==b&&(b=1,m>=f&&m--),0==v&&(v=1,y>=d&&y--),g*=t.ScaleFactorW,_*=t.ScaleFactorH;var S=i,w=S+y,T=w+v,C=d-y-v,O=r,E=O+m,x=E+b,P=f-m-b,A=C*egret.$TextureScaleFactor,R=P*egret.$TextureScaleFactor;if((y+C)*egret.$TextureScaleFactor>h||(m+P)*egret.$TextureScaleFactor>p)return void e.drawImage(i,r,o,s,a,c,h,p);A*=t.ScaleFactorW,R*=t.ScaleFactorH;var I=a,F=I+g,D=I+(h-A),M=h-g-A,k=c,j=k+_,L=k+p-R,N=p-_-R;m>0&&(y>0&&e.drawImage(S,O,y,m,I,k,g,_),v>0&&e.drawImage(w,O,v,m,F,k,M,_),C>0&&e.drawImage(T,O,C,m,D,k,A,_)),b>0&&(y>0&&e.drawImage(S,E,y,b,I,j,g,N),v>0&&e.drawImage(w,E,v,b,F,j,M,N),C>0&&e.drawImage(T,E,C,b,D,j,A,N)),P>0&&(y>0&&e.drawImage(S,x,y,P,I,L,g,R),v>0&&e.drawImage(w,x,v,P,F,L,M,R),C>0&&e.drawImage(T,x,C,P,D,L,A,R))}}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._selection=0,n._selsgrp=new t.SelectionsGroup,n._selsgrp.signals.connect(t.SignalSelectionChanged,n.__cbSelsChanged,n),n}return __extends(n,e),Object.defineProperty(n.prototype,"tabButtons",{get:function(){return this._selsgrp.elements()},set:function(e){t.fatal("不能直接设置tabButtons")},enumerable:!0,configurable:!0}),n.prototype.clear=function(){this._selsgrp.elements().forEach(function(t){t.removeFromParent()}),this._selsgrp.clear(),e.prototype.clear.call(this)},Object.defineProperty(n.prototype,"pages",{get:function(){return this._views},set:function(t){this.clear(),this.setViews(t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selection",{get:function(){return this._selection},set:function(t){this._selection!=t&&(this._selection=t,this._selsgrp.length&&(this._selsgrp.selection=t))},enumerable:!0,configurable:!0}),n.prototype._getPageTabButton=function(e,n){if(0==e.isnull()){var i=e.obj.tabButton;if(i&&-1!=this._selsgrp.indexOf(i)&&(i=null),null==i){var r=t.ObjectClass(e.obj).TabButton;return null==r&&(r=t.ObjectClass(this).TabButton),null==r&&t.fatal("没有提供 TabStack 用来实例化 TabButton 的方法"),i=r(e,n),e.obj.tabButton=i,i}return i}var o=e.clazz.TabButton;null==o&&(o=t.ObjectClass(this).TabButton),null==o&&t.fatal("没有提供 TabStack 用来实例化 TabButton 的方法");var s=o(e,n);return e.__tabbutton=s,s},n.prototype.setViews=function(t){var e=this;t!=this._views&&(this.clear(),t.forEach(function(t){e._views.push(t);var n=e._getPageTabButton(t,e._views.length-1);if(n&&(e._selsgrp.add(n),null==n.parent&&e.addChild(n)),0==t.isnull()){var i=t.obj;i.visible=!1,null==t.tabButton&&(t.tabButton=n),e._addPage(t,!1)}},this),this._selsgrp.selection=this._selection)},n.prototype._addPage=function(t,n){e.prototype._addPage.call(this,t,n);var i=t.obj;null==i.tabButton&&(i.tabButton=t.__tabbutton)},n.prototype.push=function(t,n){void 0===n&&(n=!0);var i=e.prototype.push.call(this,t,n);if(null==i)return null;var r=this._getPageTabButton(t,this._views.length-1);return r&&(this._selsgrp.add(r),null==r.parent&&this.addChild(r)),i},n.prototype.__cbSelsChanged=function(t){this._selection=this._selsgrp.selection,this.setTopView(this._views[this._selection])},n.prototype._emitSelectionChanged=function(e,n){this._signals&&this._signals.emit(t.SignalSelectionChanged,{now:e,old:n,nowTabButton:this._selsgrp.selectionItem,oldTabButton:this._selsgrp.previousSelectionItem})},n.prototype.setPageFrame=function(t){var e=this.boundsForLayout();t.frame=e},n}(t.ViewStack);t.TabStack=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.identifier=new t.Bitmap,n.identifier.anchor=t.Point.AnchorCC,n.identifier.frame=new t.Rect(0,0,50,50),n.addChild(n.identifier),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),this._target=void 0,this._base=void 0},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalRequestClose)},Object.defineProperty(n.prototype,"target",{get:function(){return this._target},enumerable:!0,configurable:!0}),n.prototype.onAppeared=function(){e.prototype.onAppeared.call(this),this._layoutTips()},n.prototype.showTo=function(e,n){var i=this;this._target=e,null==n&&(n=e.parent),this._base=n,this.signals.connect(t.SignalRequestClose,this.removeFromParent,this),n.addChild(this,!1),0==t.isZero(this.delayClose)&&t.Delay(this.delayClose,function(){i._base=null,i.removeFromParent()},this)},n.prototype.instanceDesktop=function(){var e=new t.Desktop;return e.adaptiveContentFrame=!1,e.clickedToClose=!0,e.onlyFiltersTouchEnabled=!0,e.delayClose=this.delayClose,e},n.prototype.popupTo=function(e,n){void 0===n&&(n=!0),this._target=e;var i=this.instanceDesktop();return i.contentView=this,i.addFilter(e),this.signals.connect(t.SignalRequestClose,i.close,i),this._base=i,n&&i.open(),i},n.prototype.close=function(){this.signals.emit(t.SignalRequestClose)},n.prototype._layoutTips=function(){var e,n=this._base.bounds(),i=this.bestFrame(),r=this._target.convertRectTo(this._target.bounds(),this._base),o=this.identifier.frame;if(r.maxX+o.width+i.width<n.maxX){e=t.Direction.RIGHT,this.identifier.rotation=t.Angle.ANGLE(-90),this.identifier.scale=new t.Point(-1,1);var s=r.rightCenter;i.x=r.maxX+o.width,i.y=s.y-i.height/2,i.maxX>n.maxX?i.maxX=n.maxX:i.minX<n.minX&&(i.minX=n.minX),i.maxY>n.maxY?i.maxY=n.maxY:i.minY<n.minY&&(i.minY=n.minY),o.x=-o.width,o.y=(i.height-o.height)/2;var a=new t.Rect(r.x-i.x,r.y-i.y,r.width,r.height);o.maxY>a.maxY?o.maxY=a.maxY:o.minY<a.minY&&(o.minY=a.minY)}else if(r.y-o.height-i.height>n.y){e=t.Direction.UP,this.identifier.rotation=t.Angle.ANGLE(180);var s=r.topCenter;i.x=s.x-i.width/2,i.y=r.y-o.height-i.height,i.maxX>n.maxX?i.maxX=n.maxX:i.minX<n.minX&&(i.minX=n.minX),i.maxY>n.maxY?i.maxY=n.maxY:i.minY<n.minY&&(i.minY=n.minY),o.x=(i.width-o.width)/2,o.y=i.height;var a=new t.Rect(r.x-i.x,r.y-i.y,r.width,r.height);o.maxX>a.maxX?o.maxX=a.maxX:o.minX<a.minX&&(o.minX=a.minX)}else if(r.x-o.width-i.width>n.x){e=t.Direction.LEFT,this.identifier.rotation=t.Angle.ANGLE(90);var s=r.leftCenter;i.x=r.x-o.width-i.width,i.y=s.y-i.height/2,i.maxX>n.maxX?i.maxX=n.maxX:i.minX<n.minX&&(i.minX=n.minX),i.maxY>n.maxY?i.maxY=n.maxY:i.minY<n.minY&&(i.minY=n.minY),o.x=i.width,o.y=(i.height-o.height)/2;var a=new t.Rect(r.x-i.x,r.y-i.y,r.width,r.height);o.maxY>a.maxY?o.maxY=a.maxY:o.minY<a.minY&&(o.minY=a.minY)}else{e=t.Direction.DOWN,this.identifier.rotation=t.Angle.ANGLE(0);var s=r.topCenter;i.x=s.x-i.width/2,i.y=r.y+o.height,i.maxX>n.maxX?i.maxX=n.maxX:i.minX<n.minX&&(i.minX=n.minX),i.maxY>n.maxY?i.maxY=n.maxY:i.minY<n.minY&&(i.minY=n.minY),o.x=(i.width-o.width)/2,o.y=-o.height;var a=new t.Rect(r.x-i.x,r.y-i.y,r.width,r.height);o.maxX>a.maxX?o.maxX=a.maxX:o.minX<a.minX&&(o.minX=a.minX)}this.frame=i,this.identifier.frame=o},n}(t.Sprite);t.Tips=e}(nn||(nn={}));var LZString=function(){function t(t,e){if(!r[t]){r[t]={};for(var n=0;n<t.length;n++)r[t][t.charAt(n)]=n}return r[t][e]}var e=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",r={},o={compressToBase64:function(t){if(null==t)return"";var e=o._compress(t,6,function(t){return n.charAt(t)});switch(e.length%4){default:case 0:return e;case 1:return e+"===";case 2:return e+"==";case 3:return e+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,function(i){return t(n,e.charAt(i))})},compressToUTF16:function(t){return null==t?"":o._compress(t,15,function(t){return e(t+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:o._decompress(t.length,16384,function(e){return t.charCodeAt(e)-32})},compressToUint8Array:function(t){for(var e=o.compress(t),n=new Uint8Array(2*e.length),i=0,r=e.length;r>i;i++){var s=e.charCodeAt(i);n[2*i]=s>>>8,n[2*i+1]=s%256}return n},decompressFromUint8Array:function(t){if(null===t||void 0===t)return o.decompress(t);for(var n=new Array(t.length/2),i=0,r=n.length;r>i;i++)n[i]=256*t[2*i]+t[2*i+1];var s=[];return n.forEach(function(t){s.push(e(t))}),o.decompress(s.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":o._compress(t,6,function(t){return i.charAt(t)})},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,function(n){return t(i,e.charAt(n))}))},compress:function(t){return o._compress(t,16,function(t){return e(t)})},_compress:function(t,e,n){if(null==t)return"";var i,r,o,s={},a={},c="",u="",l="",h=2,p=3,d=2,f=[],g=0,_=0;for(o=0;o<t.length;o+=1)if(c=t.charAt(o),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=p++,a[c]=!0),u=l+c,Object.prototype.hasOwnProperty.call(s,u))l=u;else{if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(i=0;d>i;i++)g<<=1,_==e-1?(_=0,f.push(n(g)),g=0):_++;for(r=l.charCodeAt(0),i=0;8>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1}else{for(r=1,i=0;d>i;i++)g=g<<1|r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r=0;for(r=l.charCodeAt(0),i=0;16>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1}h--,0==h&&(h=Math.pow(2,d),d++),delete a[l]}else for(r=s[l],i=0;d>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1;h--,0==h&&(h=Math.pow(2,d),d++),s[u]=p++,l=String(c)}if(""!==l){if(Object.prototype.hasOwnProperty.call(a,l)){if(l.charCodeAt(0)<256){for(i=0;d>i;i++)g<<=1,_==e-1?(_=0,f.push(n(g)),g=0):_++;for(r=l.charCodeAt(0),i=0;8>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1}else{for(r=1,i=0;d>i;i++)g=g<<1|r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r=0;for(r=l.charCodeAt(0),i=0;16>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1}h--,0==h&&(h=Math.pow(2,d),d++),delete a[l]}else for(r=s[l],i=0;d>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1;h--,0==h&&(h=Math.pow(2,d),d++)}for(r=2,i=0;d>i;i++)g=g<<1|1&r,_==e-1?(_=0,f.push(n(g)),g=0):_++,r>>=1;for(;;){if(g<<=1,_==e-1){f.push(n(g));break}_++}return f.join("")},decompress:function(t){return null==t?"":""==t?null:o._decompress(t.length,32768,function(e){return t.charCodeAt(e)})},_decompress:function(t,n,i){var r,o,s,a,c,u,l,h,p=[],d=4,f=4,g=3,_="",y=[],m={val:i(0),position:n,index:1};for(o=0;3>o;o+=1)p[o]=o;for(a=0,u=Math.pow(2,2),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;switch(r=a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;h=e(a);break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;h=e(a);break;case 2:return""}for(p[3]=h,s=h,y.push(h);;){if(m.index>t)return"";for(a=0,u=Math.pow(2,g),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;switch(h=a){case 0:for(a=0,u=Math.pow(2,8),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;p[f++]=e(a),h=f-1,d--;break;case 1:for(a=0,u=Math.pow(2,16),l=1;l!=u;)c=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(c>0?1:0)*l,l<<=1;p[f++]=e(a),h=f-1,d--;break;case 2:return y.join("")}if(0==d&&(d=Math.pow(2,g),g++),p[h])_=p[h];else{if(h!==f)return null;_=s+s.charAt(0)}y.push(_),p[f++]=s+_.charAt(0),d--,s=_,0==d&&(d=Math.pow(2,g),g++)}}};return o}(),nn;!function(t){function e(t,e,i,r,o,s){var a,c,u,l,h,p,d,f,g,_,y,m,v,b,S=new Array(16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756),w=new Array(-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344),T=new Array(520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584),C=new Array(8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928),O=new Array(256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080),E=new Array(536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312),x=new Array(2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154),P=new Array(268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696),A=n(t),R=0,I=e.length,F=0,D=32==A.length?3:9;
f=3==D?i?new Array(0,32,2):new Array(30,-2,-2):i?new Array(0,32,2,62,30,-2,64,96,2):new Array(94,62,-2,32,64,2,30,-2,-2),2==s?e+="        ":1==s?(u=8-I%8,e+=String.fromCharCode(u,u,u,u,u,u,u,u),8==u&&(I+=8)):s||(e+="\x00\x00\x00\x00\x00\x00\x00\x00");var M="",k="";for(1==r&&(g=o.charCodeAt(R++)<<24|o.charCodeAt(R++)<<16|o.charCodeAt(R++)<<8|o.charCodeAt(R++),y=o.charCodeAt(R++)<<24|o.charCodeAt(R++)<<16|o.charCodeAt(R++)<<8|o.charCodeAt(R++),R=0);I>R;){for(p=e.charCodeAt(R++)<<24|e.charCodeAt(R++)<<16|e.charCodeAt(R++)<<8|e.charCodeAt(R++),d=e.charCodeAt(R++)<<24|e.charCodeAt(R++)<<16|e.charCodeAt(R++)<<8|e.charCodeAt(R++),1==r&&(i?(p^=g,d^=y):(_=g,m=y,g=p,y=d)),u=252645135&(p>>>4^d),d^=u,p^=u<<4,u=65535&(p>>>16^d),d^=u,p^=u<<16,u=858993459&(d>>>2^p),p^=u,d^=u<<2,u=16711935&(d>>>8^p),p^=u,d^=u<<8,u=1431655765&(p>>>1^d),d^=u,p^=u<<1,p=p<<1|p>>>31,d=d<<1|d>>>31,c=0;D>c;c+=3){for(v=f[c+1],b=f[c+2],a=f[c];a!=v;a+=b)l=d^A[a],h=(d>>>4|d<<28)^A[a+1],u=p,p=d,d=u^(w[l>>>24&63]|C[l>>>16&63]|E[l>>>8&63]|P[63&l]|S[h>>>24&63]|T[h>>>16&63]|O[h>>>8&63]|x[63&h]);u=p,p=d,d=u}p=p>>>1|p<<31,d=d>>>1|d<<31,u=1431655765&(p>>>1^d),d^=u,p^=u<<1,u=16711935&(d>>>8^p),p^=u,d^=u<<8,u=858993459&(d>>>2^p),p^=u,d^=u<<2,u=65535&(p>>>16^d),d^=u,p^=u<<16,u=252645135&(p>>>4^d),d^=u,p^=u<<4,1==r&&(i?(g=p,y=d):(p^=_,d^=m)),k+=String.fromCharCode(p>>>24,p>>>16&255,p>>>8&255,255&p,d>>>24,d>>>16&255,d>>>8&255,255&d),F+=8,512==F&&(M+=k,k="",F=0)}return M+=k,M=M.replace(/\0*$/g,"")}function n(t){for(var e,n,i,r=new Array(0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964),o=new Array(0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697),s=new Array(0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272),a=new Array(0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144),c=new Array(0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256),u=new Array(0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488),l=new Array(0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746),h=new Array(0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568),p=new Array(0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578),d=new Array(0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488),f=new Array(0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800),g=new Array(0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744),_=new Array(0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128),y=new Array(0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261),m=t.length>8?3:1,v=new Array(32*m),b=new Array(0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0),S=0,w=0,T=0;m>T;T++){var C=t.charCodeAt(S++)<<24|t.charCodeAt(S++)<<16|t.charCodeAt(S++)<<8|t.charCodeAt(S++),O=t.charCodeAt(S++)<<24|t.charCodeAt(S++)<<16|t.charCodeAt(S++)<<8|t.charCodeAt(S++),i=252645135&(C>>>4^O);O^=i,C^=i<<4,i=65535&(O>>>-16^C),C^=i,O^=i<<-16,i=858993459&(C>>>2^O),O^=i,C^=i<<2,i=65535&(O>>>-16^C),C^=i,O^=i<<-16,i=1431655765&(C>>>1^O),O^=i,C^=i<<1,i=16711935&(O>>>8^C),C^=i,O^=i<<8,i=1431655765&(C>>>1^O),O^=i,C^=i<<1,i=C<<8|O>>>20&240,C=O<<24|O<<8&16711680|O>>>8&65280|O>>>24&240,O=i;for(var E=0;E<b.length;E++)b[E]?(C=C<<2|C>>>26,O=O<<2|O>>>26):(C=C<<1|C>>>27,O=O<<1|O>>>27),C&=-15,O&=-15,e=r[C>>>28]|o[C>>>24&15]|s[C>>>20&15]|a[C>>>16&15]|c[C>>>12&15]|u[C>>>8&15]|l[C>>>4&15],n=h[O>>>28]|p[O>>>24&15]|d[O>>>20&15]|f[O>>>16&15]|g[O>>>12&15]|_[O>>>8&15]|y[O>>>4&15],i=65535&(n>>>16^e),v[w++]=e^i,v[w++]=n^i<<16}return v}var i=function(){function t(){}return t.prototype.encode=function(t){return LZString.compress(t)},t.prototype.decode=function(t){return LZString.decompress(t)},t}();t.CodecString=i;var r=function(){function t(){}return t.prototype.encode=function(t){return LZString.compressToEncodedURIComponent(t)},t.prototype.decode=function(t){return LZString.decompressFromEncodedURIComponent(t)},t}();t.CodecUrl=r;var o=function(){function n(){}return Object.defineProperty(n.prototype,"iv",{get:function(){return this._iv},set:function(e){return e.length<7?void t.fatal("字符串的长度不能小于7"):void(this._iv=e)},enumerable:!0,configurable:!0}),n.prototype.encode=function(t){return e(this.key,t,1,this._iv?1:0,this._iv,null)},n.prototype.decode=function(t){return e(this.key,t,0,this.iv?1:0,this._iv,null)},n}();t.CrytoString=o;var s=function(){function e(){}return e.prototype.load=function(t){return e.Unavaliable?!1:(this._hdl=new JSZip(t),!0)},e.prototype.file=function(e,n,i,r){var o=this._hdl.file(e);if(null==o)return void i.call(r,null);switch(n){case t.ResType.JSON:var s=o.asText(),a=JSON.parse(s);i.call(r,a);break;case t.ResType.TEXT:i.call(r,o.asText())}},e}();s.Unavaliable="undefined"==typeof JSZip,t.ZipArchiver=s;var a=function(){function e(){}return e.prototype.load=function(n){if(e.Unavaliable)return!1;var i;try{var r=void 0;n instanceof ArrayBuffer?r=new Int8Array(n):t.fatal("lzma需要传入一个可以被转换成Int8Array的类型"),this.plain=LZMA.decompress(r),i=!0}catch(o){i=!1}return i},e.prototype.file=function(e,n,i,r){switch(n){case t.ResType.JSON:var o=JSON.parse(this.plain);i.call(r,o);break;case t.ResType.TEXT:i.call(r,this.plain)}},e}();a.Unavaliable="undefined"==typeof LZMA,t.LzmaArchiver=a}(nn||(nn={}));var nn;!function(t){var e=function(){function t(){}return t}();t.CKeyboard=e;var n=function(e){function n(){var t=e.apply(this,arguments)||this;return t._visible=!1,t}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalActivated),this._signals.register(t.SignalDeactivated)},Object.defineProperty(n.prototype,"visible",{get:function(){return this._visible},set:function(e){this._visible!=e&&(this._visible=e,this.signals.emit(e?t.SignalActivated:t.SignalDeactivated))},enumerable:!0,configurable:!0}),n}(t.SObject);t.Keyboard=new n}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.width=0,e.height=0,e}return __extends(e,t),e}(egret.BitmapText),n=function(n){function i(){var i=n.call(this)||this;return i._lbl=new e,i._fontScale=1,i._fontSource=null,i._imp.addChild(i._lbl),i.fontSize=t.CLabel.FontSize,i}return __extends(i,n),i.prototype.updateLayout=function(){if(n.prototype.updateLayout.call(this),null!=this._lbl.font){var e=this.boundsForLayout();if(e.width/=this._fontScale,e.height/=this._fontScale,this.impSetFrame(e,this._lbl),"center"==this.textAlign){var i=this._lbl.measuredWidth*t.ScaleFactorDeW;e.x=(e.width-i)*this._lbl.scaleX*.5}else if("right"==this.textAlign){var i=this._lbl.measuredWidth*t.ScaleFactorDeW;e.x=(e.width-i)*this._lbl.scaleX}var r=this._lbl.measuredHeight*t.ScaleFactorDeH;e.y=(e.height-r)*this._lbl.scaleY*.5,this.impSetFrame(e,this._lbl)}},Object.defineProperty(i.prototype,"fontSize",{get:function(){return this._fontSize*t.ScaleFactorDeS},set:function(e){var n=this;if(n._fontSize!=e){var i=n.characterSpacing,r=n.lineSpacing;e*=t.ScaleFactorS,n._fontSize=e,n._fontScale=e/t.CLabel.FontSize,n._lbl.scaleX=n._fontScale,n._lbl.scaleY=n._fontScale,n.characterSpacing=i,n.lineSpacing=r,n.setNeedsLayout()}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"characterSpacing",{get:function(){return this._lbl.letterSpacing*this._fontScale},set:function(t){this._lbl.letterSpacing=t/this._fontScale},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineSpacing",{get:function(){return this._lbl.lineSpacing*this._fontScale},set:function(t){this._lbl.lineSpacing=t/this._fontScale},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this._lbl.text},set:function(t){this._lbl.text=t,this.setNeedsLayout()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fontSource",{get:function(){var e=this._lbl.font;return null==e?this._fontSource:(t.COriginType.shared.imp=e,t.COriginType.shared)},set:function(e){var n=this;this._fontSource!=e&&(this._fontSource=e,t.ResManager.getBitmapFont(e,t.ResPriority.NORMAL,function(t){e==n._fontSource&&(n._lbl.font=t.use(),n.setNeedsLayout())},this))},enumerable:!0,configurable:!0}),i}(t.CBitmapLabel);t.BitmapLabel=n}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._store=new Array,t}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalSelectionChanged)},n.prototype.dispose=function(){this.clear(),e.prototype.dispose.call(this)},n.prototype.add=function(e){return void 0==e.states?void t.fatal("push a non state object"):(e.states.signals.connect(t.SignalStateChanged,this._cbStateChanged,this),void this._store.push(e))},n.prototype.clear=function(){var e=this;this._old=void 0,t.ArrayT.Clear(this._store,function(t){t.signals.disconnectOfTarget(e)},this)},n.prototype.elements=function(){return this._store},n.prototype._cbStateChanged=function(e){var n=e.sender.cbctx;n!=this._old&&(this._store.forEach(function(t){t!=n&&t.states.next(e.data,!0,!1)},this),this.signals.emit(t.SignalSelectionChanged,{now:n,old:this._old}),this._old=n)},Object.defineProperty(n.prototype,"selection",{get:function(){return t.ArrayT.QueryIndex(this._store,function(t){return t.isSelection&&t.isSelection()},this,-1)},set:function(e){var n=this._store[e];n.setSelection?n.setSelection(!0):t.warn("该对象不支持 setSelection 操作")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionItem",{get:function(){return t.ArrayT.QueryObject(this._store,function(t){return t.isSelection&&t.isSelection()},this)},set:function(e){e.setSelection?e.setSelection(!0):t.warn("该对象不支持 setSelection 操作")},enumerable:!0,configurable:!0}),n.prototype.indexOf=function(t){return this._store.indexOf(t)},Object.defineProperty(n.prototype,"previousSelectionItem",{get:function(){return this._old},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._store.length},enumerable:!0,configurable:!0}),n}(t.SObject);t.SelectionsGroup=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.itemClass=t.Sprite,n.nullItemClass=t.Sprite,n.dataSource=n,n}return __extends(n,e),n.prototype.numberOfItems=function(){return 0},n.prototype.classForItem=function(t){return this.itemClass},n.prototype.classForNullItem=function(){return this.nullItemClass},n.prototype.updateItem=function(t,e){},n.prototype.updateNullItem=function(t){},n.prototype.popUsedItem=function(){},n.prototype.useItem=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},n.prototype.unuseItem=function(t){},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this.reloadData()},n}(t.Sprite);t.CollectionView=e;var n=function(e){function n(){var n=e.call(this)||this;return n.maxItemsOnScreen=-1,n.selection=0,n.autoDock=!0,n._minIndex=0,n._allItems=0,n._nullItems=0,n._usedItems=new Array,n._reuseItems=new t.SimpleReusesPool(n.instanceItem,n),n.offsetPos=new t.Point,n._startPos=new t.Point,n.signals.connect(t.SignalTouchBegin,n._cv_touch_begin,n),n.signals.connect(t.SignalTouchMove,n._cv_touch_move,n),n.signals.connect(t.SignalTouchEnd,n._cv_touch_end,n),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalSelectionChanged)},n.prototype.reloadData=function(){var e=this;e.clear(),e._allItems=e.numberOfItems();var n=0;-1==e.maxItemsOnScreen?(e._nullItems=Math.floor(e._allItems/2),n=e._allItems-e.selection):(e._nullItems=Math.floor(e.maxItemsOnScreen/2),n=e.maxItemsOnScreen),e._minIndex=e.selection-e._nullItems;for(var i=e.dataSource.classForNullItem(),r=0;n>r;++r){var o=e._minIndex+r,s=void 0;s=0>o?i:o>=e._allItems?i:e.dataSource.classForItem(o);var a=e.useItem(s,!0);a.visible=!0}e._updateItems(!0);var c=e._usedItems[e._nullItems];c.signals.emit(t.SignalSelected),e.signals.emit(t.SignalSelectionChanged,{now:c})},n.prototype.popUsedItem=function(t){var e=this;if(0!=e._usedItems.length){null==t&&(t=e._usedItems.length-1);var n=this._usedItems[t];this.unuseItem(n)}},n.prototype.clear=function(){var e=this,n=this;t.ArrayT.Clear(n._usedItems,function(n){n.visible=!1,e._reuseItems.unuse(t.Classname(n),n)})},n.prototype.useItem=function(e,n){var i=t.Classname(e),r=this._reuseItems.use(i,null,[e]);return n?this._usedItems.push(r):t.ArrayT.InsertObjectAtIndex(this._usedItems,r,0),r},n.prototype.unuseItem=function(e){this._reuseItems.unuse(t.Classname(e),e),t.ArrayT.RemoveObject(this._usedItems,e)},n.prototype.updateItemSize=function(t,e,n){},n.prototype.updateItemsSize=function(t,e){},n.prototype.gotoNext=function(){var e=this,n=e._minIndex+e._usedItems.length;if(n>=this._allItems+this._nullItems)return!1;e.popUsedItem(0);var i=n>=this._allItems?this.dataSource.classForNullItem():this.dataSource.classForItem(n),r=this.useItem(i,!0);r.visible=!0,++e._minIndex,e.selection=e._minIndex+e._nullItems,this._startPos.copy(this.touch.currentPosition),this.offsetPos.reset(),this._updateItems(!0);var o=e._usedItems[e._nullItems-1],s=e._usedItems[e._nullItems];return e.signals.emit(t.SignalSelectionChanged,{now:s,old:o}),s.signals.emit(t.SignalSelected),o.signals.emit(t.SignalDeselected),!0},n.prototype.gotoPrevious=function(){var e=this,n=e._minIndex-1;if(n<-e._nullItems)return!1;e.popUsedItem();var i=0>n?this.dataSource.classForNullItem():this.dataSource.classForItem(n),r=this.useItem(i,!0);r.visible=!0,--e._minIndex,e.selection=e._minIndex+e._nullItems,this._startPos.copy(this.touch.currentPosition),this.offsetPos.reset(),this._updateItems(!0);var o=e._usedItems[e._nullItems+1],s=e._usedItems[e._nullItems];return e.signals.emit(t.SignalSelectionChanged,{now:s,old:o}),s.signals.emit(t.SignalSelected),o.signals.emit(t.SignalDeselected),!0},n.prototype.canGoto=function(){var t=this;if(t.thresholdSize)if(t.thresholdSize.width>0){if(t.offsetPos.x>0)return t._minIndex==-t._nullItems?!1:!0;if(t.offsetPos.x<0)return t._allItems-1==t._minIndex+t._nullItems?!1:!0}else{if(t.offsetPos.y>0)return t._minIndex==-t._nullItems?!1:!0;if(t.offsetPos.y<0)return t._allItems-1==t._minIndex+t._nullItems?!1:!0}return!0},n.prototype._updateItems=function(t){var e=this;if(e._usedItems.forEach(function(n,i){var r=e._minIndex+i;return 0>r?void(t&&(e.updateNullItem(n),n.updateData())):(t&&(e.updateItem(n,r),n.updateData()),void e.updateItemSize(n,r,i))}),e.thresholdSize)if(e.thresholdSize.width>0){var n=e.thresholdSize.width/2;if(e.offsetPos.x>=n){if(this.gotoPrevious())return}else if(e.offsetPos.x<=-n&&this.gotoNext())return}else{var n=e.thresholdSize.height/2;if(e.offsetPos.y>=n){if(this.gotoPrevious())return}else if(e.offsetPos.y<=-n&&this.gotoNext())return}this.updateItemsSize(this._usedItems,this._minIndex)},n.prototype.instanceItem=function(e){var n=new e;return n.signals.register(t.SignalSelected),n.signals.register(t.SignalDeselected),this.addChild(n),n},n.prototype._cv_touch_begin=function(){this._startPos.copy(this.touch.startPosition)},n.prototype._cv_touch_move=function(){var t=this.touch.currentPosition;this.offsetPos.reset(t.x-this._startPos.x,t.y-this._startPos.y),this.canGoto()&&this._updateItems(!1)},n.prototype._cv_touch_end=function(){var t=this;if(0!=t.offsetPos.x||0!=t.offsetPos.y){if(t.autoDock){if(t.thresholdSize){var e=!1;if(t.thresholdSize.width>0){var n=t.thresholdSize.width/2;t.offsetPos.x>n?e=t.gotoPrevious():t.offsetPos.x<-n&&(e=t.gotoNext())}else{var n=t.thresholdSize.height/2;t.offsetPos.y>n?e=t.gotoPrevious():t.offsetPos.y<-n&&(e=t.gotoNext())}if(0==e)return t.offsetPos.reset(),void t._updateItems(!0)}}t.offsetPos.reset()}},n}(e);t.CoverFlowView=n}(nn||(nn={}));var nn;!function(t){var e=function(){function e(t){this.props=t}return e.prototype.change=function(e){var n=this;null==this.props&&(this.props={}),t.MapT.Foreach(e,function(t,e){n.props[t]=e},this)},e.Text=function(t,n,i){return new e({text:t,textColor:n,fontSize:i})},e.Color=function(t,n){return new e({textColor:t,backgroundColor:n})},e.Image=function(t){return new e({imageSource:t})},e.BackgroundImage=function(t){return new e({backgroundImage:t})},e.Button=function(t,n,i){return new e({text:t,imageSource:n,backgroundImage:i})},e.As=function(t){if(t instanceof e)return t;var n=typeof t;return"string"==n?e.Text(t):new e},e.prototype.setIn=function(e){this.props&&t.MapT.Foreach(this.props,function(t,n){void 0!==n&&(e[t]=n)},this),this._children&&t.MapT.Foreach(this._children,function(t,n){n.setIn(e)},this)},Object.defineProperty(e.prototype,"children",{get:function(){return null==this._children&&(this._children=new KvObject),this._children},enumerable:!0,configurable:!0}),e.prototype.add=function(t,e){return this.children[t]=e,this},e.prototype.remove=function(t){return delete this.children[t],this},e}();t.State=e;var n=function(n){function i(){var t=n.call(this)||this;return t._states=new KvObject,t}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this),this._signals.register(t.SignalStateChanged)},i.prototype.dispose=function(){n.prototype.dispose.call(this),this.nullstate=void 0,this.nullobj=void 0,this._state=void 0,t.MapT.Clear(this._states)},Object.defineProperty(i.prototype,"state",{get:function(){return this._state},set:function(t){this.changeState(t)},enumerable:!0,configurable:!0}),i.prototype.changeState=function(e,n){if(void 0===n&&(n=!0),null==this.cbset)return this._state==e?!1:(this._state=e,!0);if(null==e&&(e=this.nullstate),e==this._state)return!1;var i=this._states[e];if(null==i){if(void 0===this.nullobj)return t.warn("state "+e+" not binded"),!1;i=this.nullobj}return this._state=e,this.cbset.call(this.cbctx,i),n&&this.signals.emit(t.SignalStateChanged,e),!0},i.prototype.next=function(e,n,i){var r=this.cbctx;void 0===i&&(i=!0),void 0===e&&(e=this._state),void 0===n&&r.isSelection&&(n=r.isSelection()),r.nextState?(e=r.nextState(e),this.changeState(e,i)):r.setSelection&&(i||this.signals.block(t.SignalStateChanged),r.setSelection(!n),i||this.signals.unblock(t.SignalStateChanged))},i.prototype.updateData=function(t){void 0===t&&(t=!0);var e=this._states[this._state];if(null==e){if(t&&void 0===this.nullobj)return;e=this.nullobj}this.cbset.call(this.cbctx,e)},i.prototype.bind=function(t,n,i){var r=n instanceof e?n:new e(n);return this._states[t]=r,i&&(this.nullstate=t),this},i.prototype.get=function(t){return this._states[t]},i}(t.SObject);t.States=n}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._bmpn=new t.Bitmap,n._bmpb=new t.Bitmap,n.direction=t.Direction.HOV,n._pos=0,n.addChild(n._bmpb),n.addChild(n._bmpn),n}return __extends(n,e),Object.defineProperty(n.prototype,"imageSource",{get:function(){return this._bmpn.imageSource},set:function(t){this._bmpn.imageSource=t,this._bmpb.imageSource=t},enumerable:!0,configurable:!0}),n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this);var t=this.boundsForLayout();this._bmpn.setSize(t.size),this._bmpb.setSize(t.size)},n.prototype.offset=function(t){this._pos+=t,this.position(this._pos)},n.prototype.position=function(e){var n=this._bmpn.frame;this.direction==t.Direction.HOV?n.x=e%n.width:n.y=e%n.height,this._bmpn.frame=n;var i=this._bmpb.frame;this.direction==t.Direction.HOV?n.x>=0?i.rightTop=n.leftTop:i.leftTop=n.rightTop:n.y>=0?i.leftBottom=n.leftTop:i.leftTop=n.leftBottom,this._bmpb.frame=i},n}(t.Widget);t.ContinuousBitmap=e}(nn||(nn={}));var nn;!function(t){function e(t){for(var e=[],n=t;n;)e.push(n),n=n.parent;return e}function n(n,i){var r=e(n),o=e(i),s=t.ArrayT.ArrayInArray(r,o);return s.length?s[0]:null}function i(t,e,n){for(var i=t.parent;i;){if(i instanceof e)return i;i=i.parent}return n}function r(t,e,n){for(var i=t.parent;i;){var r=e.call(n,i);if(r)return r;i=i.parent}return null}function o(e,n){var i=[];return e.children.forEach(function(e){e.tag==n&&i.push(e);var r=o(e,n);t.ArrayT.Concat(i,r)},this),i}function s(t){return t?egret.is(t,"egret.Stage")?!0:t.visible?s(t.parent):!1:!0}t.getParents=e,t.findAncestorView=n,t.findParentByType=i,t.queryParent=r,t.findElementsByTag=o,t.isAppearing=s}(nn||(nn={}));var nn;!function(t){function e(t){return t}t.T=e;var n=function(){function t(){}return t}();t.i18n=new n}(nn||(nn={}));var nn;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e._canvas=document.createElement("canvas"),e}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this),this._canvas=null,this._render=null},e.prototype.process=function(t){var e=t.textureWidth,n=t.textureHeight;this._canvas.width=e,this._canvas.height=n,this._render=this._canvas.getContext("2d"),this._render.drawImage(t._bitmapData,0,0);var i=this._render.getImageData(0,0,e,n);this.processdata(i.data),this._render.putImageData(i,0,0);var r=new Image;return r.src=this._canvas.toDataURL(),null},e.prototype.processdata=function(t){},e}(t.SObject);t.AbstractFilter=e;var n=function(e){function n(n){void 0===n&&(n=t.Color.White);var i=e.call(this)||this;return i.tint=n,i}return __extends(n,e),n.prototype.processdata=function(t){for(var e=this.tint.red,n=this.tint.green,i=this.tint.blue,r=this.tint.alpha,o=3;o<t.length;o+=4){var s=t[o-3]+t[o-2]+t[o-1];s=s/3/255,t[o-3]=s*e,t[o-2]=s*n,t[o-1]=s*i,t[o-0]=r}},n}(e);t.GrayFilter=n}(nn||(nn={}));var app;!function(t){var e;!function(t){}(e=t.dev||(t.dev={}))}(app||(app={}));var nn;!function(t){t.COLLECT_INSTRUMENT=!1;var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(t.dom.Label);t.IPLabel=e;var n=function(n){function i(){var t=n.call(this)||this;return t.lblDrawed=new e,t.lblCost=new e,t.lblFps=new e,t.lblDirty=new e,t.add(t.lblDrawed).br(),t.add(t.lblCost).br(),t.add(t.lblFps).br(),t.add(t.lblDirty).br(),t}return __extends(i,n),i.prototype.start=function(){t.COLLECT_INSTRUMENT=!0},i.prototype.stop=function(){t.COLLECT_INSTRUMENT=!1},i.prototype.updateData=function(){n.prototype.updateData.call(this),this.lblDrawed.content=(t.Device.shared.isCanvas?"Canvas":"WebGL")+" Drawed: "+t.COLLECT_DRAWS,this.lblCost.content="Cost: "+t.COLLECT_COST,this.lblFps.content="FPS: "+t.COLLECT_FPS,this.lblDirty.content="Dirty: "+t.COLLECT_DIRTYR+"%"},i}(t.dom.Sprite);t.ProfilerPanel=n;var i=function(n){function i(){var i=n.call(this)||this;return i.lblOrientation=new e,i.lblEnvSize=new e,i.lblNavi=new e,i.add(i.lblOrientation).br(),i.add(i.lblEnvSize).br(),i.add(i.lblNavi).br(),t.CApplication.shared.signals.connect(t.SignalFrameChanged,i.updateData,i),i}return __extends(i,n),i.prototype.updateData=function(){n.prototype.updateData.call(this),this.lblOrientation.content="Orientation: "+Js.getBrowserOrientation()+(void 0!=window.orientation?" SUPPORT":"");var e=Js.getBrowserSize(),i=Js.getScreenSize(),r=t.StageBounds.size;this.lblEnvSize.content="BrowserSize: "+e.width+","+e.height+" ScreenSize: "+i.width+","+i.height+" StageSize: "+r.width*t.ScaleFactorW+","+r.height*t.ScaleFactorH+" Resource: "+t.ResManager.directory,this.lblNavi.content=navigator.userAgent},i}(t.dom.Sprite);t.SystemInfoPanel=i;var r=function(e){function r(){var t=e.call(this)||this;return t.pnlSysinfo=new i,t.pnlProfiler=new n,t.pnlDebug=new o,t.css="position:absolute;bottom:0px;height:90%;width:100%;z-position:999;opacity:0.95;background:white;",t}return __extends(r,e),r.prototype.preload=function(t,e){Js.loadSources([["http://7xlcco.com1.z0.glb.clouddn.com/webix/webix.css",1],["http://7xlcco.com1.z0.glb.clouddn.com/webix/webix_debug.js",0]],t,e)},r.prototype.onLoaded=function(){e.prototype.onLoaded.call(this),webix.getElementById=function(t){return $$(t).getNode()},webix.ui({view:"tabview",cells:[{header:"INFO",body:{id:"::dt::info"}},{header:"DEBUG",body:{id:"::dt::debug"}}],multiview:{keepViews:!0},container:this.id});var n=t.dom.DomObject.From(webix.getElementById("::dt::info"));n.add(this.pnlSysinfo),n.add(this.pnlProfiler),n=t.dom.DomObject.From(webix.getElementById("::dt::debug")),n.add(this.pnlDebug)},r.prototype.open=function(){this.pnlSysinfo.updateData(),this.pnlProfiler.start()},r.prototype.close=function(){this.pnlProfiler.stop()},r.prototype.updateData=function(){e.prototype.updateData.call(this),this.pnlProfiler.updateData()},r}(t.dom.Sprite);t.InstrumentPanel=r;var o=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onLoaded=function(){t.prototype.onLoaded.call(this),null!=app.dev.main&&app.dev.main(this)},e}(t.dom.Sprite);t.DebugPanel=o;var s=function(e){function n(){var n=e.call(this)||this;return n.button=new t.dom.Button,n.panel=new r,n.button.content="调试器",n.button.css="position:absolute;top:0;left:50%;z-position:999;background:white;opacity:0.3;",n.button.signals.connect(t.SignalClicked,n.open,n),t.Dom.add(n.button),n}return __extends(n,e),n.run=function(){return t.ISNATIVE?void 0:(null==n.shared&&(n.shared=new n),n.shared)},n.prototype.open=function(){null==this.panel.parent&&t.Dom.add(this.panel),this.panel.visible=!0,this.button.signals.disconnect(t.SignalClicked),this.button.signals.connect(t.SignalClicked,this.close,this),this.panel.open()},n.prototype.close=function(){this.panel.visible=!1,this.button.signals.disconnect(t.SignalClicked),this.button.signals.connect(t.SignalClicked,this.open,this),this.panel.close()},n.prototype.updateData=function(){this.panel.updateData()},n}(t.SObject);t.Instrument=s,t.CApplication.InBoot(function(){t.ISDEBUG&&s.run()})}(nn||(nn={}));var nn;!function(t){var e;!function(e){function n(e,n){s.push({time:new t.DateTime,snapshot:n.snapshot(),reason:e,stack:Js.stacktrace()})}function i(e,n){return t.ArrayT.QueryObjects(s,function(i){return t.ObjectT.GetValueByKeyPath(i.snapshot,e)==n})}function r(e,n){n.add(e.time.toString("HH:mm:ss ")),n.add(e.reason).add(" "),n.add(t.vardump(e.snapshot)),n.line()}function o(e){void 0===e&&(e=s);var n=new t.StringBuilder;return e.forEach(function(t){r(t,n)}),n.toString()}var s=new Array;e.add=n,e.query=i,e.recordsStringify=o;var a=function(){function e(){}return e.RemoveObjectByFilter=function(e,i,r,o){var s=t.ArrayT.RemoveObjectByFilter(i,r,o);return s&&n(e,s),s},e.RemoveObjectsByFilter=function(e,i,r,o){var s=t.ArrayT.RemoveObjectsByFilter(i,r,o);return s.forEach(function(t){n(e,t)}),s},e.Convert=function(e,i,r,o){var s=t.ArrayT.Convert(i,r,o);return s.forEach(function(t){n(e,t)}),s},e}();e.ArrayT=a;var c=function(){function e(){}return e.RemoveObjectByFilter=function(e,i,r,o){var s=t.IndexedMapT.RemoveObjectByFilter(i,r,o);return s&&n(e,s[1]),s},e.RemoveObjectsByFilter=function(e,i,r,o){var s=t.IndexedMapT.RemoveObjectsByFilter(i,r,o);return s.forEach(function(t){n(e,t[1])}),s},e.Convert=function(e,i,r,o){var s=t.IndexedMapT.Convert(i,r,o);return s.forEach(function(t,i){n(e,i)}),s},e}();e.IndexedMapT=c}(e=t.journal||(t.journal={}))}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.placeholderTextColor=8224125,n.touchEnabled=!0,n._lbl.type=egret.TextFieldType.INPUT,t.EventHook(n._lbl,egret.FocusEvent.FOCUS_IN,n.__inp_focus,n),t.EventHook(n._lbl,egret.FocusEvent.FOCUS_OUT,n.__inp_blur,n),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalFocusGot),this._signals.register(t.SignalFocusLost)},n.prototype._signalConnected=function(n,i){e.prototype._signalConnected.call(this,n,i),n==t.SignalChanged&&t.EventHook(this._lbl,egret.Event.CHANGE,this.__lbl_changed,this)},n.prototype.hitTestClient=function(t,n){return e.prototype.hitTestClient.call(this,t,n)?this._lbl:null},Object.defineProperty(n.prototype,"readonly",{get:function(){return!this._lbl.touchEnabled},set:function(t){this._lbl.touchEnabled=!t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"securityInput",{get:function(){return this._lbl.displayAsPassword},set:function(t){this._lbl.displayAsPassword=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labelPlaceholder",{get:function(){return this._labelPlaceholder},set:function(t){t!=this._labelPlaceholder&&(this._labelPlaceholder&&this.removeChild(this._labelPlaceholder),this._labelPlaceholder=t,t&&this.addChild(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"placeholder",{get:function(){return this._labelPlaceholder?this._labelPlaceholder.text:""},set:function(e){if(null==this._labelPlaceholder){var n=new t.Label;n.textAlign=this.textAlign,n.fontSize=this.fontSize,n.textColor=this.placeholderTextColor,n.visible=0==this.text.length,n.multilines=this.multilines,this.labelPlaceholder=n}this._labelPlaceholder.text=e},enumerable:!0,configurable:!0}),n.prototype._setFontSize=function(t){e.prototype._setFontSize.call(this,t),this._labelPlaceholder&&(this._labelPlaceholder.fontSize=t)},n.prototype._setTextAlign=function(t){e.prototype._setTextAlign.call(this,t),this._labelPlaceholder&&(this._labelPlaceholder.textAlign=t)},n.prototype._setText=function(t){return e.prototype._setText.call(this,t)?(this._labelPlaceholder&&(this._labelPlaceholder.visible=0==t.length),!0):!1},Object.defineProperty(n.prototype,"multilines",{get:function(){return this._lbl.multiline},set:function(t){this._lbl.multiline=t,this._labelPlaceholder&&(this._labelPlaceholder.multilines=t)},enumerable:!0,configurable:!0}),n.prototype.__inp_focus=function(){t.Keyboard.visible=!0,this._labelPlaceholder&&(this._labelPlaceholder.visible=!1),this._signals&&this._signals.emit(t.SignalFocusGot)},n.prototype.__inp_blur=function(){t.Keyboard.visible=!1,this._labelPlaceholder&&0==this.text.length&&(this._labelPlaceholder.visible=!0),this._signals&&this._signals.emit(t.SignalFocusLost)},n.prototype.__lbl_changed=function(e){this._scaleToFit&&this.doScaleToFit(),this._signals.emit(t.SignalChanged,this.text)},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),this._labelPlaceholder&&this._labelPlaceholder.setFrame(this.boundsForLayout())},n}(t.Label);t.TextField=e}(nn||(nn={}));var egret;if(function(t){var e;!function(t){}(e=t.web||(t.web={}))}(egret||(egret={})),nn.ISHTML5){var FUNC_TEXTHOOK_1=egret.web.$cacheTextAdapter;egret.web.$cacheTextAdapter=function(t,e,n,i){function r(e){var n=t._stageText.$textfield;if(n){var i=n.parent;i._need_fix_textadapter&&i._signals&&(null==i.keyboard&&(i.keyboard=new nn.CKeyboard),i.keyboard.key=e.key,i.keyboard.code=e.keyCode,i._signals.emit(nn.SignalKeyPress,i.keyboard))}}FUNC_TEXTHOOK_1(t,e,n,i);var o=t._simpleElement,s=t._multiElement;o&&o.onkeypress!=FUNC_TEXTHOOK_1&&(o.onkeypress=r),s&&s.onkeypress!=FUNC_TEXTHOOK_1&&(s.onkeypress=r)}}var nn;!function(t){var e=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.applyTransform=function(t){return t._mat.transformPoint(this.x,this.y,this),this},e}(t.Point);t.Vector2d=e;var n=function(t){function n(){return t.apply(this,arguments)||this}return __extends(n,t),n.prototype.applyTransform=function(t){var n=new e(this.x,this.y);return n.applyTransform(t),this.x=n.x,this.y=n.y,this},n}(t.Rect);t.Rect2d=n;var i=function(){function t(){this._mat=new egret.Matrix}return t.prototype.scale=function(t){return this._mat.scale(t.x,t.y),this},t.prototype.rotate=function(t){return this._mat.rotate(t.rad),this},t.prototype.translate=function(t){return this._mat.translate(t.x,t.y),this},t.prototype.invert=function(){return this._mat.invert(),this},t.prototype.identity=function(){return this._mat.identity(),this
},t}();t.Transform2d=i;var r=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),this._v[0]=t,this._v[1]=e,this._v[2]=n,this._v[3]=i}return Object.defineProperty(t.prototype,"x",{get:function(){return this._v[0]},set:function(t){this._v[0]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._v[1]},set:function(t){this._v[1]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._v[2]},set:function(t){this._v[2]=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._v[3]},set:function(t){this._v[3]=t},enumerable:!0,configurable:!0}),t}();t.Vector3d=r;var o=function(){function t(){}return t}();t.Transform3d=o}(nn||(nn={}));var nn;!function(t){var e=function(){function e(t){this._ctx=t}return e.prototype.useAnchor=function(t){return this.anchor=t,this},e.prototype.setRect=function(t){return null==this._orc?this._orc=t:(this._orc.x=t.x,this._orc.y=t.y,this._orc.width=t.width,this._orc.height=t.height),this._rc=this._orc.clone().applyEdgeInsets(this.edgeInsets),this},Object.defineProperty(e.prototype,"frame",{get:function(){return this._avaRect(),this._orc.clone()},set:function(t){this.setRect(t)},enumerable:!0,configurable:!0}),e.prototype._avaRect=function(){return this._orc?!1:(this._ctx?this._orc=this._ctx.boundsForLayout():(this._orc=new t.Rect,t.warn("没有设置 Box 的 Rect")),this._rc=this._orc.clone().applyEdgeInsets(this.edgeInsets),!0)},e.prototype.frameForLayout=function(){return this._avaRect(),this._rc.clone()},e.prototype.padding=function(t){return this.edgeInsets=t,0==this._avaRect()&&(this._rc=this._orc.clone().applyEdgeInsets(this.edgeInsets)),this},e.prototype.offset=function(t){return this._avaRect(),this._orc.offset(t),this._rc.offset(t),this},e.prototype.apply=function(){this._avaRect(),this._offset=0,this.view&&(this.view.setFrame(this._rc),this.setRect(this.view.boundsForLayout()))},e.prototype.complete=function(t,e){this._cbcomplete=t,this._ctxcomplete=e},e}();t.Layout=e;var n=function(){function e(){}return e.prototype.dispose=function(){this.obj=void 0,this.cb=void 0,this.ctx=void 0,this.data=void 0},e.prototype.setRect=function(e,n,i,r){this.cb?this.cb.call(this.ctx,this.obj,new t.Rect(e,n,i,r),this.data):this.obj&&this.obj instanceof t.CComponent&&this.obj.setFrame(new t.Rect(e,n,i,r),this.anchor)},e}();t.LinearSegment=n;var i=function(e){function i(){var t=e.apply(this,arguments)||this;return t._segments=new Array,t.spacing=0,t}return __extends(i,e),i.prototype.setSpacing=function(t){return this.spacing=t,this},i.prototype.clear=function(){t.ArrayT.Clear(this._segments,function(t){t.dispose()})},i.prototype.addPixel=function(t,e,i,r,o){var s=new n;return s.val=t,s.isp=!0,s.obj=e,s.cb=i,s.ctx=r?r:this._ctx,s.data=o,s.anchor=this.anchor,this._segments.push(s),this},i.prototype.addFlex=function(t,e,i,r,o){var s=new n;return s.val=t,s.isp=!1,s.obj=e,s.cb=i,s.ctx=r?r:this._ctx,s.data=o,s.anchor=this.anchor,this._segments.push(s),this},i.prototype.addPixelHBox=function(t,e,n,i){return this.addPixel(t,null,function(t,n,i){var o=new r(this).setRect(n);e.call(this,o,i),o.apply()},n,i),this},i.prototype.addPixelVBox=function(t,e,n,i){return this.addPixel(t,null,function(t,n,i){var r=new o(this).setRect(n);e.call(this,r,i),r.apply()},n,i),this},i.prototype.addFlexHBox=function(t,e,n,i){return this.addFlex(t,null,function(t,n,i){var o=new r(this).setRect(n);e.call(this,o,i),o.apply()},n,i),this},i.prototype.addFlexVBox=function(t,e,n,i){return this.addFlex(t,null,function(t,n,i){var r=new o(this).setRect(n);e.call(this,r,i),r.apply()},n,i),this},i.prototype.addAspect=function(t,e,n,i,r,o){return this.addPixel(t/e*this.against(),n,i,r,o)},i.prototype.addAspectHBox=function(t,e,n,i,r){return this.addPixelHBox(t/e*this.against(),n,i,r)},i.prototype.addAspectVBox=function(t,e,n,i,r){return this.addPixelVBox(t/e*this.against(),n,i,r)},i.prototype.apply=function(){var t=this;e.prototype.apply.call(this);var n=0,i=0;this._segments.forEach(function(t){t.isp?n+=t.val:i+=t.val},this);var r=this.length()-n,o=i?r/i:0;this._segments.forEach(function(e,n){var i=0;i=e.isp?e.val:e.val*o,t._offset+=t.setSegmentLength(i,e,n)},this),this._cbcomplete&&this._cbcomplete.call(this._ctxcomplete?this._ctxcomplete:this._ctx),this.clear()},i.prototype._spacingsLength=function(){var t=this;if(0==t.spacing)return 0;var e=t._segments.length;return e>1?t.spacing*(e-1):0},i.prototype.clipPixel=function(t,e,n,i,r,o,s){return void 0===n&&(n=1),void 0===i&&(i=1),0!=n&&this.addFlex(n),this.addPixel(t,e,r,o,s),0!=i&&this.addFlex(i),this},i.prototype.clipFlex=function(t,e,n,i,r,o,s){return 0!=n&&this.addPixel(n),this.addFlex(t,e,r,o,s),0!=i&&this.addPixel(i),this},i.prototype.clipPixelHBox=function(t,e,n,i,r,o){return void 0===n&&(n=1),void 0===i&&(i=1),0!=n&&this.addFlex(n),this.addPixelHBox(t,e,r,o),0!=i&&this.addFlex(i),this},i.prototype.clipFlexHBox=function(t,e,n,i,r,o){return 0!=n&&this.addPixel(n),this.addFlexHBox(t,e,r,o),0!=i&&this.addPixel(i),this},i.prototype.clipPixelVBox=function(t,e,n,i,r,o){return void 0===n&&(n=1),void 0===i&&(i=1),0!=n&&this.addFlex(n),this.addPixelVBox(t,e,r,o),0!=i&&this.addFlex(i),this},i.prototype.clipFlexVBox=function(t,e,n,i,r,o){return 0!=n&&this.addPixel(n),this.addFlexVBox(t,e,r,o),0!=i&&this.addPixel(i),this},i}(e);t.LinearLayout=i;var r=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.length=function(){return this._rc.width-this._spacingsLength()},e.prototype.against=function(){return this._avaRect(),this._rc.height},e.prototype.setSegmentLength=function(t,e,n){var i=this;return e.setRect(i._offset+i._rc.x,i._rc.y,t,i._rc.height),i.spacing&&n+1<i._segments.length&&(t+=i.spacing),t},e}(i);t.HBox=r;var o=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.length=function(){return this._rc.height-this._spacingsLength()},e.prototype.against=function(){return this._avaRect(),this._rc.width},e.prototype.setSegmentLength=function(t,e,n){var i=this;return e.setRect(i._rc.x,i._offset+i._rc.y,i._rc.width,t),i.spacing&&n+1<i._segments.length&&(t+=i.spacing),t},e}(i);t.VBox=o;var s;!function(t){t[t.Fix=0]="Fix",t[t.Stretch=1]="Stretch"}(s=t.FlowOption||(t.FlowOption={}));var a=function(){function e(){}return e.prototype.dispose=function(){this.obj=void 0,this.cb=void 0,this.ctx=void 0,this.data=void 0},e.prototype.setRect=function(e,n,i){this.cb?this.cb.call(this.ctx,this.obj,new t.Rect(e,n,i,this.h),this.data):this.obj&&this.obj instanceof t.CComponent&&this.obj.setFrame(new t.Rect(e,n,i,this.h),this.anchor)},e}();t.FlowSegment=a;var c=function(e){function n(t){var n=e.call(this,t)||this;return n._segments=new Array,n}return __extends(n,e),n.prototype.clear=function(){t.ArrayT.Clear(this._segments,function(t){t.dispose()})},n.prototype.addSize=function(t,e,n,i,r,o,s){void 0===n&&(n=0);var c=new a;return c.w=t,c.h=e,c.option=n,c.obj=i,c.cb=r,c.ctx=o?o:this._ctx,c.data=s,c.anchor=this.anchor,this._segments.push(c),this},n.prototype.apply=function(){var n=this;e.prototype.apply.call(this),this._avaRect(),this.position=this._rc.leftTop;var i=this._rc.width,r=(this._rc.height,0),o=0,s=new Array;this._segments.forEach(function(e){r+e.w<=i?(r+=e.w,o<e.h&&(o=e.h),s.push(e)):(n.applyRows(s,n.position,i),t.ArrayT.Clear(s),n.position.y+=o,r=e.w,o=e.h,s.push(e))},this),s.length&&(this.applyRows(s,this.position,i),t.ArrayT.Clear(s),this.position.y+=o),this._cbcomplete&&this._cbcomplete.call(this._ctxcomplete?this._ctxcomplete:this._ctx),this.clear()},n.prototype.applyRows=function(t,e,n){var i=this;this._offset=0;var r=0,o=0;t.forEach(function(t){t.option==s.Stretch&&(r+=1),o+=t.w},this),r=r?(n-o)/r:0,t.forEach(function(t){var n=t.w;t.option==s.Stretch&&(n+=r),t.setRect(i._offset+e.x,e.y,n),i._offset+=n})},n}(e);t.HFlow=c}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.labelProgress=new t.Label,n.labelVersion=new t.Label,n._progressValue=new t.Percentage,n.labelProgress.textColor=0,n.labelProgress.textAlign="center",n.addChild(n.labelProgress),n.labelVersion.textColor=0,n.labelVersion.textAlign="center",n.labelVersion.text="版本:"+t.APPVERSION,n.addChild(n.labelVersion),n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this)},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalDone)},n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this),new t.VBox(this).setRect(this.bounds()).addFlex(1).addPixel(30,this.labelProgress).addFlex(1).addPixel(30,this.labelVersion).apply()},Object.defineProperty(n.prototype,"progressValue",{get:function(){return this._progressValue},set:function(t){this._progressValue=t,this.updateData()},enumerable:!0,configurable:!0}),n.prototype.updateData=function(){e.prototype.updateData.call(this),this.labelProgress.bringFront(),this.labelVersion.bringFront(),this.labelProgress.text="正在加载"+this._progressValue.value+"/"+this._progressValue.max},n.prototype.onLoaded=function(){e.prototype.onLoaded.call(this),this.prepare()},n.prototype.complete=function(){this.close()},n.prototype.close=function(){this.signals.emit(t.SignalDone)},n.prototype.prepare=function(){this.start()},n.prototype.start=function(){this.signals.emit(t.SignalStart)},n}(t.Sprite);t.LoadingScreen=e}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),this.detach()},n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalChanged),this._signals.register(t.SignalCancel),this._signals.register(t.SignalEnd),this._signals.register(t.SignalDone)},n.prototype.attach=function(t){return null==t?void this.detach():(this._spr=t,this._spr.gestures.push(this),void this.doAttach())},n.prototype.doAttach=function(){},n.prototype.detach=function(){null!=this._spr&&(this.doDetach(),t.ArrayT.RemoveObject(this._spr.gestures,this),this._spr=null)},n.prototype.doDetach=function(){},n}(t.SObject);t.Gesture=e;var n=function(e){function n(){var t=e.call(this)||this;return t.count=0,t._tms=0,t}return __extends(n,e),n.prototype.doAttach=function(){this._spr.signals.connect(t.SignalClicked,this.__cb_tap,this)},n.prototype.doDetach=function(){this._spr.signals.disconnectOfTarget(this)},n.prototype.__cb_tap=function(){var e=t.DateTime.Now();e-this._tms>this.interval&&(this.count=0,this._tms=e),this.count++,this.signals.emit(t.SignalDone)},n}(e);t.GestureTap=n;var i=function(e){function n(t){void 0===t&&(t=1.3);var n=e.call(this)||this;return n.duration=t,n}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),t.drop(this._tmr)},n.prototype.doAttach=function(){this._spr.signals.connect(t.SignalTouchBegin,this.__cb_touchbegin,this),this._spr.signals.connect(t.SignalTouchEnd,this.__cb_touchend,this),this._spr.signals.connect(t.SignalTouchMove,this.__cb_touchmove,this)},n.prototype.doDetach=function(){this._spr.signals.disconnectOfTarget(this)},n.prototype.__cb_touchbegin=function(){null!=this._tmr&&t.warn("长按的定时器应该当触摸开始时为 null"),this._tmr=new t.SysTimer(this.duration,1),this._tmr.signals.connect(t.SignalDone,this.__cb_timer,this),this._tmr.start()},n.prototype.__cb_touchend=function(e){var n=this;this._tmr?(this._tmr=t.drop(this._tmr),this.signals.emit(t.SignalCancel)):(this._spr.signals.block(t.SignalClicked),t.Defer(function(){n._spr.signals.unblock(t.SignalClicked)},this))},n.prototype.__cb_touchmove=function(){this._tmr&&(this._tmr=t.drop(this._tmr),this.signals.emit(t.SignalCancel))},n.prototype.__cb_timer=function(){this._tmr=t.drop(this._tmr),this.signals.emit(t.SignalDone)},n}(e);t.GestureLongTap=i;var r=function(e){function n(){var n=e.call(this)||this;return n.lastPosition=new t.Point,n.currentPosition=new t.Point,n.deltaPosition=new t.Point,n.stat=0,n.velocity=new t.Point,n.thresholdInterval=.3,n}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalDone)},n.prototype.reset=function(){this.stat=0,this.velocity.reset(0,0)},n.prototype.addPosition=function(e,n){return 0==this.stat?(this.lastPosition.reset(e,n),this.currentPosition.reset(e,n),this.lastTime=this.currentTime=t.DateTime.Now(),void++this.stat):(this.lastTime=this.currentTime,this.currentTime=t.DateTime.Now(),this.deltaTime=this.currentTime-this.lastTime,this.lastPosition.copy(this.currentPosition),this.currentPosition.reset(e,n),this.deltaPosition.reset(this.currentPosition.x-this.lastPosition.x,this.currentPosition.y-this.lastPosition.y),this.velocity.reset(0,0),this.deltaTime&&this.velocity.reset(this.deltaPosition.x/this.deltaTime,this.deltaPosition.y/this.deltaTime),this.deltaTime<=this.thresholdInterval&&this.doPosition(),void++this.stat)},n.prototype.doPosition=function(){},n.prototype.majorDirection=function(e){void 0===e&&(e=new t.Point(30,30));var n=t.Direction.UNKNOWN,i=this.deltaPosition;return i.x>e.x?n|=t.Direction.RIGHT:i.x<-e.x&&(n|=t.Direction.LEFT),i.y>e.y?n|=t.Direction.DOWN:i.y<-e.y&&(n|=t.Direction.UP),n},n}(t.SObject);t.GestureRecognizer=r;var o=function(e){function n(){var t=e.call(this)||this;return t._recognizer=new r,t}return __extends(n,e),n.prototype.doAttach=function(){this._spr.signals.connect(t.SignalTouchBegin,this.__cb_touchbegin,this),this._spr.signals.connect(t.SignalTouchEnd,this.__cb_touchend,this)},n.prototype.doDetach=function(){this._spr.signals.disconnectOfTarget(this)},n.prototype.__cb_touchbegin=function(t){this._recognizer.reset();var e=t.data;this._recognizer.addPosition(e.currentPosition.x,e.currentPosition.y)},n.prototype.__cb_touchend=function(e){var n=e.data;this._recognizer.addPosition(n.currentPosition.x,n.currentPosition.y),this._recognizer.deltaTime<=.3&&(this.direction=this._recognizer.majorDirection(),this.signals.emit(t.SignalDone,this.direction))},n}(e);t.GestureSwipe=o}(nn||(nn={}));var nn;!function(t){var e=function(){function e(){}return e.prototype.instanceParticle=function(e){var n=RES.getRes(e+"_png");if(null==n)return t.warn("particle "+e+"_png not found"),null;var i=RES.getRes(e+"_json");if(null==i)return t.warn("particle "+e+"_json not found"),null;var r=new particle.GravityParticleSystem(n,i);return null==r&&t.warn("particle "+e+" instance failed"),r},e}();t._ParticlesManager=e,t.ParticlesManager=new e;var n=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this),this.stopAnimation()},Object.defineProperty(n.prototype,"name",{get:function(){return this._name},set:function(e){this._name!=e&&(this._name=e,this.system=t.ParticlesManager.instanceParticle(this._name))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"system",{get:function(){return this._system},set:function(t){this._system!=t&&(this._system&&(this.stopAnimation(),this._imp.removeChild(this._system)),this._system=t,this._system&&(this._imp.addChild(this._system),this.startAnimation()),this.updateLayout())},enumerable:!0,configurable:!0}),n.prototype.updateLayout=function(){if(e.prototype.updateLayout.call(this),this._system){var t=this.bounds();t.x=.5*t.width-this._system.emitterX,t.y=.5*t.height-this._system.emitterY,this.impSetFrame(t,this._system)}},n.prototype.startAnimation=function(){this._system&&this._system.start()},n.prototype.stopAnimation=function(){this._system&&this._system.stop()},n}(t.Widget);t.Particle=n}(nn||(nn={}));var egret;!function(t){t.VERSION_2_5_6=t.MAKE_VERSION(2,5,6)}(egret||(egret={}));var nn;!function(t){t.IMP_TIMEPASS=function(){return.001*egret.getTimer()},t.IMP_CREATE_TIMER=function(t,e){return new egret.Timer(1e3*t,e)},t.IMP_START_TIMER=function(t,e,n){t.addEventListener(egret.TimerEvent.TIMER,e,n),t.start()},t.IMP_STOP_TIMER=function(t,e,n){t.stop(),t.removeEventListener(egret.TimerEvent.TIMER,e,n)};var e=function(){var t="::n2::test::localstorage::mode";if(egret.localStorage.setItem(t,"test"))return egret.localStorage.removeItem(t),0;if(window&&window.sessionStorage)try{return window.sessionStorage.setItem(t,"test"),window.sessionStorage.removeItem(t),1}catch(e){}return-1}();if(0==e)t.IMP_STORAGE_GET=egret.localStorage.getItem,t.IMP_STORAGE_SET=egret.localStorage.setItem,t.IMP_STORAGE_DEL=egret.localStorage.removeItem,t.IMP_STORAGE_CLEAR=egret.localStorage.clear;else if(1==e)t.IMP_STORAGE_GET=function(t){return window.sessionStorage.getItem(t)},t.IMP_STORAGE_SET=function(t,e){window.sessionStorage.setItem(t,e)},t.IMP_STORAGE_DEL=function(t){window.sessionStorage.removeItem(t)},t.IMP_STORAGE_CLEAR=function(){window.sessionStorage.clear()};else{var n={};t.IMP_STORAGE_GET=function(t){return n[t]},t.IMP_STORAGE_SET=function(t,e){n[t]=e},t.IMP_STORAGE_DEL=function(t){delete n[t]},t.IMP_STORAGE_CLEAR=function(){n={}}}t.Defer=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];egret.callLater.apply(null,[t,e].concat(n))};var i=t.Point.prototype;i.setTo=function(t,e){this.x=t,this.y=e},Js.OverrideFunction(egret,"getQualifiedClassName",function(t,e){return"_fmui"in e?e._fmui.descriptionName:t(e)})}(nn||(nn={}));var nn;!function(t){var e=function(){function t(){}return t.process=function(e){t.completeCall["call_"+t._regID]=function(n){var i=t._regID;e.__mdl_completed(n),delete t.completeCall["call_"+i]},t.start(e,t._regID++)},t.start=function(t,e){var n=document.createElement("script");t.modelcallback="nn._CrossLoader.completeCall.call_"+e,n.src=t.url(),document.body.appendChild(n)},t}();e._regID=0,e.completeCall={},t._CrossLoader=e;var n=function(n){function i(){return n.apply(this,arguments)||this}return __extends(i,n),i.prototype._initSignals=function(){n.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalSucceed),this._signals.register(t.SignalFailed),this._signals.register(t.SignalEnd),this._signals.register(t.SignalTimeout)},i.prototype.post=function(t,e,n){t.showWaiting=!1,t.showError=!1,this.fetch(t,e,n)},i.prototype.fetch=function(n,i,r,o,s){if(n.ts=t.DateTime.Now(),r&&n.attach(r),i&&n.signals.connect(t.SignalSucceed,i,r),o&&n.signals.connect(t.SignalFailed,o,r),s&&n.signals.connect(t.SignalEnd,s,r),n.cacheTime&&!n.cacheFlush){var a=t.Memcache.shared.query(n.keyForCache());if(a)return t.VERBOSE&&t.log("成功获取到缓存数据"),n.__mdl_start(),n.response=a,n.processResponse(),void n.__mdl_end()}if(n.cacheFlush=!0,n._urlreq=new t.HttpConnector,n.withCredentials&&n._urlreq.useCredentials(),n._urlreq.signals.connect(t.SignalDone,n.__mdl_completed,n),n._urlreq.signals.connect(t.SignalFailed,n.__mdl_failed,n),n.__mdl_start(),n.iscross())e.process(n);else{var c=n.url();c+=-1==c.indexOf("?")?"?":"&",c+="_ts_="+n.ts,this.SID&&(c+="&_sid="+this.SID),n._urlreq.url=c,n._urlreq.method=n.method,n._urlreq.fields=n.fields(),n._urlreq.start()}},i.prototype.fetchs=function(t,e,n){var i=this,r=[],o=function(t,s){return s==t.length?void e.call(n,r):void i.fetch(t[s++],function(e){r.push(e),o(t,s)},null)};o(t,0)},i}(t.SObject);n.__sequenceId=0,t.RestSession=new n;var i=function(e){function n(){return e.apply(this,arguments)||this}return __extends(n,e),n.prototype.url=function(){if(this.useproxy()){var e="http://gameapi.wyb.u1.hgame.com/web/index.php?r=redirect/redirect",n={};return n.url=this.request,n.method=this.method==t.HttpMethod.POST?"post":"get",n.uid=t.CApplication.shared.uniqueId,e+="&data=",e+=t.URL.encode(JSON.stringify(n))}return this.request},n.prototype.urlForLog=function(){return this.request},n}(t.Model);t.UrlModel=i}(nn||(nn={}));var RES;!function(t){var e=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r._priority=nn.ResCurrentPriority,r}return __extends(e,t),e}(t.ResourceItem),n=function(){function t(){this.length=0,this.items=[new Array,new Array]}return t.prototype.push=function(t){var e=this.items[t._priority];e.push(t),++this.length},t.prototype.pop=function(){if(0==this.length)return null;var t=this.items[nn.ResPriority.NORMAL],e=t.pop();return null==e&&(t=this.items[nn.ResPriority.CLIP],e=t.pop()),--this.length,e},t}();t.ResourceItem=e;var i,r=t.ResourceLoader.prototype,o=r.loadItem;r.loadItem=function(t){var e=this;i||(null==e.lazyLoadList&&nn.fatal("Egret引擎升级RES的LazyLoadList方法，请检查引擎修改"),e.lazyLoadList=new n,i=!0),o.call(e,t)}}(RES||(RES={}));var nn;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._hashCode=0,t._sources=new KvObject,t._keys=new KvObject,t.enable=!0,t}return __extends(i,e),i.prototype.doRemoveObject=function(n){var i=this;e.prototype.doRemoveObject.call(this,n);var r=this._sources[n.key];r.forEach(function(e){RES.destroyRes(e),t.VERBOSE&&t.log("释放资源 "+e),delete i._keys[e]}),delete this._sources[n.key]},i.prototype.add=function(e,r){var o;if(null==r)o="::mc::null";else if("hashCode"in r)o=r.hashCode;else{if("object"!=typeof r){var s=new t.CacheRecord;return s.val=r,s}o=r[i.IDR_HASHCODE],null==o&&(o="::mc::"+this._hashCode++,r[i.IDR_HASHCODE]=o)}var a=this._sources[o];null==a?(a=[e],this._sources[o]=a):a.push(e),this._keys[e]=o;var c=new n;return c.key=o,c.data=r,this.cache(c)},i.prototype.query=function(t){var n=this._keys[t];return e.prototype.query.call(this,n)},i}(t.Memcache);e.IDR_HASHCODE="::mc::hashCode",t._ResMemcache=e;var n=function(){function t(){this.cacheFlush=!0,this.cacheUpdated=!0,this.cacheTime=-1}return t.prototype.keyForCache=function(){return this.key},t.prototype.valueForCache=function(){return this.data},t}(),i=function(e){function n(t,n){var i=e.call(this,t)||this;return i._ewd=n,i}return __extends(n,e),n.prototype.dispose=function(){this._ewd=void 0,e.prototype.dispose.call(this)},n.prototype.loadOne=function(e,n,i){var r=this,o=0;if(e instanceof t.ResourceEntity){var s=e;t.ResManager.getSourceByType(s.source,t.ResPriority.NORMAL,function(e){r.signals.isConnected(t.SignalChanged)&&(o=1,r._idx+=1,r.signals.emit(t.SignalChanged,new t.Percentage(r._total,r._idx))),n.call(i)},this,s.type)}else{var a=e;if(RES.isGroupLoaded(a)){if(this.signals.isConnected(t.SignalChanged)){var c=RES.getGroupByName(a).length;o=c,this._idx+=c,this.signals.emit(t.SignalChanged,new t.Percentage(this._total,this._idx))}n.call(i)}else this._ewd.add("::res::group::"+a,n,i),this.signals.isConnected(t.SignalChanged)&&this._ewd.add("::res::group::progress::"+a,function(e){var n=e.itemsLoaded-o;o=e.itemsLoaded,r._idx+=n,r.signals.emit(t.SignalChanged,new t.Percentage(r._total,r._idx))},this),RES.loadGroup(a)}},n.prototype.total=function(){var e=0;return this._reqRes.forEach(function(n){e+=n instanceof t.ResourceEntity?1:RES.getGroupByName(n).length}),e},n}(t.CResCapsule);t.ResCapsule=i;var r={};r[t.ResType.JSON]=RES.ResourceItem.TYPE_JSON,r[t.ResType.TEXTURE]=RES.ResourceItem.TYPE_IMAGE,r[t.ResType.TEXT]=RES.ResourceItem.TYPE_TEXT,r[t.ResType.FONT]=RES.ResourceItem.TYPE_FONT,r[t.ResType.SOUND]=RES.ResourceItem.TYPE_SOUND,r[t.ResType.BINARY]=RES.ResourceItem.TYPE_BIN;var o=function(n){function o(){var i=n.call(this)||this;return i._ewd=new t.EventWeakDispatcher,i.cache=new e,i._capsules=new KvObject,RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,i._cfg_loaded,i),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,i._grp_complete,i),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,i._grp_failed,i),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,i._grp_progress,i),RES.setMaxLoadingThread(4),i}return __extends(o,n),o.prototype.loadConfig=function(t,e,n){this._ewd.add("::res::config",e,n),-1==t.indexOf("://")&&(t=this.directory+t),RES.loadConfig(t,this.directory)},Object.defineProperty(o.prototype,"cacheEnabled",{get:function(){return this.cache.enable},set:function(t){this.cache.enable=t},enumerable:!0,configurable:!0}),o.prototype._cfg_loaded=function(t){var e="::res::config";this._ewd.invoke(e,t,!1),this._ewd.remove(e)},o.prototype._grp_complete=function(t){var e="::res::group::"+t.groupName,n="::res::group::progress::"+t.groupName;this._ewd.invoke(e,t,!1),this._ewd.remove(e),this._ewd.remove(n)},o.prototype._grp_failed=function(t){this._grp_complete(t)},o.prototype._grp_progress=function(e){var n=e.resItem;n.type==RES.ResourceItem.TYPE_BIN&&t.FontFilePattern.test(n.url)&&t.FontsManager.add(n.name,n.url);var i="::res::group::progress::"+e.groupName;this._ewd.invoke(i,e,!1)},o.prototype.isGroupsArrayLoaded=function(t){if(t)for(var e=0;e<t.length;++e)if(0==RES.isGroupLoaded(t[e]))return!1;return!0},o.prototype.capsules=function(t){var e=i.HashKey(t),n=this._capsules[e];return null==n&&(n=new i(t,this._ewd),this._capsules[e]=n),n},o.prototype.removeCapsule=function(t){var e=t.hashKey();t.drop(),delete this._capsules[e]},o.prototype.tryGetRes=function(e){var n=this.cache.query(e);if(null==n){var i=RES.getRes(e);if(!i)return new t.CacheRecord;n=this.cache.add(e,i)}return n},o.prototype.getResAsync=function(e,n,i,r){var o=this;if(0==t.length(e))return void i.call(r,new t.CacheRecord);var s=this.cache.query(e);null==s?(t.ResCurrentPriority=n,RES.getResAsync(e,function(n){n?s=o.cache.add(e,n):(s=new t.CacheRecord,t.warn("res "+e+" not found")),i.call(r,s)},this)):i.call(r,s)},o.prototype["if"]=function(e){void 0==RES.configInstance&&t.fatal("ResManager 存在兼容问题")},o.prototype.getResUrl=function(e){var n=RES.configInstance.keyMap[e];return null==n?(t.warn("res "+e+" not found"),null):n.url},o.prototype.getResByUrl=function(e,n,i,o,s){var a=this,c=this.cache.query(e);return null!=c?void i.call(o,c):(t.ResCurrentPriority=n,void RES.getResByUrl(e,function(t){c=a.cache.add(e,t),i.call(o,c)},this,r[s]))},o.prototype.hasAsyncUri=function(t){return null!=this.cache.query(t)},o.prototype.getTexture=function(e,n,i,r){if(e instanceof t.COriginType){var o=new t.CacheRecord;return o.val=e.imp,void i.call(r,o)}if(e instanceof egret.Texture){var o=new t.CacheRecord;return o.val=e,void i.call(r,o)}this.getSourceByType(e,n,i,r,t.ResType.TEXTURE)},o.prototype.getBitmapFont=function(e,n,i,r){if(e instanceof t.COriginType){var o=new t.CacheRecord;return o.val=e.imp,void i.call(r,o)}if(e instanceof egret.BitmapFont){var o=new t.CacheRecord;return o.val=e,void i.call(r,o)}if(e instanceof t.FontConfig){var s=e;return void(s.name?this.getSourceByType(s.name,n,i,r,t.ResType.FONT):this.getSources([[s.texture,t.ResType.TEXTURE],[s.config,t.ResType.JSON]],n,function(e){var n=e[0],o=e[1],s=new t.CacheRecord;s.val=new egret.BitmapFont(n.use(),o.use()),i.call(r,s)},this))}this.getSourceByType(e,n,i,r,t.ResType.FONT)},o.prototype.getSound=function(e,n,i,r){if(e instanceof t.COriginType){var o=new t.CacheRecord;return o.val=e.imp,void i.call(r,o)}if(e instanceof egret.Sound){var o=new t.CacheRecord;return o.val=e,void i.call(r,o)}this.getSourceByType(e,n,i,r,t.ResType.SOUND)},o}(t.CResManager);t._ResManager=o,t.ResManager=new o}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._oldmessages=new Array,t}return __extends(n,e),n.Prepare=function(t,e){t.call(e)},n.prototype.support=function(t){return!0},n.prototype.pay=function(e){var n=new t.Failed(-1,"模拟的服务不支持购买\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.payable=function(t){return!0},n.prototype.share=function(e){e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.profile=function(e){e.avatar="",e.islogin=!0,e.nickname="::mock::",e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.status=function(e){e.appmode=!1,e.phone=!1,e.subscribe=!1,e.monetaryName="元",e.monetaryRate=1,e.monetaryDiscount=null,e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.auth=function(e){var n=t.CApplication.shared.url.fields,i=n.openid;null==i&&(i=t.CApplication.shared.uniqueId),e.pid=i,e.app="",e.platform=t.svc.Platform.MOCK,e.channel=0,e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.login=function(e){e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.switchuser=function(e){var n=new t.Failed(-1,"模拟的服务不支持切换用户\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.logout=function(t){location.reload()},n.prototype.loading=function(e){e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.bind=function(e){var n=new t.Failed(-1,"模拟的服务不支持绑定\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.subscribe=function(e){var n=new t.Failed(-1,"模拟的服务不支持关注\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.bbs=function(e){var n=new t.Failed(-1,"模拟的服务不支持论坛\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.report=function(e){e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.getapp=function(e){var n=new t.Failed(-1,"模拟的服务不支持微端\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.sendtodesktop=function(e){var n=new t.Failed(-1,"模拟的服务不支持桌面\n请通过平台入口运行游戏");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.lanzuan=function(e){var n=new t.Failed(-1,"模拟的服务不支持蓝钻开通");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.lanzuanxufei=function(e){var n=new t.Failed(-1,"模拟的服务不支持蓝钻续费开通");t.Hud.Text(n.message),e.signals.emit(t.SignalFailed,n),e.dispose()},n.prototype.customer=function(e){if(e instanceof t.svc.SendCustomerContent){var n=e;e.signals.emit(t.SignalSucceed),e.dispose();var i=new t.svc.Message;i.id=this._oldmessages.length,i.message=n.message,i.senderName="我",this._oldmessages.push(i),this.signals.emit(t.svc.SignalMessagesGot,this._oldmessages)}else e.all&&this.signals.emit(t.svc.SignalMessagesGot,this._oldmessages),e.signals.emit(t.SignalSucceed),e.dispose()},n.IsCurrent=function(){return!1},n}(t.svc.Service);t.ServiceMock=e;var n=function(t){function n(){return t.apply(this,arguments)||this}return __extends(n,t),n.prototype.detectService=function(){return e},n}(t.ServicesManager);t.MockServices=n}(nn||(nn={}));var hGameHdl,nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t._maxmessages=100,t._oldmessages=new Array,t}return __extends(n,e),n.Prepare=function(e,n){var i=this;if(hGameHdl)return void e.call(n);try{var r=new hGame({game_key:this.GameKey,debug:t.ISDEBUG}),o=new t.OperationQueue;o.add(new t.OperationClosure(function(t){r.ready(function(){hGameHdl=r,t.done()})})),o.add(new t.OperationClosure(function(e){hGameHdl.getPlatform(function(n){var r=n.data;switch(i.PLATFORM=r.platform.toUpperCase(),i.PLATFORM){case"wybosys":case"HGAME":i.PLATFORMID=t.svc.Platform.XHB;break;case"WANBA":i.PLATFORMID=t.svc.Platform.WANBA;break;case"QQGAME":i.PLATFORMID=t.svc.Platform.QQGAME;break;case"QQBROWSER":i.PLATFORMID=t.svc.Platform.QQBROWSER;break;case"X360":i.PLATFORMID=t.svc.Platform.X360;break;case"X360ZS":i.PLATFORMID=t.svc.Platform.X360ZS}"payUnit"in r&&(i.PAYUNIT=r.payUnit),"payRate"in r&&(i.PAYRATE=r.payRate),e.done()})})),o.add(new t.OperationClosure(function(t){e.call(n)}))}catch(s){t.exception(s),hGameHdl=null,e.call(n)}},n.prototype._doResult=function(e,n,i,r){if(0==e.code)i(e.data),n.signals.emit(t.SignalSucceed);else{var o=new t.Failed(e.code,e.message,e.showMessage);r&&r(o),n.signals.emit(t.SignalFailed,o)}n.dispose()},n.prototype.support=function(e){var n;switch(e){case t.svc.Feature.PAY:case t.svc.Feature.PROFILE:case t.svc.Feature.AUTH:case t.svc.Feature.LOGIN:case t.svc.Feature.LOGOUT:case t.svc.Feature.CUSTOMER:case t.svc.Feature.REPORT:n=!0;break;case t.svc.Feature.LANZUAN:n=!0;break;case t.svc.Feature.SHARE:if(n="share"in this._dataStatus){var i=t.ObjectT.GetValueByKeyPath(this._dataStatus,"share.status",1);n=i>0}break;case t.svc.Feature.GETAPP:n="client"in this._dataStatus;break;case t.svc.Feature.DESKTOP:n="toDesktop"in this._dataStatus;break;case t.svc.Feature.BBS:n="bbs"in this._dataStatus;break;case t.svc.Feature.SUBSCRIBE:n="subscribe"in this._dataStatus;
break;case t.svc.Feature.BIND:n="bindPhone"in this._dataStatus;break;case t.svc.Feature.SWITCHUSER:hGameHdl.changeAccount({open_id:this._pid,action:"query"},function(t){n=0==t.code});break;default:n=!1}return n},n.prototype.pay=function(e){var n=this;hGameHdl.pay(t.toJsonObject(e.data),null,function(i){n._doResult(i,e,function(t){},function(e){t.Hud.Text(e.locationMessage)})})},n.prototype.payable=function(e){return t.Device.shared.isIOS&&n.PLATFORMID==t.svc.Platform.QQBROWSER?388>e:!0},n.prototype.share=function(e){var n,i=this;n=e.data?t.toJsonObject(e.data):{open_id:this._pid,title:e.title,message:e.detail,imgUrl:e.image,url:e.url,extend:{}},hGameHdl.doExtraAction("share",n,function(t){i._doResult(t,e,function(t){i._setStatus("share.status",0)})})},n.prototype.profile=function(t){var e=this;hGameHdl.getUserInfo(function(n){e._doResult(n,t,function(e){t.avatar=e.avatar,t.islogin=1!=e.is_guest,t.nickname=e.nickname})})},n.prototype.status=function(e){e.appmode=1==t.ObjectT.GetValueByKeyPath(this._dataStatus,"client.status"),e.phone=1==t.ObjectT.GetValueByKeyPath(this._dataStatus,"bindPhone.status"),e.subscribe=1==t.ObjectT.GetValueByKeyPath(this._dataStatus,"subscribe.status"),e.monetaryName=n.PAYUNIT,e.monetaryRate=n.PAYRATE,n.PLATFORMID==t.svc.Platform.WANBA?e.monetaryDiscount=1:e.monetaryDiscount=null,e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.auth=function(e){var i=t.CApplication.shared.url.fields;if(n.IsCurrent())e.pid="",e.type=t.toInt(i.login_type),e.ticket=i.ticket,e.timestamp=i.timestamp,e.nonce=i.nonce,e.signature=i.signature;else{var r=i.openid;null==r&&(r=t.CApplication.shared.uniqueId),e.pid=r}e.alert&&hGameHdl.setGameFunc("alert",function(t,n,i){e.alert({msg:n,title:t,done:function(){i()}})}),e.confirm&&hGameHdl.setGameFunc("confirm",function(t,n,i,r){e.confirm({msg:n,title:t,done:function(){i()},cancel:function(){r()}})}),e.prompt&&hGameHdl.setGameFunc("prompt",function(t,n,i,r){e.prompt({msg:n,title:t,done:function(t){i(t)},cancel:function(){r()}})}),e.app=n.GameKey,e.platform=n.PLATFORMID,e.channel=0,e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype.login=function(e){var n=this;this._pid=t.asString(e.pid),e.maxCustomerMessages&&(this._maxmessages=e.maxCustomerMessages),hGameHdl.queryExtraStatus({openId:this._pid},function(i){n._dataStatus=i,e.signals.emit(t.SignalSucceed),e.dispose()})},n.prototype.switchuser=function(t){var e=this;hGameHdl.changeAccount({open_id:this._pid,action:"do"},function(n){e._doResult(n,t,function(t){})})},n.prototype.logout=function(t){hGameHdl.logout()},n.prototype.loading=function(e){hGameHdl.loadingProgress(t.toInt(e.current/e.total*100)),e.signals.emit(t.SignalSucceed),e.dispose()},n.prototype._setStatus=function(e,n){var i=t.ObjectT.GetValueByKeyPath(this._dataStatus,e);i!=n&&(t.ObjectT.SetValueByKeyPath(this._dataStatus,e,n),this.signals.cast(t.svc.SignalStatusChanged))},n.prototype.bind=function(e){var n,i=this;n=e.data?t.toJsonObject(e.data):{open_id:this._pid,autoRedirect:!0},hGameHdl.doExtraAction("bindPhone",n,function(t){i._doResult(t,e,function(t){e.phone=!0,i._setStatus("bindPhone.status",1)})})},n.prototype.subscribe=function(e){var n,i=this;n=e.data?t.toJsonObject(e.data):{open_id:this._pid,autoRedirect:!0},hGameHdl.doExtraAction("subscribe",n,function(t){i._doResult(t,e,function(t){e.subscribe=!0,i._setStatus("subscribe.status",1)})})},n.prototype.bbs=function(e){var n,i=this;n=e.data?t.toJsonObject(e.data):{open_id:this._pid},hGameHdl.doExtraAction("bbs",n,function(t){i._doResult(t,e,function(t){})})},n.prototype.report=function(e){var i,r={game_key:n.GameKey,open_id:this._pid,role:t.asString(e.roleId),nickname:e.nickname,area:t.asString(e.region),group:t.asString(e.server)},o={level:e.level,vipLevel:t.asString(e.viplevel),score:t.toInt(e.score),isNew:e.newuser?1:0,progress:t.asString(e.progress)};switch(e.type){case t.svc.ReportType.LOGIN:i="enterGame";break;case t.svc.ReportType.ROLE:i="createRole";break;case t.svc.ReportType.UPGRADE:i="levelUpgrade";break;case t.svc.ReportType.PROGRESS:i="processReport";break;case t.svc.ReportType.SCORE:i="scoreReport"}hGameHdl.gameReport(i,r,o,function(n){t.log("汇报数据 "+i),n&&0==n.code?e.signals.emit(t.SignalSucceed):(t.dump(r),t.dump(o),t.dump(n),e.signals.emit(t.SignalFailed)),e.dispose()})},n.prototype.getapp=function(e){var n,i=this;n=e.data?t.toJsonObject(e.data):{open_id:this._pid},hGameHdl.doExtraAction("client",n,function(t){i._doResult(t,e,function(t){})})},n.prototype.sendtodesktop=function(e){var n;n=e.data?t.toJsonObject(e.data):{open_id:this._pid},hGameHdl.doExtraAction("toDesktop",n,function(n){e.signals.emit(t.SignalSucceed),e.dispose()})},n.prototype.lanzuan=function(e){hGameHdl.callPsdk("NewOpenGameVIPService",[3,null,function(n){e.signals.emit(t.SignalSucceed),e.dispose()}])},n.prototype.lanzuanxufei=function(e){hGameHdl.callPsdk("NewGameVIPAction",[n.QQAPPID,function(n){e.signals.emit(t.SignalSucceed),e.dispose()},null,null,null,null,n.GameKey,e.notifyUrl])},n.prototype.customer=function(e){var n=this;if(this._customer_running){if(e instanceof t.svc.SendCustomerContent){var i=e,r=void 0;r=i.data?t.toJsonObject(i.data):{content:i.message,level:i.level,vipLevel:i.viplevel},hGameHdl.customerServicePost(r),e.signals.emit(t.SignalSucceed)}else e.all&&this.signals.emit(t.svc.SignalMessagesGot,this._oldmessages),e.signals.emit(t.SignalSucceed);return void e.dispose()}this._customer_running=!0,hGameHdl.customerServiceStart(t.toJsonObject(e.data),function(e){e.forEach(function(e){var i=new t.svc.Message;i.id=e.id,i.message=e.content,i.senderName=e.nickname,n._oldmessages.push(i)}),n._oldmessages.length>n._maxmessages&&(n._oldmessages=t.ArrayT.RangeOf(n._oldmessages,-n._maxmessages)),n.signals.emit(t.svc.SignalMessagesGot,n._oldmessages)},function(n){n?e.signals.emit(t.SignalSucceed):e.signals.emit(t.SignalFailed),e.dispose()})},n.IsCurrent=function(){var e=new t.URL(Js.siteUrl).fields;return"game_key"in e&&"timestamp"in e&&"nonce"in e&&"login_type"in e&&"ticket"in e&&"game_url"in e&&"signature"in e},n}(t.svc.Service);e.ID="::wybosys::xiaohuoban",e.DESCRIPTION={NAME:"小伙伴平台",CONTACT:"客服QQ:800098876"},e.PLATFORM="wybosys",e.PAYUNIT="元",e.PAYRATE=1,t.ServiceXHB=e,t.ServicesManager.register(e);var n=function(n){function i(){return n.apply(this,arguments)||this}return __extends(i,n),i.prototype.detectService=function(){return e.IsCurrent()?e:t.ISDEBUG?t.ServiceMock:e},i}(t.ServicesManager);t.XHBServices=n,Js.siteUrl=hGame.fullGameUrl}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(t,n){var i=e.call(this)||this;i.spacing=0,i.cells=new Array;for(var r=0;t>r;++r){var o=new n;i.addChild(o),i.cells.push(o)}return i}return __extends(n,e),n.prototype.updateLayout=function(){e.prototype.updateLayout.call(this);var n=new t.HBox(this);n.spacing=this.spacing,this.cells.forEach(function(t){n.addFlex(1,t)}),n.apply()},n.prototype.itemAtIndex=function(t){return this.cells[t].item},n.prototype.setItemAtIndex=function(t,e){this.cells[e].item=t},n.prototype.updateData=function(){e.prototype.updateData.call(this),this.cells.forEach(function(t){t.updateData()})},n.prototype.reuseAll=function(e){this.cells.forEach(function(n){var i=n.item;null!=i&&(t.grab(i),n.item=null,e.unuse(t.Classname(i),i))})},n}(t.Sprite);t.GridCellsItem=e;var n=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"item",{get:function(){return this._item},set:function(t){this._item!=t&&(this._item&&this.removeChild(this._item),this._item=t,t&&this.addChild(t))},enumerable:!0,configurable:!0}),e.prototype.updateData=function(){t.prototype.updateData.call(this),this._item&&this._item.updateData()},e.prototype.updateLayout=function(){t.prototype.updateLayout.call(this),this._item&&(this._item.frame=this.boundsForLayout())},e}(t.Sprite);t.GridViewCell=n;var i=function(i){function r(){var r=i.call(this)||this;return r.gridCellClass=n,r._reuseGridItems=new t.SimpleReusesPool(r.instanceGridItem,r),r.rowClass=e,r}return __extends(r,i),Object.defineProperty(r.prototype,"gridDataSource",{get:function(){return this.dataSource},set:function(t){this.dataSource=t},enumerable:!0,configurable:!0}),r.prototype.instanceItem=function(t){var e=new t(this.numberOfColumns,this.gridCellClass);return e.spacing=this.spacing,e},r.prototype.instanceGridItem=function(t){return new t},r.prototype.updateRow=function(e,n,r){for(var o=this.numberOfColumns,s=this.gridDataSource.numberOfItems(),a=0;o>a;++a){var c=r*o+a;if(c>=s)e.setItemAtIndex(null,a);else{var u=this.gridDataSource.classForItem(r,a,c),l=t.Classname(u),h=this._reuseGridItems.use(l,null,[u]);e.setItemAtIndex(h,a),this.gridDataSource.updateItem(h,r,a,c)}}i.prototype.updateRow.call(this,e,n,r)},r.prototype.addOneReuseItem=function(t){t.reuseAll(this._reuseGridItems),i.prototype.addOneReuseItem.call(this,t)},r}(t.TableViewContent);t.GridViewContent=i;var r=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.instanceTable=function(){return new i},Object.defineProperty(e.prototype,"grid",{get:function(){return this._table},enumerable:!0,configurable:!0}),e.prototype.numberOfItems=function(){return 0},e.prototype.classForItem=function(t,e,n){return this._table.itemClass},e.prototype.updateItem=function(t,e,n,i){},e.prototype.numberOfRows=function(){var t=this.numberOfItems(),e=this._table.numberOfColumns;return Math.ceil(t/e)},e}(t.TableView);t.GridView=r}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var t=e.call(this)||this;return t.params=new KvObject,t}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalEnd),this._signals.register(t.SignalSucceed),this._signals.register(t.SignalFailed),this._signals.register(t.SignalTimeout)},n.prototype.fields=function(){return this.params},n.prototype.unserialize=function(t){return this.data&&this.data.unserialize(t),!0},n.prototype.__mdl_start=function(){this.showWaiting&&t.Hud.ShowProgress(),this.signals.emit(t.SignalStart)},n.prototype.__mdl_completed=function(e){this.unserialize(e),this.signals.emit(t.SignalSucceed),this.__mdl_end()},n.prototype.__mdl_failed=function(){this.signals.emit(t.SignalFailed),this.__mdl_end()},n.prototype.__mdl_end=function(){this.signals.emit(t.SignalEnd),this.showWaiting&&t.Hud.HideProgress(),this.drop()},n}(t.SObject);t.SocketModel=e;var n=function(){function t(){}return t.prototype.toString=function(){return"header: "+this.cmd+" "+this.seqid+" "+this.code},t}(),i=function(){function e(){this._tpls=new KvObject,this._cfgs=new KvObject}return e.prototype.classForModel=function(e,n){var i=e+":/:"+n;if(this._tpls[i])return this._tpls[i];var r=this._cfgs[e];if(null==r){var o=t.ResManager.getText(e+"_dsl",t.ResPriority.NORMAL,null,null);if(null==o)return t.warn("dsl "+e+" not found"),null;this._cfgs[e]=r}var s=r.build(n);return null==s&&t.warn("没有找到数据模型 "+n),this._tpls[i]=s,s},e}(),r=function(e){function n(){return e.apply(this,arguments)||this}return __extends(n,e),n.prototype.open=function(){var e=this;this._hdl||(this._hdl=new WebSocket(this.host),this._hdl.binaryType="arraybuffer",this._hdl.onopen=function(){e.signals.emit(t.SignalOpen)},this._hdl.onclose=function(){e._hdl=null,e.signals.emit(t.SignalClose)},this._hdl.onmessage=function(n){e.signals.emit(t.SignalDataChanged,n.data)},this._hdl.onerror=function(n){e._hdl=null,e.signals.emit(t.SignalFailed)})},n.prototype.close=function(){null!=this._hdl&&(this._hdl.close(),null==this._hdl)},n.prototype.isopened=function(){return null!=this._hdl},n.prototype.write=function(t){this._hdl.send(t)},n}(t.CSocketConnector);t.WebSocketConnector=r;var o=function(e){function r(){var t=e.call(this)||this;return t._seqId=0,t._seqMdls=new KvObject,t._ntfMdls=new KvObject,t._pb=new i,t}return __extends(r,e),r.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalOpen),this._signals.register(t.SignalClose),this._signals.register(t.SignalTimeout)},Object.defineProperty(r.prototype,"connector",{get:function(){return this._connector},set:function(e){this._connector!=e&&(this._connector&&t.drop(this._connector),this._connector=e,e&&(e.signals.connect(t.SignalOpen,this.__cnt_connected,this),e.signals.connect(t.SignalClose,this.__cnt_disconnected,this),e.signals.connect(t.SignalDataChanged,this.__cnt_byteavaliable,this)))},enumerable:!0,configurable:!0}),r.prototype.watch=function(e,n,i){i&&e.attach(i),n&&e.signals.connect(t.SignalSucceed,n,i);var r=t.ObjectClass(e).Command,o=this._ntfMdls[r];null==o&&(o=new t.CSet,this._ntfMdls[r]=o),o.add(e)},r.prototype.unwatch=function(e){var n=t.ObjectClass(e).Command,i=this._ntfMdls[n];return null==i?void t.warn("还没有监听该对象 "+t.Classname(e)):(e.drop(),void t.SetT.RemoveObject(i,e))},r.prototype.fetch=function(e,n,i,r,o){var s=this._pb.classForModel(e.cfg,e.name);if(null!=s){e.ts=t.DateTime.Now(),i&&e.attach(i),n&&e.signals.connect(t.SignalSucceed,n,i),r&&e.signals.connect(t.SignalFailed,r,i),o&&e.signals.connect(t.SignalEnd,o,i),e.__mdl_start();var a=new s;t.MapT.Foreach(e.fields(),function(t,e){return a["set_"+t](e),!0},this);var c=new egret.ByteArray;c.endian=egret.Endian.BIG_ENDIAN;var u=++this._seqId;this.writeHeader(c,u,e),c.writeBytes(new egret.ByteArray(a.toArrayBuffer())),this._seqMdls[u]=e,this.connector.write(c.buffer)}},r.prototype.writeHeader=function(e,n,i){e.writeShort(t.ObjectClass(i).Command),e.writeInt(n),e.writeShort(0)},r.prototype.readHeader=function(t){if(t.length<8)return null;var e=new n;return e.cmd=t.readShort(),e.seqid=t.readInt(),e.code=t.readShort(),e},r.prototype.open=function(){return this.connector.isopened()?void t.fatal("连接已经打开"):(this.connector.host=this.host,void this.connector.open())},r.prototype.__cnt_connected=function(){t.noti("连接服务器 "+this.host+" 成功"),this.signals.emit(t.SignalOpen)},r.prototype.__cnt_disconnected=function(){t.noti("服务器 "+this.host+" 断开连接"),this.signals.emit(t.SignalClose)},r.prototype.__cnt_byteavaliable=function(e){var n=this,i=new egret.ByteArray(e.data),r=this.readHeader(i);if(null==r)return void t.warn("收到了不能解析的头");var o=new egret.ByteArray;i.readBytes(o);var s=this._ntfMdls[r.cmd];if(s&&s.size){var a=this._ntfMdls[r.cmd];try{var c=null,u=null;a.forEach(function(e){if(null==c){if(c=n._pb.classForModel(e.cfg,e.name),null==c)return t.warn("没有找到模型返回对象的描述类"),void a.forEach(function(t){t.__mdl_failed()});u=c.decode(o.buffer)}e.__mdl_completed(u)},this)}catch(l){t.warn("解析数据失败"),a.forEach(function(t){t.__mdl_failed()})}}else{var h=this._seqMdls[r.seqid];if(h){var c=this._pb.classForModel(h.cfg,h.dname);if(null==c)return t.warn("没有找到模型返回对象的描述类"),void h.__mdl_failed();try{var u=c.decode(o.buffer);h.__mdl_completed(u)}catch(l){t.warn("解析数据失败"),h.__mdl_failed()}return void t.MapT.RemoveKey(this._seqMdls,r.seqid)}t.noti("没有找到模型对象 "+r)}},r}(t.SObject);t.SocketSession=new o}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n.count=1,n._enable=t.Device.shared.supportAutoSound,n._position=0,n}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalStart),this._signals.register(t.SignalPaused),this._signals.register(t.SignalDone),this._signals.register(t.SignalChanged)},n.prototype.dispose=function(){this.stop(),this._hdl=null,this._cnl=null,e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"enable",{get:function(){return this._enable},set:function(e){e!=this._enable&&(e||(this._prePlayingState=this._playingState,this.stop()),this._enable=e,e&&this.autoRecovery&&this._prePlayingState==t.WorkState.DOING&&this.play())},enumerable:!0,configurable:!0}),n.prototype.setMediaSource=function(e){return this._mediaSource?void t.warn("不能重复设置player的mediaSource"):void(this._mediaSource=e)},n.prototype.setHdl=function(e){if(this._hdl){if(this._hdl.hashCode==e.hashCode)return;return void t.warn("不能覆盖已经设置了的声音对象")}this._hdl=e},n.prototype.setCnl=function(e){this._cnl!=e&&(this._cnl&&t.EventUnhook(this._cnl,egret.Event.SOUND_COMPLETE,this.__cb_end,this),this._cnl=e,e&&t.EventHook(e,egret.Event.SOUND_COMPLETE,this.__cb_end,this))},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!0,configurable:!0}),n.prototype.play=function(){var e=this;if(!this._enable)return void(this._prePlayingState=t.WorkState.DOING);if(this._playingState!=t.WorkState.DOING){if(this._playingState==t.WorkState.PAUSED)return void this.resume();this.__cb_play(),null==this._hdl?this.resourceGroups?t.ResManager.capsules(this.resourceGroups).load(function(){t.ResManager.getSound(e._mediaSource,t.ResPriority.NORMAL,function(n){null!=n&&(e.setHdl(n.use()),e._playingState==t.WorkState.DOING&&e.setCnl(e._hdl.play(e._position,e.count)))},e)},this):t.ResManager.getSound(this._mediaSource,t.ResPriority.NORMAL,function(n){null!=n&&(e.setHdl(n.use()),e._playingState==t.WorkState.DOING&&e.setCnl(e._hdl.play(e._position,e.count)))},this):this.setCnl(this._hdl.play(this._position,this.count))}},n.prototype.replay=function(){this.stop(),this.play()},n.prototype.pause=function(){return this._enable?void(this._playingState==t.WorkState.DOING&&(this._cnl&&(this._position=this._cnl.position,this._cnl.stop()),this._playingState=t.WorkState.PAUSED,this.__cb_pause())):void(this._prePlayingState=t.WorkState.PAUSED)},n.prototype.resume=function(){return this._enable?void(this._playingState==t.WorkState.PAUSED&&(this.__cb_play(),this._hdl&&this.setCnl(this._hdl.play(this._position,this.count)))):void(this._prePlayingState=t.WorkState.DOING)},n.prototype.stop=function(){return this._enable?void(this._playingState!=t.WorkState.DONE&&(this._cnl&&(this._cnl.stop(),this._cnl=void 0,this._position=0),this._playingState=t.WorkState.DONE)):void(this._prePlayingState=t.WorkState.DONE)},n.prototype.breakee=function(){this.pause()},Object.defineProperty(n.prototype,"isPlaying",{get:function(){return this._playingState==t.WorkState.DOING},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isPaused",{get:function(){return this._playingState==t.WorkState.PAUSED},enumerable:!0,configurable:!0}),n.prototype.__cb_end=function(){t.log("播放 "+this._mediaSource+" 结束"),this._playingState=t.WorkState.DONE,this._signals&&this._signals.emit(t.SignalDone)},n.prototype.__cb_pause=function(){this._signals&&this._signals.emit(t.SignalPaused)},n.prototype.__cb_play=function(){this._playingState=t.WorkState.DOING,this._signals&&this._signals.emit(t.SignalStart)},n}(t.SObject);t.SoundPlayer=e;var n=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setHdl=function(e){e&&(e.type=egret.Sound.EFFECT),t.prototype.setHdl.call(this,e)},e.prototype.breakee=function(){this.stop()},e}(e),i=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setHdl=function(e){e&&(e.type=egret.Sound.MUSIC),t.prototype.setHdl.call(this,e)},e.prototype.breakee=function(){this.stop()},e}(e),r=function(n){function i(){var t=n.call(this)||this;return t.count=1,t.classForPlayer=e,t._enable=!0,t._sounds=new KvObject,t}return __extends(i,n),Object.defineProperty(i.prototype,"autoRecovery",{get:function(){return this._autoRecovery},set:function(e){e!=this._autoRecovery&&(this._autoRecovery=e,t.MapT.Foreach(this._sounds,function(t,n){n.autoRecovery=e},this))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enable",{get:function(){return this._enable},set:function(e){e!=this._enable&&(this._enable=e,t.MapT.Foreach(this._sounds,function(t,n){n.enable=e},this))},enumerable:!0,configurable:!0}),i.prototype.player=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=this._sounds[e];return null==r&&(r=new this.classForPlayer,r.enable=this.enable,r.autoRecovery=this.autoRecovery,r.resourceGroups=n.length?n:this.resourceGroups,r.setMediaSource(e),r.count=this.count,r.signals.connect(t.SignalStart,this.__cb_play,this),this._sounds[e]=r),r},i.prototype.acquire=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var r=new this.classForPlayer;return r.enable=this.enable,r.autoRecovery=this.autoRecovery,r.resourceGroups=n.length?n:this.resourceGroups,r.setMediaSource(e),r.count=this.count,r.enable?r.signals.connect(t.SignalEnd,function(e){t.drop(e.sender)},null):t.Defer(r.drop,r),r},i.prototype.__cb_play=function(t){this.solo&&this._soloplayer!=t.sender&&(this._soloplayer&&this._soloplayer.breakee(),this._soloplayer=t.sender)},i.prototype.play=function(){t.MapT.Foreach(this._sounds,function(t,e){e.play()},this)},i.prototype.stop=function(){t.MapT.Foreach(this._sounds,function(t,e){e.stop()},this)},i.prototype._app_actived=function(){this.__app_activate_enable&&(this.enable=!0)},i.prototype._app_deactived=function(){this.__app_activate_enable=this.enable,this.enable=!1},i}(t.SObject);t.SoundTrack=r;var o=function(e){function o(){var n=e.call(this)||this;return n._tracks=new KvObject,n._enable=t.Device.shared.supportAutoSound,n}return __extends(o,e),o.prototype.track=function(t){var e=this._tracks[t];return null==e&&(e=new r,this._tracks[t]=e),e},Object.defineProperty(o.prototype,"background",{get:function(){var t=this._tracks.background;return null==t&&(t=new r,t.classForPlayer=i,t.count=-1,t.solo=!0,t.autoRecovery=!0,t.resourceGroups=this.resourceGroups,this._tracks.background=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"effect",{get:function(){var t=this._tracks.effect;return null==t&&(t=new r,t.classForPlayer=n,t.count=1,t.resourceGroups=this.resourceGroups,this._tracks.effect=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"enable",{get:function(){return this._enable},set:function(e){e!=this._enable&&t.MapT.Foreach(this._tracks,function(t,n){n.enable=e},this)},enumerable:!0,configurable:!0}),o}(t.SObject);t.SoundManager=new o}(nn||(nn={}));var nn;!function(t){t.FontFilePattern=/\.(ttf|otf|woff)$/i,t.FontKeyPattern=/(.+)_(?:ttf|otf|woff)$/i;var e=function(){function e(){this._fonts=new KvObject,this._dfonts=new KvObject}return e.prototype.add=function(t,e){this._fonts[t]=e,this._doAddH5Font(t,e)},e.prototype._doAddH5Font=function(e,n){var i=e.match(t.FontKeyPattern);if(2==t.length(i)){var r=i[1],o="@font-face { font-family:'"+r+"'; src:url("+n+"); }",s=document.createElement("style");s.innerHTML=o;var a=document.getElementsByTagName("head")[0];a.appendChild(s)}},e.prototype.font=function(e){var n=this._dfonts[e];return n?n:(n="黑体"==e?t.Device.shared.isIOS||t.Device.shared.isMac?"PingFangSC-Regular":t.Device.shared.isWin?"微软雅黑":"黑体":"宋体"==e?t.Device.shared.isIOS||t.Device.shared.isMac?"SimSun":"宋体":e,this._dfonts[e]=n,n)},e}();t._FontsManager=e,t.FontsManager=new e;var n=/^[\w]+:\/\/.+$/i,i=function(){function t(){}return t.Font=function(e){var n=new t;return n.family=e,n},t.Bitmap=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=new t;if(1==e.length){var o=e[0];-1==o.indexOf("_fnt")?r.name=o+"_fnt":r.name=o}else{var s=e[0],a=e[1];-1!=s.search(n)?r.texture=s:-1==s.indexOf("_png")&&(r.texture=s+"_png"),-1!=a.search(n)?r.config=a:-1!=a.indexOf("_fnt")&&(r.config=s+"_fnt")}return r},t}();t.FontConfig=i}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.dispose=function(){this._map&&(this._map.destory(),this._map=void 0),this._data=void 0,e.prototype.dispose.call(this)},Object.defineProperty(n.prototype,"tiledSource",{get:function(){return this._tiledSource},set:function(e){if(this._tiledSource!=e&&(this._map&&(this._imp.removeChild(this._map),this._map.destory(),this._map=void 0,this._data=void 0),this._tiledSource=e,e)){var n=RES.getRes(e);if("string"!=typeof n)return void t.warn("TiledMap 的资源文件类型错误: "+e+" 的类型应该为 text，清通过ResDepo工具修改");this._data=egret.XML.parse(n),this._url=t.ResManager.getResUrl(e)}},enumerable:!0,configurable:!0}),n.prototype.updateLayout=function(){if(e.prototype.updateLayout.call(this),null!=this._data){var n=this.boundsForLayout();this._map&&(this._map.renderwidth*t.ScaleFactorDeW!=n.width||this._map.renderheight*t.ScaleFactorDeH!=n.height)&&(this._imp.removeChild(this._map),this._map.destory(),this._map=void 0),null==this._map&&(this._map=new tiled.TMXTilemap(n.width,n.height,this._data,this._url),this._map.render(),this._imp.addChild(this._map)),this.impSetFrame(n,this._map)}},n}(t.Sprite);t.TiledMap=e}(nn||(nn={}));var nn;!function(t){var e=function(){function t(){this.singletone=!0}return t}();e.Default=new e,t.EntrySettings=e;var n=function(t){function e(){return t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onDataLoaded=function(){},e}(t.SObject);t.Manager=n;var i=function(t){function e(){var e=t.apply(this,arguments)||this;return e._managers=new Array,e}return __extends(e,t),e.prototype.register=function(t){return this._managers.push(t),t},e.prototype.onLoaded=function(){this._managers.forEach(function(t){t.onLoaded()})},e.prototype.onDataLoaded=function(){this._managers.forEach(function(t){t.onDataLoaded()})},e}(t.SObject);t.Managers=i;var r=function(){function n(){this._entries=new KvObject,this._entriesdata=new KvObject}return n.prototype.register=function(n,i){void 0===i&&(i=e.Default);var r;if("object"==typeof n){var o=n;r=o.name}else r=t.Classname(n);this._entries[r]=n,this._entriesdata[r]=i},n.prototype.invoke=function(t,e,n){this._doInvoke(t,e,n)},n.prototype._doInvoke=function(n,i,r){var o=this;if(null==n)return void t.warn("不能打开空的实例");var s="string"==typeof n?n:t.Classname(n),a=this._entries[s];if("object"==typeof a){var c=a;a=c.clazz()}if(null==a)return void t.fatal("找不到实体类型 "+s+"，请检查是否没有注册到EntriesManager");var u;if("string"==typeof i&&(u=t.LaunchersManager.find(i)),null==u&&"function"==typeof i){var l=i(s);if(u=t.LaunchersManager.find(l),null==u){var h=function(e){if(e.data==l){t.LaunchersManager.signals.disconnect(t.SignalChanged,h);var n=o._entriesdata[s];u=t.LaunchersManager.find(l),u.launchEntry(a,n)}};return t.LaunchersManager.signals.connect(t.SignalChanged,h,null),void this._doInvoke(l,i)}}if(null==u&&"object"==typeof i&&(u=i),null==u)return void t.fatal("没有找到停靠点"+i);var p=this._entriesdata[s];t.EntryCheckSettings(a,p)&&(null==p&&(p=new e),p.ext=r,u.launchEntry(a,p))},n.prototype.toString=function(){var e=[];return t.MapT.Foreach(this._entries,function(t){e.push(t)}),e.join(";")},n}();t._EntriesManager=r,t.EntriesManager=new r;var o=function(e){function n(){var t=e.call(this)||this;return t._launchers=new KvObject,t}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalChanged)},n.prototype.register=function(e){var n=t.Classname(e),i=this._launchers[n];return i?void t.warn("LaunchersManager 已经注册过 "+n):(this._launchers[n]=e,e.__need_remove_from_launchersmanager=!0,void this.signals.emit(t.SignalChanged,n))},n.prototype.unregister=function(e){var n=t.Classname(e);t.MapT.RemoveKey(this._launchers,n)},n.prototype.find=function(t){return this._launchers[t]},n.prototype.toString=function(){var e=[];return t.MapT.Foreach(this._launchers,function(t){e.push(t)}),e.join(";")},n}(t.SObject);t._LaunchersManager=o,t.LaunchersManager=new o}(nn||(nn={}));var nn;!function(t){var e=function(e){function n(){var n=e.call(this)||this;return n._filters=new t.CSet,n.popupMode=!0,n._clickedToClose=!1,n.anchor=new t.Point(.5,.5),n}return __extends(n,e),n.prototype._initSignals=function(){e.prototype._initSignals.call(this),this._signals.register(t.SignalRequestClose),this._signals.register(t.SignalOpening),this._signals.register(t.SignalClosing),this._signals.register(t.SignalOpen),this._signals.register(t.SignalClose)},n.prototype.dispose=function(){e.prototype.dispose.call(this),t.SetT.Clear(this._filters)},n.FromView=function(e){return t.findParentByType(e,n)},n.prototype.addFilter=function(t){this._filters.add(t)},n.prototype.onAppeared=function(){e.prototype.onAppeared.call(this),t.ISDEBUG&&t.info(t.Classname(this)+" 显示")},n.prototype.onDisappeared=function(){e.prototype.onDisappeared.call(this),t.ISDEBUG&&t.info(t.Classname(this)+" 消失")},Object.defineProperty(n.prototype,"clickedToClose",{get:function(){return this._clickedToClose},set:function(e){if(this._clickedToClose!=e){var n=t.Desktop.FromView(this);n&&(n.clickedToClose=e),this._clickedToClose=e}},enumerable:!0,configurable:!0}),n.prototype.instanceDesktop=function(){var e=new t.Desktop(this);return e.onlyFiltersTouchEnabled=this.onlyFiltersTouchEnabled,e.delayClose=this.delayClose,e.delayOpenInQueue=this.delayOpenInQueue,e.clickedToClose=this.clickedToClose,e.popupMode=this.popupMode,e.desktopLayer=this.desktopLayer,this.queue&&(e.queue=this.queue),this.signals.connect(t.SignalRequestClose,e.close,e),this._filters.forEach(function(t){e.addFilter(t)}),e},n.prototype.replace=function(t){var e=this.instanceDesktop();return e.replace(t),e},n.prototype.open=function(t){void 0===t&&(t=!1);var e=this.instanceDesktop();return e.open(t),e},n.prototype.follow=function(t){var e=this.instanceDesktop();return e.follow(t),e},n.prototype.close=function(){this.signals.emit(t.SignalRequestClose)},n.prototype.bestFrame=function(){return new t.Rect},n.prototype.bestPosition=function(){return null},n}(t.Component);t.Dialog=e}(nn||(nn={}));